/*! For license information please see sdlc-workflow-mcp.js.LICENSE.txt */
import{createRequire as e}from"node:module";var t,n,r={18:t=>{t.exports=e(import.meta.url)("tty")},23:t=>{t.exports=e(import.meta.url)("util")},123:(e,t,n)=>{var r,i=n(857),a=n(18),o=n(608),s=process.env;function c(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function u(e,t){if(0===r)return 0;if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2;if(e&&!t&&void 0===r)return 0;var n=r||0;if("dumb"===s.TERM)return n;if("win32"===process.platform){var a=i.release().split(".");return Number(a[0])>=10&&Number(a[2])>=10586?Number(a[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(function(e){return e in s})||"codeship"===s.CI_NAME?1:n;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if("truecolor"===s.COLORTERM)return 3;if("TERM_PROGRAM"in s){var c=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return c>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:n}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?r=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(r=1),"FORCE_COLOR"in s&&(r="true"===s.FORCE_COLOR?1:"false"===s.FORCE_COLOR?0:0===s.FORCE_COLOR.length?1:Math.min(parseInt(s.FORCE_COLOR,10),3)),e.exports={supportsColor:function(e){return c(u(e,e&&e.isTTY))},stdout:c(u(!0,a.isatty(1))),stderr:c(u(!0,a.isatty(2)))}},184:e=>{e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},212:e=>{e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},418:(e,t,n)=>{var r=n(821);e.exports=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},517:(e,t,n)=>{var r=n(832),i=n(530),a=n(821),o=n(212);e.exports=function(e){return r(e)||i(e)||a(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},530:e=>{e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},549:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))}),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(n){}!e&&"undefined"!==typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;var e;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=n(740)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},608:e=>{e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:process.argv,n=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(n+e),i=t.indexOf("--");return-1!==r&&(-1===i||r<i)}},717:e=>{var t=1e3,n=60*t,r=60*n,i=24*r,a=7*i,o=365.25*i;function s(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s)return;var c=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var a=Math.abs(e);if(a>=i)return s(e,a,i,"day");if(a>=r)return s(e,a,r,"hour");if(a>=n)return s(e,a,n,"minute");if(a>=t)return s(e,a,t,"second");return e+" ms"}(e):function(e){var a=Math.abs(e);if(a>=i)return Math.round(e/i)+"d";if(a>=r)return Math.round(e/r)+"h";if(a>=n)return Math.round(e/n)+"m";if(a>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},740:(e,t,n)=>{var r=n(517).default,i=n(418).default;e.exports=function(e){function t(e){var n,r,i,o=null;function s(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];if(s.enabled){var a=s,o=Number(new Date),c=o-(n||o);a.diff=c,a.prev=n,a.curr=o,n=o,r[0]=t.coerce(r[0]),"string"!==typeof r[0]&&r.unshift("%O");var u=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return"%";u++;var i=t.formatters[n];if("function"===typeof i){var o=r[u];e=i.call(a,o),r.splice(u,1),u--}return e}),t.formatArgs.call(a,r),(a.log||t.log).apply(a,r)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=a,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==o?o:(r!==t.namespaces&&(r=t.namespaces,i=t.enabled(e)),i)},set:function(e){o=e}}),"function"===typeof t.init&&t.init(s),s}function a(e,n){var r=t(this.namespace+("undefined"===typeof n?":":n)+e);return r.log=this.log,r}function o(e,t){for(var n=0,r=0,i=-1,a=0;n<e.length;)if(r<t.length&&(t[r]===e[n]||"*"===t[r]))"*"===t[r]?(i=r,a=n,r++):(n++,r++);else{if(-1===i)return!1;r=i+1,n=++a}for(;r<t.length&&"*"===t[r];)r++;return r===t.length}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(r(t.names),r(t.skips.map(function(e){return"-"+e}))).join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n,r=("string"===typeof e?e:"").trim().replace(" ",",").split(",").filter(Boolean),a=i(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;"-"===o[0]?t.skips.push(o.slice(1)):t.names.push(o)}}catch(s){a.e(s)}finally{a.f()}},t.enabled=function(e){var n,r=i(t.skips);try{for(r.s();!(n=r.n()).done;){if(o(e,n.value))return!1}}catch(c){r.e(c)}finally{r.f()}var a,s=i(t.names);try{for(s.s();!(a=s.n()).done;){if(o(e,a.value))return!0}}catch(c){s.e(c)}finally{s.f()}return!1},t.humanize=n(717),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(function(n){t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},821:(e,t,n)=>{var r=n(184);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},823:(e,t)=>{t.L=function(e,t,n,r,i){var a,o,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,f=n?i-1:0,d=n?-1:1,p=e[t+f];for(f+=d,a=p&(1<<-l)-1,p>>=-l,l+=s;l>0;a=256*a+e[t+f],f+=d,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+e[t+f],f+=d,l-=8);if(0===a)a=1-u;else{if(a===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),a-=u}return(p?-1:1)*o*Math.pow(2,a-r)},t.M=function(e,t,n,r,i,a){var o,s,c,u=8*a-i-1,l=(1<<u)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(o++,c/=2),o+f>=l?(s=0,o=l):o+f>=1?(s=(t*c-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[n+p]=255&o,p+=h,o/=256,u-=8);e[n+p-h]|=128*m}},832:(e,t,n)=>{var r=n(184);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},837:(e,t,n)=>{var r=n(18),i=n(23);t.init=function(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return process.stderr.write(i.formatWithOptions.apply(i,[t.inspectOpts].concat(n))+"\n")},t.formatArgs=function(n){var r=this.namespace,i=this.useColors;if(i){var a=this.color,o="\x1b[3"+(a<8?a:"8;5;"+a),s="  ".concat(o,";1m").concat(r," \x1b[0m");n[0]=s+n[0].split("\n").join("\n"+s),n.push(o+"m+"+e.exports.humanize(this.diff)+"\x1b[0m")}else n[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=i.deprecate(function(){},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{var a=n(123);a&&(a.stderr||a).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(s){}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e},{}),e.exports=n(740)(t);var o=e.exports.formatters;o.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map(function(e){return e.trim()}).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},857:t=>{t.exports=e(import.meta.url)("os")},957:(e,t,n)=>{"undefined"===typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=n(549):e.exports=n(837)}},i={};function a(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return r[e](n,n.exports,a),n.exports}function o(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,n,r){function a(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},o(e,t,n,r)}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,r,i,a){var s=r&&r.prototype instanceof u?r:u,l=Object.create(s.prototype);return o(l,"_invoke",function(n,r,i){var a,o,s,u=0,l=i||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,o=0,s=e,d.n=n,c}};function p(n,r){for(o=n,s=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,a=l[t],p=d.p,h=a[2];n>3?(i=h===r)&&(s=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=p&&((i=n<2&&p<a[1])?(o=0,d.v=r,d.n=a[1]):p<h&&(i=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,d.n=h,o=0))}if(i||n>1)return c;throw f=!0,r}return function(i,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,h),o=l,s=h;(t=o<2?e:s)||!f;){a||(o?o<3?(o>1&&(d.n=-1),p(o,s)):d.n=s:d.v=s);try{if(u=2,a){if(o||(i="next"),t=a[i]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,o<2&&(o=0)}else 1===o&&(t=a.return)&&t.call(a),o<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),o=1);a=e}else if((t=(f=d.n<0)?s:n.call(r,d))!==c)break}catch(t){a=e,o=1,s=t}finally{u=1}}return{value:t,done:f}}}(n,i,a),!0),l}var c={};function u(){}function l(){}function f(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(o(t={},r,function(){return this}),t),p=f.prototype=u.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=f,o(p,"constructor",f),o(f,"constructor",l),l.displayName="GeneratorFunction",o(f,i,"GeneratorFunction"),o(p),o(p,i,"Generator"),o(p,r,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:a,m:h}})()}function c(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,s,"next",e)}function s(e){c(a,r,i,o,s,"throw",e)}o(void 0)})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function h(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){m(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(w=function(){return!!e})()}function b(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e,t,n){return t=y(t),b(e,w()?Reflect.construct(t,n||[],y(e).constructor):t.apply(e,n))}function x(e,t){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},x(e,t)}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function P(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function O(e){var t="function"==typeof Map?new Map:void 0;return O=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(w())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&x(i,n.prototype),i}(e,arguments,y(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),x(n,e)},O(e)}function A(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}!function(e){e.assertEqual=function(e){return e},e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=function(e){var t,n={},r=P(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i]=i}}catch(a){r.e(a)}finally{r.f()}return n},e.getValidEnumValues=function(t){var n,r=e.objectKeys(t).filter(function(e){return"number"!==typeof t[t[e]]}),i={},a=P(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i[o]=t[o]}}catch(s){a.e(s)}finally{a.f()}return e.objectValues(i)},e.objectValues=function(t){return e.objectKeys(t).map(function(e){return t[e]})},e.objectKeys="function"===typeof Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=function(e,t){var n,r=P(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t(i))return i}}catch(a){r.e(a)}finally{r.f()}},e.isInteger="function"===typeof Number.isInteger?function(e){return Number.isInteger(e)}:function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},e.joinValues=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" | ";return e.map(function(e){return"string"===typeof e?"'".concat(e,"'"):e}).join(t)},e.jsonStringifyReplacer=function(e,t){return"bigint"===typeof t?t.toString():t}}(t||(t={})),function(e){e.mergeShapes=function(e,t){return g(g({},e),t)}}(n||(n={}));var F=t.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),I=function(e){switch(typeof e){case"undefined":return F.undefined;case"string":return F.string;case"number":return isNaN(e)?F.nan:F.number;case"boolean":return F.boolean;case"function":return F.function;case"bigint":return F.bigint;case"symbol":return F.symbol;case"object":return Array.isArray(e)?F.array:null===e?F.null:e.then&&"function"===typeof e.then&&e.catch&&"function"===typeof e.catch?F.promise:"undefined"!==typeof Map&&e instanceof Map?F.map:"undefined"!==typeof Set&&e instanceof Set?F.set:"undefined"!==typeof Date&&e instanceof Date?F.date:F.object;default:return F.unknown}},j=t.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),R=function(){function e(t){var n;l(this,e),(n=k(this,e)).issues=[],n.addIssue=function(e){n.issues=[].concat(A(n.issues),[e])},n.addIssues=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n.issues=[].concat(A(n.issues),A(e))};var r=(this instanceof e?this.constructor:void 0).prototype;return Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__=r,n.name="ZodError",n.issues=t,n}return _(e,O(Error)),h(e,[{key:"errors",get:function(){return this.issues}},{key:"format",value:function(e){var t=e||function(e){return e.message},n={_errors:[]},r=function(e){var i,a=P(e.issues);try{for(a.s();!(i=a.n()).done;){var o=i.value;if("invalid_union"===o.code)o.unionErrors.map(r);else if("invalid_return_type"===o.code)r(o.returnTypeError);else if("invalid_arguments"===o.code)r(o.argumentsError);else if(0===o.path.length)n._errors.push(t(o));else for(var s=n,c=0;c<o.path.length;){var u=o.path[c];c===o.path.length-1?(s[u]=s[u]||{_errors:[]},s[u]._errors.push(t(o))):s[u]=s[u]||{_errors:[]},s=s[u],c++}}}catch(l){a.e(l)}finally{a.f()}};return r(this),n}},{key:"toString",value:function(){return this.message}},{key:"message",get:function(){return JSON.stringify(this.issues,t.jsonStringifyReplacer,2)}},{key:"isEmpty",get:function(){return 0===this.issues.length}},{key:"flatten",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e.message},n={},r=[],i=P(this.issues);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(t(a))):r.push(t(a))}}catch(o){i.e(o)}finally{i.f()}return{formErrors:r,fieldErrors:n}}},{key:"formErrors",get:function(){return this.flatten()}}],[{key:"assert",value:function(t){if(!(t instanceof e))throw new Error("Not a ZodError: ".concat(t))}}])}();R.create=function(e){return new R(e)};var M=function(e,n){var r;switch(e.code){case j.invalid_type:r=e.received===F.undefined?"Required":"Expected ".concat(e.expected,", received ").concat(e.received);break;case j.invalid_literal:r="Invalid literal value, expected ".concat(JSON.stringify(e.expected,t.jsonStringifyReplacer));break;case j.unrecognized_keys:r="Unrecognized key(s) in object: ".concat(t.joinValues(e.keys,", "));break;case j.invalid_union:r="Invalid input";break;case j.invalid_union_discriminator:r="Invalid discriminator value. Expected ".concat(t.joinValues(e.options));break;case j.invalid_enum_value:r="Invalid enum value. Expected ".concat(t.joinValues(e.options),", received '").concat(e.received,"'");break;case j.invalid_arguments:r="Invalid function arguments";break;case j.invalid_return_type:r="Invalid function return type";break;case j.invalid_date:r="Invalid date";break;case j.invalid_string:"object"===typeof e.validation?"includes"in e.validation?(r='Invalid input: must include "'.concat(e.validation.includes,'"'),"number"===typeof e.validation.position&&(r="".concat(r," at one or more positions greater than or equal to ").concat(e.validation.position))):"startsWith"in e.validation?r='Invalid input: must start with "'.concat(e.validation.startsWith,'"'):"endsWith"in e.validation?r='Invalid input: must end with "'.concat(e.validation.endsWith,'"'):t.assertNever(e.validation):r="regex"!==e.validation?"Invalid ".concat(e.validation):"Invalid";break;case j.too_small:r="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"more than"," ").concat(e.minimum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"over"," ").concat(e.minimum," character(s)"):"number"===e.type?"Number must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(e.minimum):"date"===e.type?"Date must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(e.minimum))):"Invalid input";break;case j.too_big:r="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"less than"," ").concat(e.maximum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"under"," ").concat(e.maximum," character(s)"):"number"===e.type?"Number must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"bigint"===e.type?"BigInt must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"date"===e.type?"Date must be ".concat(e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(e.maximum))):"Invalid input";break;case j.custom:r="Invalid input";break;case j.invalid_intersection_types:r="Intersection results could not be merged";break;case j.not_multiple_of:r="Number must be a multiple of ".concat(e.multipleOf);break;case j.not_finite:r="Number must be finite";break;default:r=n.defaultError,t.assertNever(e)}return{message:r}},D=M;function U(){return D}var N=function(e){var t=e.data,n=e.path,r=e.errorMaps,i=e.issueData,a=[].concat(A(n),A(i.path||[])),o=g(g({},i),{},{path:a});if(void 0!==i.message)return g(g({},i),{},{path:a,message:i.message});var s,c="",u=P(r.filter(function(e){return!!e}).slice().reverse());try{for(u.s();!(s=u.n()).done;){c=(0,s.value)(o,{data:t,defaultError:c}).message}}catch(l){u.e(l)}finally{u.f()}return g(g({},i),{},{path:a,message:c})};function L(e,t){var n=U(),r=N({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===M?void 0:M].filter(function(e){return!!e})});e.common.issues.push(r)}var z,q,Z,B=function(){function e(){l(this,e),this.value="valid"}return h(e,[{key:"dirty",value:function(){"valid"===this.value&&(this.value="dirty")}},{key:"abort",value:function(){"aborted"!==this.value&&(this.value="aborted")}}],[{key:"mergeArray",value:function(e,t){var n,r=[],i=P(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if("aborted"===a.status)return W;"dirty"===a.status&&e.dirty(),r.push(a.value)}}catch(o){i.e(o)}finally{i.f()}return{status:e.value,value:r}}},{key:"mergeObjectAsync",value:function(){var t=u(s().m(function t(n,r){var i,a,o,c,u,l,f;return s().w(function(t){for(;;)switch(t.p=t.n){case 0:i=[],a=P(r),t.p=1,a.s();case 2:if((o=a.n()).done){t.n=6;break}return c=o.value,t.n=3,c.key;case 3:return u=t.v,t.n=4,c.value;case 4:l=t.v,i.push({key:u,value:l});case 5:t.n=2;break;case 6:t.n=8;break;case 7:t.p=7,f=t.v,a.e(f);case 8:return t.p=8,a.f(),t.f(8);case 9:return t.a(2,e.mergeObjectSync(n,i))}},t,null,[[1,7,8,9]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"mergeObjectSync",value:function(e,t){var n,r={},i=P(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=a.key,s=a.value;if("aborted"===o.status)return W;if("aborted"===s.status)return W;"dirty"===o.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===o.value||"undefined"===typeof s.value&&!a.alwaysSet||(r[o.value]=s.value)}}catch(c){i.e(c)}finally{i.f()}return{status:e.value,value:r}}}])}(),W=Object.freeze({status:"aborted"}),G=function(e){return{status:"dirty",value:e}},H=function(e){return{status:"valid",value:e}},$=function(e){return"aborted"===e.status},V=function(e){return"dirty"===e.status},K=function(e){return"valid"===e.status},Q=function(e){return"undefined"!==typeof Promise&&e instanceof Promise};function J(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function Y(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}"function"===typeof SuppressedError&&SuppressedError,function(e){e.errToObj=function(e){return"string"===typeof e?{message:e}:e||{}},e.toString=function(e){return"string"===typeof e?e:null===e||void 0===e?void 0:e.message}}(z||(z={}));var X=function(){return h(function e(t,n,r,i){l(this,e),this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=i},[{key:"path",get:function(){var e,t;this._cachedPath.length||(this._key instanceof Array?(e=this._cachedPath).push.apply(e,A(this._path).concat(A(this._key))):(t=this._cachedPath).push.apply(t,A(this._path).concat([this._key])));return this._cachedPath}}])}(),ee=function(e,t){if(K(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;var t=new R(e.common.issues);return this._error=t,this._error}}};function te(e){if(!e)return{};var t=e.errorMap,n=e.invalid_type_error,r=e.required_error,i=e.description;if(t&&(n||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:i};return{errorMap:function(t,i){var a,o,s=e.message;return"invalid_enum_value"===t.code?{message:null!==s&&void 0!==s?s:i.defaultError}:"undefined"===typeof i.data?{message:null!==(a=null!==s&&void 0!==s?s:r)&&void 0!==a?a:i.defaultError}:"invalid_type"!==t.code?{message:i.defaultError}:{message:null!==(o=null!==s&&void 0!==s?s:n)&&void 0!==o?o:i.defaultError}},description:i}}var ne,re=function(){return h(function e(t){var n=this;l(this,e),this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:function(e){return n["~validate"](e)}}},[{key:"description",get:function(){return this._def.description}},{key:"_getType",value:function(e){return I(e.data)}},{key:"_getOrReturnCtx",value:function(e,t){return t||{common:e.parent.common,data:e.data,parsedType:I(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}},{key:"_processInputParams",value:function(e){return{status:new B,ctx:{common:e.parent.common,data:e.data,parsedType:I(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}},{key:"_parseSync",value:function(e){var t=this._parse(e);if(Q(t))throw new Error("Synchronous parse encountered promise.");return t}},{key:"_parseAsync",value:function(e){var t=this._parse(e);return Promise.resolve(t)}},{key:"parse",value:function(e,t){var n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}},{key:"safeParse",value:function(e,t){var n,r={common:{issues:[],async:null!==(n=null===t||void 0===t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null===t||void 0===t?void 0:t.errorMap},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:I(e)},i=this._parseSync({data:e,path:r.path,parent:r});return ee(r,i)}},{key:"~validate",value:function(e){var t,n,r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:I(e)};if(!this["~standard"].async)try{var i=this._parseSync({data:e,path:[],parent:r});return K(i)?{value:i.value}:{issues:r.common.issues}}catch(a){(null===(n=null===(t=null===a||void 0===a?void 0:a.message)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes("encountered"))&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(function(e){return K(e)?{value:e.value}:{issues:r.common.issues}})}},{key:"parseAsync",value:function(){var e=u(s().m(function e(t,n){var r;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.safeParseAsync(t,n);case 1:if(!(r=e.v).success){e.n=2;break}return e.a(2,r.data);case 2:throw r.error;case 3:return e.a(2)}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"safeParseAsync",value:function(){var e=u(s().m(function e(t,n){var r,i,a;return s().w(function(e){for(;;)switch(e.n){case 0:return r={common:{issues:[],contextualErrorMap:null===n||void 0===n?void 0:n.errorMap,async:!0},path:(null===n||void 0===n?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:I(t)},i=this._parse({data:t,path:r.path,parent:r}),e.n=1,Q(i)?i:Promise.resolve(i);case 1:return a=e.v,e.a(2,ee(r,a))}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"refine",value:function(e,t){return this._refinement(function(n,r){var i=e(n),a=function(){return r.addIssue(g({code:j.custom},function(e){return"string"===typeof t||"undefined"===typeof t?{message:t}:"function"===typeof t?t(e):t}(n)))};return"undefined"!==typeof Promise&&i instanceof Promise?i.then(function(e){return!!e||(a(),!1)}):!!i||(a(),!1)})}},{key:"refinement",value:function(e,t){return this._refinement(function(n,r){return!!e(n)||(r.addIssue("function"===typeof t?t(n,r):t),!1)})}},{key:"_refinement",value:function(e){return new it({schema:this,typeName:vt.ZodEffects,effect:{type:"refinement",refinement:e}})}},{key:"superRefine",value:function(e){return this._refinement(e)}},{key:"optional",value:function(){return at.create(this,this._def)}},{key:"nullable",value:function(){return ot.create(this,this._def)}},{key:"nullish",value:function(){return this.nullable().optional()}},{key:"array",value:function(){return Le.create(this)}},{key:"promise",value:function(){return rt.create(this,this._def)}},{key:"or",value:function(e){return Ze.create([this,e],this._def)}},{key:"and",value:function(e){return He.create(this,e,this._def)}},{key:"transform",value:function(e){return new it(g(g({},te(this._def)),{},{schema:this,typeName:vt.ZodEffects,effect:{type:"transform",transform:e}}))}},{key:"default",value:function(e){var t="function"===typeof e?e:function(){return e};return new st(g(g({},te(this._def)),{},{innerType:this,defaultValue:t,typeName:vt.ZodDefault}))}},{key:"brand",value:function(){return new ft(g({typeName:vt.ZodBranded,type:this},te(this._def)))}},{key:"catch",value:function(e){var t="function"===typeof e?e:function(){return e};return new ct(g(g({},te(this._def)),{},{innerType:this,catchValue:t,typeName:vt.ZodCatch}))}},{key:"describe",value:function(e){return new(0,this.constructor)(g(g({},this._def),{},{description:e}))}},{key:"pipe",value:function(e){return dt.create(this,e)}},{key:"readonly",value:function(){return pt.create(this)}},{key:"isOptional",value:function(){return this.safeParse(void 0).success}},{key:"isNullable",value:function(){return this.safeParse(null).success}}])}(),ie=/^c[^\s-]{8,}$/i,ae=/^[0-9a-z]+$/,oe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,se=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ce=/^[a-z0-9_-]{21}$/i,ue=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,le=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,fe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,de=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,pe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,he=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,me=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ve=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ge=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ye="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",we=new RegExp("^".concat(ye,"$"));function be(e){var t="[0-5]\\d";e.precision?t="".concat(t,"\\.\\d{").concat(e.precision,"}"):null==e.precision&&(t="".concat(t,"(\\.\\d+)?"));var n=e.precision?"+":"?";return"([01]\\d|2[0-3]):[0-5]\\d(:".concat(t,")").concat(n)}function ke(e){return new RegExp("^".concat(be(e),"$"))}function xe(e){var t="".concat(ye,"T").concat(be(e)),n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t="".concat(t,"(").concat(n.join("|"),")"),new RegExp("^".concat(t,"$"))}function _e(e,t){return!("v4"!==t&&t||!de.test(e))||!("v6"!==t&&t||!he.test(e))}function Se(e,t){if(!ue.test(e))return!1;try{var n=E(e.split("."),1)[0],r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return"object"===typeof i&&null!==i&&(!(!i.typ||!i.alg)&&(!t||i.alg===t))}catch(ou){return!1}}function Ce(e,t){return!("v4"!==t&&t||!pe.test(e))||!("v6"!==t&&t||!me.test(e))}var Ee=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==F.string){var n=this._getOrReturnCtx(e);return L(n,{code:j.invalid_type,expected:F.string,received:n.parsedType}),W}var r,i=new B,a=void 0,o=P(this._def.checks);try{for(o.s();!(r=o.n()).done;){var s=r.value;if("min"===s.kind)e.data.length<s.value&&(L(a=this._getOrReturnCtx(e,a),{code:j.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if("max"===s.kind)e.data.length>s.value&&(L(a=this._getOrReturnCtx(e,a),{code:j.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if("length"===s.kind){var c=e.data.length>s.value,u=e.data.length<s.value;(c||u)&&(a=this._getOrReturnCtx(e,a),c?L(a,{code:j.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):u&&L(a,{code:j.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if("email"===s.kind)fe.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"email",code:j.invalid_string,message:s.message}),i.dirty());else if("emoji"===s.kind)ne||(ne=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ne.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"emoji",code:j.invalid_string,message:s.message}),i.dirty());else if("uuid"===s.kind)se.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"uuid",code:j.invalid_string,message:s.message}),i.dirty());else if("nanoid"===s.kind)ce.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"nanoid",code:j.invalid_string,message:s.message}),i.dirty());else if("cuid"===s.kind)ie.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"cuid",code:j.invalid_string,message:s.message}),i.dirty());else if("cuid2"===s.kind)ae.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"cuid2",code:j.invalid_string,message:s.message}),i.dirty());else if("ulid"===s.kind)oe.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"ulid",code:j.invalid_string,message:s.message}),i.dirty());else if("url"===s.kind)try{new URL(e.data)}catch(ou){L(a=this._getOrReturnCtx(e,a),{validation:"url",code:j.invalid_string,message:s.message}),i.dirty()}else if("regex"===s.kind){s.regex.lastIndex=0,s.regex.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"regex",code:j.invalid_string,message:s.message}),i.dirty())}else if("trim"===s.kind)e.data=e.data.trim();else if("includes"===s.kind)e.data.includes(s.value,s.position)||(L(a=this._getOrReturnCtx(e,a),{code:j.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty());else if("toLowerCase"===s.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===s.kind)e.data=e.data.toUpperCase();else if("startsWith"===s.kind)e.data.startsWith(s.value)||(L(a=this._getOrReturnCtx(e,a),{code:j.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty());else if("endsWith"===s.kind)e.data.endsWith(s.value)||(L(a=this._getOrReturnCtx(e,a),{code:j.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty());else if("datetime"===s.kind){xe(s).test(e.data)||(L(a=this._getOrReturnCtx(e,a),{code:j.invalid_string,validation:"datetime",message:s.message}),i.dirty())}else if("date"===s.kind){we.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{code:j.invalid_string,validation:"date",message:s.message}),i.dirty())}else if("time"===s.kind){ke(s).test(e.data)||(L(a=this._getOrReturnCtx(e,a),{code:j.invalid_string,validation:"time",message:s.message}),i.dirty())}else"duration"===s.kind?le.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"duration",code:j.invalid_string,message:s.message}),i.dirty()):"ip"===s.kind?_e(e.data,s.version)||(L(a=this._getOrReturnCtx(e,a),{validation:"ip",code:j.invalid_string,message:s.message}),i.dirty()):"jwt"===s.kind?Se(e.data,s.alg)||(L(a=this._getOrReturnCtx(e,a),{validation:"jwt",code:j.invalid_string,message:s.message}),i.dirty()):"cidr"===s.kind?Ce(e.data,s.version)||(L(a=this._getOrReturnCtx(e,a),{validation:"cidr",code:j.invalid_string,message:s.message}),i.dirty()):"base64"===s.kind?ve.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"base64",code:j.invalid_string,message:s.message}),i.dirty()):"base64url"===s.kind?ge.test(e.data)||(L(a=this._getOrReturnCtx(e,a),{validation:"base64url",code:j.invalid_string,message:s.message}),i.dirty()):t.assertNever(s)}}catch(l){o.e(l)}finally{o.f()}return{status:i.value,value:e.data}}},{key:"_regex",value:function(e,t,n){return this.refinement(function(t){return e.test(t)},g({validation:t,code:j.invalid_string},z.errToObj(n)))}},{key:"_addCheck",value:function(t){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[t])}))}},{key:"email",value:function(e){return this._addCheck(g({kind:"email"},z.errToObj(e)))}},{key:"url",value:function(e){return this._addCheck(g({kind:"url"},z.errToObj(e)))}},{key:"emoji",value:function(e){return this._addCheck(g({kind:"emoji"},z.errToObj(e)))}},{key:"uuid",value:function(e){return this._addCheck(g({kind:"uuid"},z.errToObj(e)))}},{key:"nanoid",value:function(e){return this._addCheck(g({kind:"nanoid"},z.errToObj(e)))}},{key:"cuid",value:function(e){return this._addCheck(g({kind:"cuid"},z.errToObj(e)))}},{key:"cuid2",value:function(e){return this._addCheck(g({kind:"cuid2"},z.errToObj(e)))}},{key:"ulid",value:function(e){return this._addCheck(g({kind:"ulid"},z.errToObj(e)))}},{key:"base64",value:function(e){return this._addCheck(g({kind:"base64"},z.errToObj(e)))}},{key:"base64url",value:function(e){return this._addCheck(g({kind:"base64url"},z.errToObj(e)))}},{key:"jwt",value:function(e){return this._addCheck(g({kind:"jwt"},z.errToObj(e)))}},{key:"ip",value:function(e){return this._addCheck(g({kind:"ip"},z.errToObj(e)))}},{key:"cidr",value:function(e){return this._addCheck(g({kind:"cidr"},z.errToObj(e)))}},{key:"datetime",value:function(e){var t,n;return"string"===typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck(g({kind:"datetime",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,offset:null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null===e||void 0===e?void 0:e.local)&&void 0!==n&&n},z.errToObj(null===e||void 0===e?void 0:e.message)))}},{key:"date",value:function(e){return this._addCheck({kind:"date",message:e})}},{key:"time",value:function(e){return"string"===typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck(g({kind:"time",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision},z.errToObj(null===e||void 0===e?void 0:e.message)))}},{key:"duration",value:function(e){return this._addCheck(g({kind:"duration"},z.errToObj(e)))}},{key:"regex",value:function(e,t){return this._addCheck(g({kind:"regex",regex:e},z.errToObj(t)))}},{key:"includes",value:function(e,t){return this._addCheck(g({kind:"includes",value:e,position:null===t||void 0===t?void 0:t.position},z.errToObj(null===t||void 0===t?void 0:t.message)))}},{key:"startsWith",value:function(e,t){return this._addCheck(g({kind:"startsWith",value:e},z.errToObj(t)))}},{key:"endsWith",value:function(e,t){return this._addCheck(g({kind:"endsWith",value:e},z.errToObj(t)))}},{key:"min",value:function(e,t){return this._addCheck(g({kind:"min",value:e},z.errToObj(t)))}},{key:"max",value:function(e,t){return this._addCheck(g({kind:"max",value:e},z.errToObj(t)))}},{key:"length",value:function(e,t){return this._addCheck(g({kind:"length",value:e},z.errToObj(t)))}},{key:"nonempty",value:function(e){return this.min(1,z.errToObj(e))}},{key:"trim",value:function(){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[{kind:"trim"}])}))}},{key:"toLowerCase",value:function(){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[{kind:"toLowerCase"}])}))}},{key:"toUpperCase",value:function(){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[{kind:"toUpperCase"}])}))}},{key:"isDatetime",get:function(){return!!this._def.checks.find(function(e){return"datetime"===e.kind})}},{key:"isDate",get:function(){return!!this._def.checks.find(function(e){return"date"===e.kind})}},{key:"isTime",get:function(){return!!this._def.checks.find(function(e){return"time"===e.kind})}},{key:"isDuration",get:function(){return!!this._def.checks.find(function(e){return"duration"===e.kind})}},{key:"isEmail",get:function(){return!!this._def.checks.find(function(e){return"email"===e.kind})}},{key:"isURL",get:function(){return!!this._def.checks.find(function(e){return"url"===e.kind})}},{key:"isEmoji",get:function(){return!!this._def.checks.find(function(e){return"emoji"===e.kind})}},{key:"isUUID",get:function(){return!!this._def.checks.find(function(e){return"uuid"===e.kind})}},{key:"isNANOID",get:function(){return!!this._def.checks.find(function(e){return"nanoid"===e.kind})}},{key:"isCUID",get:function(){return!!this._def.checks.find(function(e){return"cuid"===e.kind})}},{key:"isCUID2",get:function(){return!!this._def.checks.find(function(e){return"cuid2"===e.kind})}},{key:"isULID",get:function(){return!!this._def.checks.find(function(e){return"ulid"===e.kind})}},{key:"isIP",get:function(){return!!this._def.checks.find(function(e){return"ip"===e.kind})}},{key:"isCIDR",get:function(){return!!this._def.checks.find(function(e){return"cidr"===e.kind})}},{key:"isBase64",get:function(){return!!this._def.checks.find(function(e){return"base64"===e.kind})}},{key:"isBase64url",get:function(){return!!this._def.checks.find(function(e){return"base64url"===e.kind})}},{key:"minLength",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"maxLength",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return t}}])}();function Te(e,t){var n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}Ee.create=function(e){var t;return new Ee(g({checks:[],typeName:vt.ZodString,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t},te(e)))};var Pe=function(){function e(){var t;return l(this,e),(t=k(this,e,arguments)).min=t.gte,t.max=t.lte,t.step=t.multipleOf,t}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==F.number){var n=this._getOrReturnCtx(e);return L(n,{code:j.invalid_type,expected:F.number,received:n.parsedType}),W}var r,i=void 0,a=new B,o=P(this._def.checks);try{for(o.s();!(r=o.n()).done;){var s=r.value;if("int"===s.kind)t.isInteger(e.data)||(L(i=this._getOrReturnCtx(e,i),{code:j.invalid_type,expected:"integer",received:"float",message:s.message}),a.dirty());else if("min"===s.kind){(s.inclusive?e.data<s.value:e.data<=s.value)&&(L(i=this._getOrReturnCtx(e,i),{code:j.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),a.dirty())}else if("max"===s.kind){(s.inclusive?e.data>s.value:e.data>=s.value)&&(L(i=this._getOrReturnCtx(e,i),{code:j.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),a.dirty())}else"multipleOf"===s.kind?0!==Te(e.data,s.value)&&(L(i=this._getOrReturnCtx(e,i),{code:j.not_multiple_of,multipleOf:s.value,message:s.message}),a.dirty()):"finite"===s.kind?Number.isFinite(e.data)||(L(i=this._getOrReturnCtx(e,i),{code:j.not_finite,message:s.message}),a.dirty()):t.assertNever(s)}}catch(c){o.e(c)}finally{o.f()}return{status:a.value,value:e.data}}},{key:"gte",value:function(e,t){return this.setLimit("min",e,!0,z.toString(t))}},{key:"gt",value:function(e,t){return this.setLimit("min",e,!1,z.toString(t))}},{key:"lte",value:function(e,t){return this.setLimit("max",e,!0,z.toString(t))}},{key:"lt",value:function(e,t){return this.setLimit("max",e,!1,z.toString(t))}},{key:"setLimit",value:function(t,n,r,i){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[{kind:t,value:n,inclusive:r,message:z.toString(i)}])}))}},{key:"_addCheck",value:function(t){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[t])}))}},{key:"int",value:function(e){return this._addCheck({kind:"int",message:z.toString(e)})}},{key:"positive",value:function(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:z.toString(e)})}},{key:"negative",value:function(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:z.toString(e)})}},{key:"nonpositive",value:function(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:z.toString(e)})}},{key:"nonnegative",value:function(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:z.toString(e)})}},{key:"multipleOf",value:function(e,t){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(t)})}},{key:"finite",value:function(e){return this._addCheck({kind:"finite",message:z.toString(e)})}},{key:"safe",value:function(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:z.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:z.toString(e)})}},{key:"minValue",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"maxValue",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"isInt",get:function(){return!!this._def.checks.find(function(e){return"int"===e.kind||"multipleOf"===e.kind&&t.isInteger(e.value)})}},{key:"isFinite",get:function(){var e,t=null,n=null,r=P(this._def.checks);try{for(r.s();!(e=r.n()).done;){var i=e.value;if("finite"===i.kind||"int"===i.kind||"multipleOf"===i.kind)return!0;"min"===i.kind?(null===n||i.value>n)&&(n=i.value):"max"===i.kind&&(null===t||i.value<t)&&(t=i.value)}}catch(a){r.e(a)}finally{r.f()}return Number.isFinite(n)&&Number.isFinite(t)}}])}();Pe.create=function(e){return new Pe(g({checks:[],typeName:vt.ZodNumber,coerce:(null===e||void 0===e?void 0:e.coerce)||!1},te(e)))};var Oe=function(){function e(){var t;return l(this,e),(t=k(this,e,arguments)).min=t.gte,t.max=t.lte,t}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(ou){return this._getInvalidInput(e)}if(this._getType(e)!==F.bigint)return this._getInvalidInput(e);var n,r=void 0,i=new B,a=P(this._def.checks);try{for(a.s();!(n=a.n()).done;){var o=n.value;if("min"===o.kind)(o.inclusive?e.data<o.value:e.data<=o.value)&&(L(r=this._getOrReturnCtx(e,r),{code:j.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),i.dirty());else if("max"===o.kind){(o.inclusive?e.data>o.value:e.data>=o.value)&&(L(r=this._getOrReturnCtx(e,r),{code:j.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),i.dirty())}else"multipleOf"===o.kind?e.data%o.value!==BigInt(0)&&(L(r=this._getOrReturnCtx(e,r),{code:j.not_multiple_of,multipleOf:o.value,message:o.message}),i.dirty()):t.assertNever(o)}}catch(s){a.e(s)}finally{a.f()}return{status:i.value,value:e.data}}},{key:"_getInvalidInput",value:function(e){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.bigint,received:t.parsedType}),W}},{key:"gte",value:function(e,t){return this.setLimit("min",e,!0,z.toString(t))}},{key:"gt",value:function(e,t){return this.setLimit("min",e,!1,z.toString(t))}},{key:"lte",value:function(e,t){return this.setLimit("max",e,!0,z.toString(t))}},{key:"lt",value:function(e,t){return this.setLimit("max",e,!1,z.toString(t))}},{key:"setLimit",value:function(t,n,r,i){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[{kind:t,value:n,inclusive:r,message:z.toString(i)}])}))}},{key:"_addCheck",value:function(t){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[t])}))}},{key:"positive",value:function(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:z.toString(e)})}},{key:"negative",value:function(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:z.toString(e)})}},{key:"nonpositive",value:function(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:z.toString(e)})}},{key:"nonnegative",value:function(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:z.toString(e)})}},{key:"multipleOf",value:function(e,t){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(t)})}},{key:"minValue",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"maxValue",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return t}}])}();Oe.create=function(e){var t;return new Oe(g({checks:[],typeName:vt.ZodBigInt,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t},te(e)))};var Ae=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==F.boolean){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.boolean,received:t.parsedType}),W}return H(e.data)}}])}();Ae.create=function(e){return new Ae(g({typeName:vt.ZodBoolean,coerce:(null===e||void 0===e?void 0:e.coerce)||!1},te(e)))};var Fe=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==F.date){var n=this._getOrReturnCtx(e);return L(n,{code:j.invalid_type,expected:F.date,received:n.parsedType}),W}if(isNaN(e.data.getTime()))return L(this._getOrReturnCtx(e),{code:j.invalid_date}),W;var r,i=new B,a=void 0,o=P(this._def.checks);try{for(o.s();!(r=o.n()).done;){var s=r.value;"min"===s.kind?e.data.getTime()<s.value&&(L(a=this._getOrReturnCtx(e,a),{code:j.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):"max"===s.kind?e.data.getTime()>s.value&&(L(a=this._getOrReturnCtx(e,a),{code:j.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):t.assertNever(s)}}catch(c){o.e(c)}finally{o.f()}return{status:i.value,value:new Date(e.data.getTime())}}},{key:"_addCheck",value:function(t){return new e(g(g({},this._def),{},{checks:[].concat(A(this._def.checks),[t])}))}},{key:"min",value:function(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:z.toString(t)})}},{key:"max",value:function(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:z.toString(t)})}},{key:"minDate",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return null!=t?new Date(t):null}},{key:"maxDate",get:function(){var e,t=null,n=P(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(i){n.e(i)}finally{n.f()}return null!=t?new Date(t):null}}])}();Fe.create=function(e){return new Fe(g({checks:[],coerce:(null===e||void 0===e?void 0:e.coerce)||!1,typeName:vt.ZodDate},te(e)))};var Ie=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._getType(e)!==F.symbol){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.symbol,received:t.parsedType}),W}return H(e.data)}}])}();Ie.create=function(e){return new Ie(g({typeName:vt.ZodSymbol},te(e)))};var je=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._getType(e)!==F.undefined){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.undefined,received:t.parsedType}),W}return H(e.data)}}])}();je.create=function(e){return new je(g({typeName:vt.ZodUndefined},te(e)))};var Re=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._getType(e)!==F.null){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.null,received:t.parsedType}),W}return H(e.data)}}])}();Re.create=function(e){return new Re(g({typeName:vt.ZodNull},te(e)))};var Me=function(){function e(){var t;return l(this,e),(t=k(this,e,arguments))._any=!0,t}return _(e,re),h(e,[{key:"_parse",value:function(e){return H(e.data)}}])}();Me.create=function(e){return new Me(g({typeName:vt.ZodAny},te(e)))};var De=function(){function e(){var t;return l(this,e),(t=k(this,e,arguments))._unknown=!0,t}return _(e,re),h(e,[{key:"_parse",value:function(e){return H(e.data)}}])}();De.create=function(e){return new De(g({typeName:vt.ZodUnknown},te(e)))};var Ue=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.never,received:t.parsedType}),W}}])}();Ue.create=function(e){return new Ue(g({typeName:vt.ZodNever},te(e)))};var Ne=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._getType(e)!==F.undefined){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.void,received:t.parsedType}),W}return H(e.data)}}])}();Ne.create=function(e){return new Ne(g({typeName:vt.ZodVoid},te(e)))};var Le=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.ctx,r=t.status,i=this._def;if(n.parsedType!==F.array)return L(n,{code:j.invalid_type,expected:F.array,received:n.parsedType}),W;if(null!==i.exactLength){var a=n.data.length>i.exactLength.value,o=n.data.length<i.exactLength.value;(a||o)&&(L(n,{code:a?j.too_big:j.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(null!==i.minLength&&n.data.length<i.minLength.value&&(L(n,{code:j.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),null!==i.maxLength&&n.data.length>i.maxLength.value&&(L(n,{code:j.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all(A(n.data).map(function(e,t){return i.type._parseAsync(new X(n,e,n.path,t))})).then(function(e){return B.mergeArray(r,e)});var s=A(n.data).map(function(e,t){return i.type._parseSync(new X(n,e,n.path,t))});return B.mergeArray(r,s)}},{key:"element",get:function(){return this._def.type}},{key:"min",value:function(t,n){return new e(g(g({},this._def),{},{minLength:{value:t,message:z.toString(n)}}))}},{key:"max",value:function(t,n){return new e(g(g({},this._def),{},{maxLength:{value:t,message:z.toString(n)}}))}},{key:"length",value:function(t,n){return new e(g(g({},this._def),{},{exactLength:{value:t,message:z.toString(n)}}))}},{key:"nonempty",value:function(e){return this.min(1,e)}}])}();function ze(e){if(e instanceof qe){var t={};for(var n in e.shape){var r=e.shape[n];t[n]=at.create(ze(r))}return new qe(g(g({},e._def),{},{shape:function(){return t}}))}return e instanceof Le?new Le(g(g({},e._def),{},{type:ze(e.element)})):e instanceof at?at.create(ze(e.unwrap())):e instanceof ot?ot.create(ze(e.unwrap())):e instanceof $e?$e.create(e.items.map(function(e){return ze(e)})):e}Le.create=function(e,t){return new Le(g({type:e,minLength:null,maxLength:null,exactLength:null,typeName:vt.ZodArray},te(t)))};var qe=function(){function e(){var t;return l(this,e),(t=k(this,e,arguments))._cached=null,t.nonstrict=t.passthrough,t.augment=t.extend,t}return _(e,re),h(e,[{key:"_getCached",value:function(){if(null!==this._cached)return this._cached;var e=this._def.shape(),n=t.objectKeys(e);return this._cached={shape:e,keys:n}}},{key:"_parse",value:function(e){if(this._getType(e)!==F.object){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.object,received:t.parsedType}),W}var n=this._processInputParams(e),r=n.status,i=n.ctx,a=this._getCached(),o=a.shape,c=a.keys,l=[];if(!(this._def.catchall instanceof Ue&&"strip"===this._def.unknownKeys))for(var f in i.data)c.includes(f)||l.push(f);var d,p=[],h=P(c);try{for(h.s();!(d=h.n()).done;){var m=d.value,v=o[m],g=i.data[m];p.push({key:{status:"valid",value:m},value:v._parse(new X(i,g,i.path,m)),alwaysSet:m in i.data})}}catch(T){h.e(T)}finally{h.f()}if(this._def.catchall instanceof Ue){var y=this._def.unknownKeys;if("passthrough"===y){var w,b=P(l);try{for(b.s();!(w=b.n()).done;){var k=w.value;p.push({key:{status:"valid",value:k},value:{status:"valid",value:i.data[k]}})}}catch(T){b.e(T)}finally{b.f()}}else if("strict"===y)l.length>0&&(L(i,{code:j.unrecognized_keys,keys:l}),r.dirty());else if("strip"!==y)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{var x,_=this._def.catchall,S=P(l);try{for(S.s();!(x=S.n()).done;){var C=x.value,E=i.data[C];p.push({key:{status:"valid",value:C},value:_._parse(new X(i,E,i.path,C)),alwaysSet:C in i.data})}}catch(T){S.e(T)}finally{S.f()}}return i.common.async?Promise.resolve().then(u(s().m(function e(){var t,n,r,i,a,o,c;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:t=[],n=P(p),e.p=1,n.s();case 2:if((r=n.n()).done){e.n=6;break}return i=r.value,e.n=3,i.key;case 3:return a=e.v,e.n=4,i.value;case 4:o=e.v,t.push({key:a,value:o,alwaysSet:i.alwaysSet});case 5:e.n=2;break;case 6:e.n=8;break;case 7:e.p=7,c=e.v,n.e(c);case 8:return e.p=8,n.f(),e.f(8);case 9:return e.a(2,t)}},e,null,[[1,7,8,9]])}))).then(function(e){return B.mergeObjectSync(r,e)}):B.mergeObjectSync(r,p)}},{key:"shape",get:function(){return this._def.shape()}},{key:"strict",value:function(t){var n=this;return z.errToObj,new e(g(g({},this._def),{},{unknownKeys:"strict"},void 0!==t?{errorMap:function(e,r){var i,a,o,s,c=null!==(o=null===(a=(i=n._def).errorMap)||void 0===a?void 0:a.call(i,e,r).message)&&void 0!==o?o:r.defaultError;return"unrecognized_keys"===e.code?{message:null!==(s=z.errToObj(t).message)&&void 0!==s?s:c}:{message:c}}}:{}))}},{key:"strip",value:function(){return new e(g(g({},this._def),{},{unknownKeys:"strip"}))}},{key:"passthrough",value:function(){return new e(g(g({},this._def),{},{unknownKeys:"passthrough"}))}},{key:"extend",value:function(t){var n=this;return new e(g(g({},this._def),{},{shape:function(){return g(g({},n._def.shape()),t)}}))}},{key:"merge",value:function(t){var n=this;return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:function(){return g(g({},n._def.shape()),t._def.shape())},typeName:vt.ZodObject})}},{key:"setKey",value:function(e,t){return this.augment(m({},e,t))}},{key:"catchall",value:function(t){return new e(g(g({},this._def),{},{catchall:t}))}},{key:"pick",value:function(n){var r=this,i={};return t.objectKeys(n).forEach(function(e){n[e]&&r.shape[e]&&(i[e]=r.shape[e])}),new e(g(g({},this._def),{},{shape:function(){return i}}))}},{key:"omit",value:function(n){var r=this,i={};return t.objectKeys(this.shape).forEach(function(e){n[e]||(i[e]=r.shape[e])}),new e(g(g({},this._def),{},{shape:function(){return i}}))}},{key:"deepPartial",value:function(){return ze(this)}},{key:"partial",value:function(n){var r=this,i={};return t.objectKeys(this.shape).forEach(function(e){var t=r.shape[e];n&&!n[e]?i[e]=t:i[e]=t.optional()}),new e(g(g({},this._def),{},{shape:function(){return i}}))}},{key:"required",value:function(n){var r=this,i={};return t.objectKeys(this.shape).forEach(function(e){if(n&&!n[e])i[e]=r.shape[e];else{for(var t=r.shape[e];t instanceof at;)t=t._def.innerType;i[e]=t}}),new e(g(g({},this._def),{},{shape:function(){return i}}))}},{key:"keyof",value:function(){return et(t.objectKeys(this.shape))}}])}();qe.create=function(e,t){return new qe(g({shape:function(){return e},unknownKeys:"strip",catchall:Ue.create(),typeName:vt.ZodObject},te(t)))},qe.strictCreate=function(e,t){return new qe(g({shape:function(){return e},unknownKeys:"strict",catchall:Ue.create(),typeName:vt.ZodObject},te(t)))},qe.lazycreate=function(e,t){return new qe(g({shape:e,unknownKeys:"strip",catchall:Ue.create(),typeName:vt.ZodObject},te(t)))};var Ze=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx,n=this._def.options;if(t.common.async)return Promise.all(n.map(function(){var e=u(s().m(function e(n){var r,i,a;return s().w(function(e){for(;;)switch(e.n){case 0:return r=g(g({},t),{},{common:g(g({},t.common),{},{issues:[]}),parent:null}),e.n=1,n._parseAsync({data:t.data,path:t.path,parent:r});case 1:return i=e.v,a=r,e.a(2,{result:i,ctx:a})}},e)}));return function(t){return e.apply(this,arguments)}}())).then(function(e){var n,r=P(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("valid"===i.result.status)return i.result}}catch(l){r.e(l)}finally{r.f()}var a,o=P(e);try{for(o.s();!(a=o.n()).done;){var s,c=a.value;if("dirty"===c.result.status)return(s=t.common.issues).push.apply(s,A(c.ctx.common.issues)),c.result}}catch(l){o.e(l)}finally{o.f()}var u=e.map(function(e){return new R(e.ctx.common.issues)});return L(t,{code:j.invalid_union,unionErrors:u}),W});var r,i,a=void 0,o=[],c=P(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=g(g({},t),{},{common:g(g({},t.common),{},{issues:[]}),parent:null}),d=l._parseSync({data:t.data,path:t.path,parent:f});if("valid"===d.status)return d;"dirty"!==d.status||a||(a={result:d,ctx:f}),f.common.issues.length&&o.push(f.common.issues)}}catch(h){c.e(h)}finally{c.f()}if(a)return(i=t.common.issues).push.apply(i,A(a.ctx.common.issues)),a.result;var p=o.map(function(e){return new R(e)});return L(t,{code:j.invalid_union,unionErrors:p}),W}},{key:"options",get:function(){return this._def.options}}])}();Ze.create=function(e,t){return new Ze(g({options:e,typeName:vt.ZodUnion},te(t)))};var Be=function(e){return e instanceof Ye?Be(e.schema):e instanceof it?Be(e.innerType()):e instanceof Xe?[e.value]:e instanceof tt?e.options:e instanceof nt?t.objectValues(e.enum):e instanceof st?Be(e._def.innerType):e instanceof je?[void 0]:e instanceof Re?[null]:e instanceof at?[void 0].concat(A(Be(e.unwrap()))):e instanceof ot?[null].concat(A(Be(e.unwrap()))):e instanceof ft||e instanceof pt?Be(e.unwrap()):e instanceof ct?Be(e._def.innerType):[]},We=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx;if(t.parsedType!==F.object)return L(t,{code:j.invalid_type,expected:F.object,received:t.parsedType}),W;var n=this.discriminator,r=t.data[n],i=this.optionsMap.get(r);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(L(t,{code:j.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),W)}},{key:"discriminator",get:function(){return this._def.discriminator}},{key:"options",get:function(){return this._def.options}},{key:"optionsMap",get:function(){return this._def.optionsMap}}],[{key:"create",value:function(t,n,r){var i,a=new Map,o=P(n);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=Be(s.shape[t]);if(!c.length)throw new Error("A discriminator value for key `".concat(t,"` could not be extracted from all schema options"));var u,l=P(c);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(a.has(f))throw new Error("Discriminator property ".concat(String(t)," has duplicate value ").concat(String(f)));a.set(f,s)}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return new e(g({typeName:vt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:a},te(r)))}}])}();function Ge(e,n){var r=I(e),i=I(n);if(e===n)return{valid:!0,data:e};if(r===F.object&&i===F.object){var a,o=t.objectKeys(n),s=t.objectKeys(e).filter(function(e){return-1!==o.indexOf(e)}),c=g(g({},e),n),u=P(s);try{for(u.s();!(a=u.n()).done;){var l=a.value,f=Ge(e[l],n[l]);if(!f.valid)return{valid:!1};c[l]=f.data}}catch(m){u.e(m)}finally{u.f()}return{valid:!0,data:c}}if(r===F.array&&i===F.array){if(e.length!==n.length)return{valid:!1};for(var d=[],p=0;p<e.length;p++){var h=Ge(e[p],n[p]);if(!h.valid)return{valid:!1};d.push(h.data)}return{valid:!0,data:d}}return r===F.date&&i===F.date&&+e===+n?{valid:!0,data:e}:{valid:!1}}var He=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx,i=function(e,t){if($(e)||$(t))return W;var i=Ge(e.value,t.value);return i.valid?((V(e)||V(t))&&n.dirty(),{status:n.value,value:i.data}):(L(r,{code:j.invalid_intersection_types}),W)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(function(e){var t=E(e,2),n=t[0],r=t[1];return i(n,r)}):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}])}();He.create=function(e,t,n){return new He(g({left:e,right:t,typeName:vt.ZodIntersection},te(n)))};var $e=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e),r=n.status,i=n.ctx;if(i.parsedType!==F.array)return L(i,{code:j.invalid_type,expected:F.array,received:i.parsedType}),W;if(i.data.length<this._def.items.length)return L(i,{code:j.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),W;!this._def.rest&&i.data.length>this._def.items.length&&(L(i,{code:j.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());var a=A(i.data).map(function(e,n){var r=t._def.items[n]||t._def.rest;return r?r._parse(new X(i,e,i.path,n)):null}).filter(function(e){return!!e});return i.common.async?Promise.all(a).then(function(e){return B.mergeArray(r,e)}):B.mergeArray(r,a)}},{key:"items",get:function(){return this._def.items}},{key:"rest",value:function(t){return new e(g(g({},this._def),{},{rest:t}))}}])}();$e.create=function(e,t){if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new $e(g({items:e,typeName:vt.ZodTuple,rest:null},te(t)))};var Ve=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"keySchema",get:function(){return this._def.keyType}},{key:"valueSchema",get:function(){return this._def.valueType}},{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx;if(r.parsedType!==F.object)return L(r,{code:j.invalid_type,expected:F.object,received:r.parsedType}),W;var i=[],a=this._def.keyType,o=this._def.valueType;for(var s in r.data)i.push({key:a._parse(new X(r,s,r.path,s)),value:o._parse(new X(r,r.data[s],r.path,s)),alwaysSet:s in r.data});return r.common.async?B.mergeObjectAsync(n,i):B.mergeObjectSync(n,i)}},{key:"element",get:function(){return this._def.valueType}}],[{key:"create",value:function(t,n,r){return new e(n instanceof re?g({keyType:t,valueType:n,typeName:vt.ZodRecord},te(r)):g({keyType:Ee.create(),valueType:t,typeName:vt.ZodRecord},te(n)))}}])}(),Ke=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"keySchema",get:function(){return this._def.keyType}},{key:"valueSchema",get:function(){return this._def.valueType}},{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx;if(r.parsedType!==F.map)return L(r,{code:j.invalid_type,expected:F.map,received:r.parsedType}),W;var i=this._def.keyType,a=this._def.valueType,o=A(r.data.entries()).map(function(e,t){var n=E(e,2),o=n[0],s=n[1];return{key:i._parse(new X(r,o,r.path,[t,"key"])),value:a._parse(new X(r,s,r.path,[t,"value"]))}});if(r.common.async){var c=new Map;return Promise.resolve().then(u(s().m(function e(){var t,r,i,a,u,l;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:t=P(o),e.p=1,t.s();case 2:if((r=t.n()).done){e.n=7;break}return i=r.value,e.n=3,i.key;case 3:return a=e.v,e.n=4,i.value;case 4:if(u=e.v,"aborted"!==a.status&&"aborted"!==u.status){e.n=5;break}return e.a(2,W);case 5:"dirty"!==a.status&&"dirty"!==u.status||n.dirty(),c.set(a.value,u.value);case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,l=e.v,t.e(l);case 9:return e.p=9,t.f(),e.f(9);case 10:return e.a(2,{status:n.value,value:c})}},e,null,[[1,8,9,10]])})))}var l,f=new Map,d=P(o);try{for(d.s();!(l=d.n()).done;){var p=l.value,h=p.key,m=p.value;if("aborted"===h.status||"aborted"===m.status)return W;"dirty"!==h.status&&"dirty"!==m.status||n.dirty(),f.set(h.value,m.value)}}catch(v){d.e(v)}finally{d.f()}return{status:n.value,value:f}}}])}();Ke.create=function(e,t,n){return new Ke(g({valueType:t,keyType:e,typeName:vt.ZodMap},te(n)))};var Qe=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx;if(r.parsedType!==F.set)return L(r,{code:j.invalid_type,expected:F.set,received:r.parsedType}),W;var i=this._def;null!==i.minSize&&r.data.size<i.minSize.value&&(L(r,{code:j.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),null!==i.maxSize&&r.data.size>i.maxSize.value&&(L(r,{code:j.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());var a=this._def.valueType;function o(e){var t,r=new Set,i=P(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if("aborted"===a.status)return W;"dirty"===a.status&&n.dirty(),r.add(a.value)}}catch(o){i.e(o)}finally{i.f()}return{status:n.value,value:r}}var s=A(r.data.values()).map(function(e,t){return a._parse(new X(r,e,r.path,t))});return r.common.async?Promise.all(s).then(function(e){return o(e)}):o(s)}},{key:"min",value:function(t,n){return new e(g(g({},this._def),{},{minSize:{value:t,message:z.toString(n)}}))}},{key:"max",value:function(t,n){return new e(g(g({},this._def),{},{maxSize:{value:t,message:z.toString(n)}}))}},{key:"size",value:function(e,t){return this.min(e,t).max(e,t)}},{key:"nonempty",value:function(e){return this.min(1,e)}}])}();Qe.create=function(e,t){return new Qe(g({valueType:e,minSize:null,maxSize:null,typeName:vt.ZodSet},te(t)))};var Je=function(){function e(){var t;return l(this,e),(t=k(this,e,arguments)).validate=t.implement,t}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx;if(t.parsedType!==F.function)return L(t,{code:j.invalid_type,expected:F.function,received:t.parsedType}),W;function n(e,n){return N({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,U(),M].filter(function(e){return!!e}),issueData:{code:j.invalid_arguments,argumentsError:n}})}function r(e,n){return N({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,U(),M].filter(function(e){return!!e}),issueData:{code:j.invalid_return_type,returnTypeError:n}})}var i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof rt){var o=this;return H(u(s().m(function e(){var t,c,u,l,f,d,p,h=arguments;return s().w(function(e){for(;;)switch(e.n){case 0:for(t=h.length,c=new Array(t),u=0;u<t;u++)c[u]=h[u];return l=new R([]),e.n=1,o._def.args.parseAsync(c,i).catch(function(e){throw l.addIssue(n(c,e)),l});case 1:return f=e.v,e.n=2,Reflect.apply(a,this,f);case 2:return d=e.v,e.n=3,o._def.returns._def.type.parseAsync(d,i).catch(function(e){throw l.addIssue(r(d,e)),l});case 3:return p=e.v,e.a(2,p)}},e,this)})))}var c=this;return H(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var s=c._def.args.safeParse(t,i);if(!s.success)throw new R([n(t,s.error)]);var u=Reflect.apply(a,this,s.data),l=c._def.returns.safeParse(u,i);if(!l.success)throw new R([r(u,l.error)]);return l.data})}},{key:"parameters",value:function(){return this._def.args}},{key:"returnType",value:function(){return this._def.returns}},{key:"args",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return new e(g(g({},this._def),{},{args:$e.create(n).rest(De.create())}))}},{key:"returns",value:function(t){return new e(g(g({},this._def),{},{returns:t}))}},{key:"implement",value:function(e){return this.parse(e)}},{key:"strictImplement",value:function(e){return this.parse(e)}}],[{key:"create",value:function(t,n,r){return new e(g({args:t||$e.create([]).rest(De.create()),returns:n||De.create(),typeName:vt.ZodFunction},te(r)))}}])}(),Ye=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"schema",get:function(){return this._def.getter()}},{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx;return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}])}();Ye.create=function(e,t){return new Ye(g({getter:e,typeName:vt.ZodLazy},te(t)))};var Xe=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(e.data!==this._def.value){var t=this._getOrReturnCtx(e);return L(t,{received:t.data,code:j.invalid_literal,expected:this._def.value}),W}return{status:"valid",value:e.data}}},{key:"value",get:function(){return this._def.value}}])}();function et(e,t){return new tt(g({values:e,typeName:vt.ZodEnum},te(t)))}Xe.create=function(e,t){return new Xe(g({value:e,typeName:vt.ZodLiteral},te(t)))};var tt=function(){function e(){var t;return l(this,e),t=k(this,e,arguments),q.set(t,void 0),t}return _(e,re),h(e,[{key:"_parse",value:function(e){if("string"!==typeof e.data){var n=this._getOrReturnCtx(e),r=this._def.values;return L(n,{expected:t.joinValues(r),received:n.parsedType,code:j.invalid_type}),W}if(J(this,q,"f")||Y(this,q,new Set(this._def.values),"f"),!J(this,q,"f").has(e.data)){var i=this._getOrReturnCtx(e),a=this._def.values;return L(i,{received:i.data,code:j.invalid_enum_value,options:a}),W}return H(e.data)}},{key:"options",get:function(){return this._def.values}},{key:"enum",get:function(){var e,t={},n=P(this._def.values);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=r}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"Values",get:function(){var e,t={},n=P(this._def.values);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=r}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"Enum",get:function(){var e,t={},n=P(this._def.values);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=r}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"extract",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return e.create(t,g(g({},this._def),n))}},{key:"exclude",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return e.create(this.options.filter(function(e){return!t.includes(e)}),g(g({},this._def),n))}}])}();q=new WeakMap,tt.create=et;var nt=function(){function e(){var t;return l(this,e),t=k(this,e,arguments),Z.set(t,void 0),t}return _(e,re),h(e,[{key:"_parse",value:function(e){var n=t.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==F.string&&r.parsedType!==F.number){var i=t.objectValues(n);return L(r,{expected:t.joinValues(i),received:r.parsedType,code:j.invalid_type}),W}if(J(this,Z,"f")||Y(this,Z,new Set(t.getValidEnumValues(this._def.values)),"f"),!J(this,Z,"f").has(e.data)){var a=t.objectValues(n);return L(r,{received:r.data,code:j.invalid_enum_value,options:a}),W}return H(e.data)}},{key:"enum",get:function(){return this._def.values}}])}();Z=new WeakMap,nt.create=function(e,t){return new nt(g({values:e,typeName:vt.ZodNativeEnum},te(t)))};var rt=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"unwrap",value:function(){return this._def.type}},{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e).ctx;if(n.parsedType!==F.promise&&!1===n.common.async)return L(n,{code:j.invalid_type,expected:F.promise,received:n.parsedType}),W;var r=n.parsedType===F.promise?n.data:Promise.resolve(n.data);return H(r.then(function(e){return t._def.type.parseAsync(e,{path:n.path,errorMap:n.common.contextualErrorMap})}))}}])}();rt.create=function(e,t){return new rt(g({type:e,typeName:vt.ZodPromise},te(t)))};var it=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"innerType",value:function(){return this._def.schema}},{key:"sourceType",value:function(){return this._def.schema._def.typeName===vt.ZodEffects?this._def.schema.sourceType():this._def.schema}},{key:"_parse",value:function(e){var n=this,r=this._processInputParams(e),i=r.status,a=r.ctx,o=this._def.effect||null,c={addIssue:function(e){L(a,e),e.fatal?i.abort():i.dirty()},get path(){return a.path}};if(c.addIssue=c.addIssue.bind(c),"preprocess"===o.type){var l=o.transform(a.data,c);if(a.common.async)return Promise.resolve(l).then(function(){var e=u(s().m(function e(t){var r;return s().w(function(e){for(;;)switch(e.n){case 0:if("aborted"!==i.value){e.n=1;break}return e.a(2,W);case 1:return e.n=2,n._def.schema._parseAsync({data:t,path:a.path,parent:a});case 2:if("aborted"!==(r=e.v).status){e.n=3;break}return e.a(2,W);case 3:if("dirty"!==r.status){e.n=4;break}return e.a(2,G(r.value));case 4:if("dirty"!==i.value){e.n=5;break}return e.a(2,G(r.value));case 5:return e.a(2,r)}},e)}));return function(t){return e.apply(this,arguments)}}());if("aborted"===i.value)return W;var f=this._def.schema._parseSync({data:l,path:a.path,parent:a});return"aborted"===f.status?W:"dirty"===f.status||"dirty"===i.value?G(f.value):f}if("refinement"===o.type){var d=function(e){var t=o.refinement(e,c);if(a.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===a.common.async){var p=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===p.status?W:("dirty"===p.status&&i.dirty(),d(p.value),{status:i.value,value:p.value})}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(function(e){return"aborted"===e.status?W:("dirty"===e.status&&i.dirty(),d(e.value).then(function(){return{status:i.value,value:e.value}}))})}if("transform"===o.type){if(!1===a.common.async){var h=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!K(h))return h;var m=o.transform(h.value,c);if(m instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:i.value,value:m}}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(function(e){return K(e)?Promise.resolve(o.transform(e.value,c)).then(function(e){return{status:i.value,value:e}}):e})}t.assertNever(o)}}])}();it.create=function(e,t,n){return new it(g({schema:e,typeName:vt.ZodEffects,effect:t},te(n)))},it.createWithPreprocess=function(e,t,n){return new it(g({schema:t,effect:{type:"preprocess",transform:e},typeName:vt.ZodEffects},te(n)))};var at=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){return this._getType(e)===F.undefined?H(void 0):this._def.innerType._parse(e)}},{key:"unwrap",value:function(){return this._def.innerType}}])}();at.create=function(e,t){return new at(g({innerType:e,typeName:vt.ZodOptional},te(t)))};var ot=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){return this._getType(e)===F.null?H(null):this._def.innerType._parse(e)}},{key:"unwrap",value:function(){return this._def.innerType}}])}();ot.create=function(e,t){return new ot(g({innerType:e,typeName:vt.ZodNullable},te(t)))};var st=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx,n=t.data;return t.parsedType===F.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}},{key:"removeDefault",value:function(){return this._def.innerType}}])}();st.create=function(e,t){return new st(g({innerType:e,typeName:vt.ZodDefault,defaultValue:"function"===typeof t.default?t.default:function(){return t.default}},te(t)))};var ct=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e).ctx,r=g(g({},n),{},{common:g(g({},n.common),{},{issues:[]})}),i=this._def.innerType._parse({data:r.data,path:r.path,parent:g({},r)});return Q(i)?i.then(function(e){return{status:"valid",value:"valid"===e.status?e.value:t._def.catchValue({get error(){return new R(r.common.issues)},input:r.data})}}):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new R(r.common.issues)},input:r.data})}}},{key:"removeCatch",value:function(){return this._def.innerType}}])}();ct.create=function(e,t){return new ct(g({innerType:e,typeName:vt.ZodCatch,catchValue:"function"===typeof t.catch?t.catch:function(){return t.catch}},te(t)))};var ut=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){if(this._getType(e)!==F.nan){var t=this._getOrReturnCtx(e);return L(t,{code:j.invalid_type,expected:F.nan,received:t.parsedType}),W}return{status:"valid",value:e.data}}}])}();ut.create=function(e){return new ut(g({typeName:vt.ZodNaN},te(e)))};var lt=Symbol("zod_brand"),ft=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx,n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}},{key:"unwrap",value:function(){return this._def.type}}])}(),dt=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e),r=n.status,i=n.ctx;if(i.common.async){var a=function(){var e=u(s().m(function e(){var n;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t._def.in._parseAsync({data:i.data,path:i.path,parent:i});case 1:if("aborted"!==(n=e.v).status){e.n=2;break}return e.a(2,W);case 2:if("dirty"!==n.status){e.n=3;break}return r.dirty(),e.a(2,G(n.value));case 3:return e.a(2,t._def.out._parseAsync({data:n.value,path:i.path,parent:i}));case 4:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return a()}var o=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return"aborted"===o.status?W:"dirty"===o.status?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:i.path,parent:i})}}],[{key:"create",value:function(t,n){return new e({in:t,out:n,typeName:vt.ZodPipeline})}}])}(),pt=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,re),h(e,[{key:"_parse",value:function(e){var t=this._def.innerType._parse(e),n=function(e){return K(e)&&(e.value=Object.freeze(e.value)),e};return Q(t)?t.then(function(e){return n(e)}):n(t)}},{key:"unwrap",value:function(){return this._def.innerType}}])}();function ht(e,t){var n="function"===typeof e?e(t):"string"===typeof e?{message:e}:e;return"string"===typeof n?{message:n}:n}function mt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e?Me.create().superRefine(function(r,i){var a,o,s=e(r);if(s instanceof Promise)return s.then(function(e){var a,o;if(!e){var s=ht(t,r),c=null===(o=null!==(a=s.fatal)&&void 0!==a?a:n)||void 0===o||o;i.addIssue(g(g({code:"custom"},s),{},{fatal:c}))}});if(!s){var c=ht(t,r),u=null===(o=null!==(a=c.fatal)&&void 0!==a?a:n)||void 0===o||o;i.addIssue(g(g({code:"custom"},c),{},{fatal:u}))}}):Me.create()}pt.create=function(e,t){return new pt(g({innerType:e,typeName:vt.ZodReadonly},te(t)))};var vt,gt={object:qe.lazycreate};!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(vt||(vt={}));var yt,wt=Ee.create,bt=Pe.create,kt=ut.create,xt=Oe.create,_t=Ae.create,St=Fe.create,Ct=Ie.create,Et=je.create,Tt=Re.create,Pt=Me.create,Ot=De.create,At=Ue.create,Ft=Ne.create,It=Le.create,jt=qe.create,Rt=qe.strictCreate,Mt=Ze.create,Dt=We.create,Ut=He.create,Nt=$e.create,Lt=Ve.create,zt=Ke.create,qt=Qe.create,Zt=Je.create,Bt=Ye.create,Wt=Xe.create,Gt=tt.create,Ht=nt.create,$t=rt.create,Vt=it.create,Kt=at.create,Qt=ot.create,Jt=it.createWithPreprocess,Yt=dt.create,Xt={string:function(e){return Ee.create(g(g({},e),{},{coerce:!0}))},number:function(e){return Pe.create(g(g({},e),{},{coerce:!0}))},boolean:function(e){return Ae.create(g(g({},e),{},{coerce:!0}))},bigint:function(e){return Oe.create(g(g({},e),{},{coerce:!0}))},date:function(e){return Fe.create(g(g({},e),{},{coerce:!0}))}},en=W,tn=Object.freeze({__proto__:null,defaultErrorMap:M,setErrorMap:function(e){D=e},getErrorMap:U,makeIssue:N,EMPTY_PATH:[],addIssueToContext:L,ParseStatus:B,INVALID:W,DIRTY:G,OK:H,isAborted:$,isDirty:V,isValid:K,isAsync:Q,get util(){return t},get objectUtil(){return n},ZodParsedType:F,getParsedType:I,ZodType:re,datetimeRegex:xe,ZodString:Ee,ZodNumber:Pe,ZodBigInt:Oe,ZodBoolean:Ae,ZodDate:Fe,ZodSymbol:Ie,ZodUndefined:je,ZodNull:Re,ZodAny:Me,ZodUnknown:De,ZodNever:Ue,ZodVoid:Ne,ZodArray:Le,ZodObject:qe,ZodUnion:Ze,ZodDiscriminatedUnion:We,ZodIntersection:He,ZodTuple:$e,ZodRecord:Ve,ZodMap:Ke,ZodSet:Qe,ZodFunction:Je,ZodLazy:Ye,ZodLiteral:Xe,ZodEnum:tt,ZodNativeEnum:nt,ZodPromise:rt,ZodEffects:it,ZodTransformer:it,ZodOptional:at,ZodNullable:ot,ZodDefault:st,ZodCatch:ct,ZodNaN:ut,BRAND:lt,ZodBranded:ft,ZodPipeline:dt,ZodReadonly:pt,custom:mt,Schema:re,ZodSchema:re,late:gt,get ZodFirstPartyTypeKind(){return vt},coerce:Xt,any:Pt,array:It,bigint:xt,boolean:_t,date:St,discriminatedUnion:Dt,effect:Vt,enum:Gt,function:Zt,instanceof:function(e){return mt(function(t){return t instanceof e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{message:"Input not instance of ".concat(e.name)})},intersection:Ut,lazy:Bt,literal:Wt,map:zt,nan:kt,nativeEnum:Ht,never:At,null:Tt,nullable:Qt,number:bt,object:jt,oboolean:function(){return _t().optional()},onumber:function(){return bt().optional()},optional:Kt,ostring:function(){return wt().optional()},pipeline:Yt,preprocess:Jt,promise:$t,record:Lt,set:qt,strictObject:Rt,string:wt,symbol:Ct,transformer:Vt,tuple:Nt,undefined:Et,union:Mt,unknown:Ot,void:Ft,NEVER:en,ZodIssueCode:j,quotelessJson:function(e){return JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:")},ZodError:R}),nn="2024-11-05",rn=[nn,"2024-10-07"],an="2.0",on=tn.union([tn.string(),tn.number().int()]),sn=tn.string(),cn=tn.object({_meta:tn.optional(tn.object({progressToken:tn.optional(on)}).passthrough())}).passthrough(),un=tn.object({method:tn.string(),params:tn.optional(cn)}),ln=tn.object({_meta:tn.optional(tn.object({}).passthrough())}).passthrough(),fn=tn.object({method:tn.string(),params:tn.optional(ln)}),dn=tn.object({_meta:tn.optional(tn.object({}).passthrough())}).passthrough(),pn=tn.union([tn.string(),tn.number().int()]),hn=tn.object({jsonrpc:tn.literal(an),id:pn}).merge(un).strict(),mn=tn.object({jsonrpc:tn.literal(an)}).merge(fn).strict(),vn=tn.object({jsonrpc:tn.literal(an),id:pn,result:dn}).strict();!function(e){e[e.ConnectionClosed=-32e3]="ConnectionClosed",e[e.RequestTimeout=-32001]="RequestTimeout",e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(yt||(yt={}));var gn=tn.object({jsonrpc:tn.literal(an),id:pn,error:tn.object({code:tn.number().int(),message:tn.string(),data:tn.optional(tn.unknown())})}).strict(),yn=tn.union([hn,mn,vn,gn]),wn=dn.strict(),bn=fn.extend({method:tn.literal("notifications/cancelled"),params:ln.extend({requestId:pn,reason:tn.string().optional()})}),kn=tn.object({name:tn.string(),version:tn.string()}).passthrough(),xn=tn.object({experimental:tn.optional(tn.object({}).passthrough()),sampling:tn.optional(tn.object({}).passthrough()),roots:tn.optional(tn.object({listChanged:tn.optional(tn.boolean())}).passthrough())}).passthrough(),_n=un.extend({method:tn.literal("initialize"),params:cn.extend({protocolVersion:tn.string(),capabilities:xn,clientInfo:kn})}),Sn=tn.object({experimental:tn.optional(tn.object({}).passthrough()),logging:tn.optional(tn.object({}).passthrough()),completions:tn.optional(tn.object({}).passthrough()),prompts:tn.optional(tn.object({listChanged:tn.optional(tn.boolean())}).passthrough()),resources:tn.optional(tn.object({subscribe:tn.optional(tn.boolean()),listChanged:tn.optional(tn.boolean())}).passthrough()),tools:tn.optional(tn.object({listChanged:tn.optional(tn.boolean())}).passthrough())}).passthrough(),Cn=dn.extend({protocolVersion:tn.string(),capabilities:Sn,serverInfo:kn,instructions:tn.optional(tn.string())}),En=fn.extend({method:tn.literal("notifications/initialized")}),Tn=un.extend({method:tn.literal("ping")}),Pn=tn.object({progress:tn.number(),total:tn.optional(tn.number())}).passthrough(),On=fn.extend({method:tn.literal("notifications/progress"),params:ln.merge(Pn).extend({progressToken:on})}),An=un.extend({params:cn.extend({cursor:tn.optional(sn)}).optional()}),Fn=dn.extend({nextCursor:tn.optional(sn)}),In=tn.object({uri:tn.string(),mimeType:tn.optional(tn.string())}).passthrough(),jn=In.extend({text:tn.string()}),Rn=In.extend({blob:tn.string().base64()}),Mn=tn.object({uri:tn.string(),name:tn.string(),description:tn.optional(tn.string()),mimeType:tn.optional(tn.string())}).passthrough(),Dn=tn.object({uriTemplate:tn.string(),name:tn.string(),description:tn.optional(tn.string()),mimeType:tn.optional(tn.string())}).passthrough(),Un=An.extend({method:tn.literal("resources/list")}),Nn=Fn.extend({resources:tn.array(Mn)}),Ln=An.extend({method:tn.literal("resources/templates/list")}),zn=Fn.extend({resourceTemplates:tn.array(Dn)}),qn=un.extend({method:tn.literal("resources/read"),params:cn.extend({uri:tn.string()})}),Zn=dn.extend({contents:tn.array(tn.union([jn,Rn]))}),Bn=fn.extend({method:tn.literal("notifications/resources/list_changed")}),Wn=un.extend({method:tn.literal("resources/subscribe"),params:cn.extend({uri:tn.string()})}),Gn=un.extend({method:tn.literal("resources/unsubscribe"),params:cn.extend({uri:tn.string()})}),Hn=fn.extend({method:tn.literal("notifications/resources/updated"),params:ln.extend({uri:tn.string()})}),$n=tn.object({name:tn.string(),description:tn.optional(tn.string()),required:tn.optional(tn.boolean())}).passthrough(),Vn=tn.object({name:tn.string(),description:tn.optional(tn.string()),arguments:tn.optional(tn.array($n))}).passthrough(),Kn=An.extend({method:tn.literal("prompts/list")}),Qn=Fn.extend({prompts:tn.array(Vn)}),Jn=un.extend({method:tn.literal("prompts/get"),params:cn.extend({name:tn.string(),arguments:tn.optional(tn.record(tn.string()))})}),Yn=tn.object({type:tn.literal("text"),text:tn.string()}).passthrough(),Xn=tn.object({type:tn.literal("image"),data:tn.string().base64(),mimeType:tn.string()}).passthrough(),er=tn.object({type:tn.literal("audio"),data:tn.string().base64(),mimeType:tn.string()}).passthrough(),tr=tn.object({type:tn.literal("resource"),resource:tn.union([jn,Rn])}).passthrough(),nr=tn.object({role:tn.enum(["user","assistant"]),content:tn.union([Yn,Xn,er,tr])}).passthrough(),rr=dn.extend({description:tn.optional(tn.string()),messages:tn.array(nr)}),ir=fn.extend({method:tn.literal("notifications/prompts/list_changed")}),ar=tn.object({name:tn.string(),description:tn.optional(tn.string()),inputSchema:tn.object({type:tn.literal("object"),properties:tn.optional(tn.object({}).passthrough())}).passthrough()}).passthrough(),or=An.extend({method:tn.literal("tools/list")}),sr=Fn.extend({tools:tn.array(ar)}),cr=dn.extend({content:tn.array(tn.union([Yn,Xn,er,tr])),isError:tn.boolean().default(!1).optional()}),ur=(cr.or(dn.extend({toolResult:tn.unknown()})),un.extend({method:tn.literal("tools/call"),params:cn.extend({name:tn.string(),arguments:tn.optional(tn.record(tn.unknown()))})})),lr=fn.extend({method:tn.literal("notifications/tools/list_changed")}),fr=tn.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),dr=un.extend({method:tn.literal("logging/setLevel"),params:cn.extend({level:fr})}),pr=fn.extend({method:tn.literal("notifications/message"),params:ln.extend({level:fr,logger:tn.optional(tn.string()),data:tn.unknown()})}),hr=tn.object({name:tn.string().optional()}).passthrough(),mr=tn.object({hints:tn.optional(tn.array(hr)),costPriority:tn.optional(tn.number().min(0).max(1)),speedPriority:tn.optional(tn.number().min(0).max(1)),intelligencePriority:tn.optional(tn.number().min(0).max(1))}).passthrough(),vr=tn.object({role:tn.enum(["user","assistant"]),content:tn.union([Yn,Xn,er])}).passthrough(),gr=un.extend({method:tn.literal("sampling/createMessage"),params:cn.extend({messages:tn.array(vr),systemPrompt:tn.optional(tn.string()),includeContext:tn.optional(tn.enum(["none","thisServer","allServers"])),temperature:tn.optional(tn.number()),maxTokens:tn.number().int(),stopSequences:tn.optional(tn.array(tn.string())),metadata:tn.optional(tn.object({}).passthrough()),modelPreferences:tn.optional(mr)})}),yr=dn.extend({model:tn.string(),stopReason:tn.optional(tn.enum(["endTurn","stopSequence","maxTokens"]).or(tn.string())),role:tn.enum(["user","assistant"]),content:tn.discriminatedUnion("type",[Yn,Xn,er])}),wr=tn.object({type:tn.literal("ref/resource"),uri:tn.string()}).passthrough(),br=tn.object({type:tn.literal("ref/prompt"),name:tn.string()}).passthrough(),kr=un.extend({method:tn.literal("completion/complete"),params:cn.extend({ref:tn.union([br,wr]),argument:tn.object({name:tn.string(),value:tn.string()}).passthrough()})}),xr=dn.extend({completion:tn.object({values:tn.array(tn.string()).max(100),total:tn.optional(tn.number().int()),hasMore:tn.optional(tn.boolean())}).passthrough()}),_r=tn.object({uri:tn.string().startsWith("file://"),name:tn.optional(tn.string())}).passthrough(),Sr=un.extend({method:tn.literal("roots/list")}),Cr=dn.extend({roots:tn.array(_r)}),Er=fn.extend({method:tn.literal("notifications/roots/list_changed")}),Tr=(tn.union([Tn,_n,kr,dr,Jn,Kn,Un,Ln,qn,Wn,Gn,ur,or]),tn.union([bn,On,En,Er]),tn.union([wn,yr,Cr]),tn.union([Tn,gr,Sr]),tn.union([bn,On,pr,Hn,Bn,lr,ir]),tn.union([wn,Cn,xr,rr,Qn,Nn,zn,Zn,cr,sr]),function(){function e(t,n,r){var i;return l(this,e),(i=k(this,e,["MCP error ".concat(t,": ").concat(n)])).code=t,i.data=r,i.name="McpError",i}return _(e,O(Error)),h(e)}()),Pr=["progressToken"],Or=function(){return h(function e(t){var n=this;l(this,e),this._options=t,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this.setNotificationHandler(bn,function(e){var t=n._requestHandlerAbortControllers.get(e.params.requestId);null===t||void 0===t||t.abort(e.params.reason)}),this.setNotificationHandler(On,function(e){n._onprogress(e)}),this.setRequestHandler(Tn,function(e){return{}})},[{key:"_setupTimeout",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this._timeoutInfo.set(e,{timeoutId:setTimeout(r,t),startTime:Date.now(),timeout:t,maxTotalTimeout:n,resetTimeoutOnProgress:i,onTimeout:r})}},{key:"_resetTimeout",value:function(e){var t=this._timeoutInfo.get(e);if(!t)return!1;var n=Date.now()-t.startTime;if(t.maxTotalTimeout&&n>=t.maxTotalTimeout)throw this._timeoutInfo.delete(e),new Tr(yt.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:t.maxTotalTimeout,totalElapsed:n});return clearTimeout(t.timeoutId),t.timeoutId=setTimeout(t.onTimeout,t.timeout),!0}},{key:"_cleanupTimeout",value:function(e){var t=this._timeoutInfo.get(e);t&&(clearTimeout(t.timeoutId),this._timeoutInfo.delete(e))}},{key:"connect",value:function(){var e=u(s().m(function e(t){var n=this;return s().w(function(e){for(;;)switch(e.n){case 0:return this._transport=t,this._transport.onclose=function(){n._onclose()},this._transport.onerror=function(e){n._onerror(e)},this._transport.onmessage=function(e){"method"in e?"id"in e?n._onrequest(e):n._onnotification(e):n._onresponse(e)},e.n=1,this._transport.start();case 1:return e.a(2)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_onclose",value:function(){var e,t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,null===(e=this.onclose)||void 0===e||e.call(this);var n,r=new Tr(yt.ConnectionClosed,"Connection closed"),i=P(t.values());try{for(i.s();!(n=i.n()).done;){(0,n.value)(r)}}catch(a){i.e(a)}finally{i.f()}}},{key:"_onerror",value:function(e){var t;null===(t=this.onerror)||void 0===t||t.call(this,e)}},{key:"_onnotification",value:function(e){var t,n=this,r=null!==(t=this._notificationHandlers.get(e.method))&&void 0!==t?t:this.fallbackNotificationHandler;void 0!==r&&Promise.resolve().then(function(){return r(e)}).catch(function(e){return n._onerror(new Error("Uncaught error in notification handler: ".concat(e)))})}},{key:"_onrequest",value:function(e){var t,n,r,i=this,a=null!==(t=this._requestHandlers.get(e.method))&&void 0!==t?t:this.fallbackRequestHandler;if(void 0!==a){var o=new AbortController;this._requestHandlerAbortControllers.set(e.id,o);var s={signal:o.signal,sessionId:null===(r=this._transport)||void 0===r?void 0:r.sessionId};Promise.resolve().then(function(){return a(e,s)}).then(function(t){var n;if(!o.signal.aborted)return null===(n=i._transport)||void 0===n?void 0:n.send({result:t,jsonrpc:"2.0",id:e.id})},function(t){var n,r;if(!o.signal.aborted)return null===(n=i._transport)||void 0===n?void 0:n.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(t.code)?t.code:yt.InternalError,message:null!==(r=t.message)&&void 0!==r?r:"Internal error"}})}).catch(function(e){return i._onerror(new Error("Failed to send response: ".concat(e)))}).finally(function(){i._requestHandlerAbortControllers.delete(e.id)})}else null===(n=this._transport)||void 0===n||n.send({jsonrpc:"2.0",id:e.id,error:{code:yt.MethodNotFound,message:"Method not found"}}).catch(function(e){return i._onerror(new Error("Failed to send an error response: ".concat(e)))})}},{key:"_onprogress",value:function(e){var t=e.params,n=t.progressToken,r=T(t,Pr),i=Number(n),a=this._progressHandlers.get(i);if(a){var o=this._responseHandlers.get(i),s=this._timeoutInfo.get(i);if(s&&o&&s.resetTimeoutOnProgress)try{this._resetTimeout(i)}catch(c){return void o(c)}a(r)}else this._onerror(new Error("Received a progress notification for an unknown token: ".concat(JSON.stringify(e))))}},{key:"_onresponse",value:function(e){var t=Number(e.id),n=this._responseHandlers.get(t);void 0!==n?(this._responseHandlers.delete(t),this._progressHandlers.delete(t),this._cleanupTimeout(t),n("result"in e?e:new Tr(e.error.code,e.error.message,e.error.data))):this._onerror(new Error("Received a response for an unknown message ID: ".concat(JSON.stringify(e))))}},{key:"transport",get:function(){return this._transport}},{key:"close",value:function(){var e=u(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,null===(t=this._transport)||void 0===t?void 0:t.close();case 1:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"request",value:function(e,t,n){var r=this;return new Promise(function(i,a){var o,s,c,u,l;if(r._transport){!0===(null===(o=r._options)||void 0===o?void 0:o.enforceStrictCapabilities)&&r.assertCapabilityForMethod(e.method),null===(s=null===n||void 0===n?void 0:n.signal)||void 0===s||s.throwIfAborted();var f=r._requestMessageId++,d=g(g({},e),{},{jsonrpc:"2.0",id:f});(null===n||void 0===n?void 0:n.onprogress)&&(r._progressHandlers.set(f,n.onprogress),d.params=g(g({},e.params),{},{_meta:{progressToken:f}}));var p=function(e){var t;r._responseHandlers.delete(f),r._progressHandlers.delete(f),r._cleanupTimeout(f),null===(t=r._transport)||void 0===t||t.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:f,reason:String(e)}}).catch(function(e){return r._onerror(new Error("Failed to send cancellation: ".concat(e)))}),a(e)};r._responseHandlers.set(f,function(e){var r;if(!(null===(r=null===n||void 0===n?void 0:n.signal)||void 0===r?void 0:r.aborted)){if(e instanceof Error)return a(e);try{var o=t.parse(e.result);i(o)}catch(s){a(s)}}}),null===(c=null===n||void 0===n?void 0:n.signal)||void 0===c||c.addEventListener("abort",function(){var e;p(null===(e=null===n||void 0===n?void 0:n.signal)||void 0===e?void 0:e.reason)});var h=null!==(u=null===n||void 0===n?void 0:n.timeout)&&void 0!==u?u:6e4;r._setupTimeout(f,h,null===n||void 0===n?void 0:n.maxTotalTimeout,function(){return p(new Tr(yt.RequestTimeout,"Request timed out",{timeout:h}))},null!==(l=null===n||void 0===n?void 0:n.resetTimeoutOnProgress)&&void 0!==l&&l),r._transport.send(d).catch(function(e){r._cleanupTimeout(f),a(e)})}else a(new Error("Not connected"))})}},{key:"notification",value:function(){var e=u(s().m(function e(t){var n;return s().w(function(e){for(;;)switch(e.n){case 0:if(this._transport){e.n=1;break}throw new Error("Not connected");case 1:return this.assertNotificationCapability(t.method),n=g(g({},t),{},{jsonrpc:"2.0"}),e.n=2,this._transport.send(n);case 2:return e.a(2)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setRequestHandler",value:function(e,t){var n=e.shape.method.value;this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,function(n,r){return Promise.resolve(t(e.parse(n),r))})}},{key:"removeRequestHandler",value:function(e){this._requestHandlers.delete(e)}},{key:"assertCanSetRequestHandler",value:function(e){if(this._requestHandlers.has(e))throw new Error("A request handler for ".concat(e," already exists, which would be overridden"))}},{key:"setNotificationHandler",value:function(e,t){this._notificationHandlers.set(e.shape.method.value,function(n){return Promise.resolve(t(e.parse(n)))})}},{key:"removeNotificationHandler",value:function(e){this._notificationHandlers.delete(e)}}])}();var Ar,Fr=function(){function e(t,n){var r,i;return l(this,e),(r=k(this,e,[n]))._serverInfo=t,r._capabilities=null!==(i=null===n||void 0===n?void 0:n.capabilities)&&void 0!==i?i:{},r._instructions=null===n||void 0===n?void 0:n.instructions,r.setRequestHandler(_n,function(e){return r._oninitialize(e)}),r.setNotificationHandler(En,function(){var e;return null===(e=r.oninitialized)||void 0===e?void 0:e.call(r)}),r}return _(e,Or),h(e,[{key:"registerCapabilities",value:function(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");var t,n;this._capabilities=(t=this._capabilities,n=e,Object.entries(n).reduce(function(e,t){var n=E(t,2),r=n[0],i=n[1];return e[r]=i&&"object"===typeof i&&e[r]?g(g({},e[r]),i):i,e},g({},t)))}},{key:"assertCapabilityForMethod",value:function(e){var t,n;switch(e){case"sampling/createMessage":if(!(null===(t=this._clientCapabilities)||void 0===t?void 0:t.sampling))throw new Error("Client does not support sampling (required for ".concat(e,")"));break;case"roots/list":if(!(null===(n=this._clientCapabilities)||void 0===n?void 0:n.roots))throw new Error("Client does not support listing roots (required for ".concat(e,")"))}}},{key:"assertNotificationCapability",value:function(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error("Server does not support logging (required for ".concat(e,")"));break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error("Server does not support notifying about resources (required for ".concat(e,")"));break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error("Server does not support notifying of tool list changes (required for ".concat(e,")"));break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error("Server does not support notifying of prompt list changes (required for ".concat(e,")"))}}},{key:"assertRequestHandlerCapability",value:function(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error("Server does not support sampling (required for ".concat(e,")"));break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error("Server does not support logging (required for ".concat(e,")"));break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error("Server does not support prompts (required for ".concat(e,")"));break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error("Server does not support resources (required for ".concat(e,")"));break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error("Server does not support tools (required for ".concat(e,")"))}}},{key:"_oninitialize",value:function(){var e=u(s().m(function e(t){var n;return s().w(function(e){for(;;)if(0===e.n)return n=t.params.protocolVersion,this._clientCapabilities=t.params.capabilities,this._clientVersion=t.params.clientInfo,e.a(2,g({protocolVersion:rn.includes(n)?n:nn,capabilities:this.getCapabilities(),serverInfo:this._serverInfo},this._instructions&&{instructions:this._instructions}))},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getClientCapabilities",value:function(){return this._clientCapabilities}},{key:"getClientVersion",value:function(){return this._clientVersion}},{key:"getCapabilities",value:function(){return this._capabilities}},{key:"ping",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.request({method:"ping"},wn))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createMessage",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.request({method:"sampling/createMessage",params:t},yr,n))},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"listRoots",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.request({method:"roots/list",params:t},Cr,n))},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendLoggingMessage",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.notification({method:"notifications/message",params:t}))},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"sendResourceUpdated",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.notification({method:"notifications/resources/updated",params:t}))},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"sendResourceListChanged",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.notification({method:"notifications/resources/list_changed"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendToolListChanged",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.notification({method:"notifications/tools/list_changed"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendPromptListChanged",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.notification({method:"notifications/prompts/list_changed"}))},e,this)}));return function(){return e.apply(this,arguments)}}()}])}();function Ir(e){var t=null===e||void 0===e?void 0:e.toUpperCase();return"TRACE"===t?Ar.TRACE:"DEBUG"===t?Ar.DEBUG:"INFO"===t?Ar.INFO:"WARN"===t?Ar.WARN:"ERROR"===t?Ar.ERROR:Ar.INFO}function jr(e,t){var n=parseInt(e||"",10);return isNaN(n)?t:n}function Rr(){return{reviewNewCodeWithFilterTemplateUri:process.env.REVIEW_NEW_CODE_WITH_FILTER_TEMPLATE_URI,reviewNewCodeTemplateUri:process.env.REVIEW_NEW_CODE_TEMPLATE_URI,reviewFileTemplateUri:process.env.REVIEW_FILE_TEMPLATE_URI,analysisUnitTestsTemplateUri:process.env.ANALYSIS_UNIT_TESTS_TEMPLATE_URI,generateTestCasesTemplateUri:process.env.GENERATE_TEST_CASES_TEMPLATE_URI,generateCodeReviewsTemplateUri:process.env.GENERATE_CODE_REVIEWS_TEMPLATE_URI,describeImageTemplateUri:process.env.DESCRIBE_IMAGE_TEMPLATE_URI,convertImageTemplateUri:process.env.CONVERT_IMAGE_TEMPLATE_URI,levelLogging:Ir(process.env.LOG_LEVEL),filesystemAllowedDirectories:(e=process.env.FILE_SYSTEM_ALLOWED_DIRECTORIES,e?e.split(";").filter(function(e){return e.trim().length>0}).map(function(e){return e.trim()}):[]),samplingBatchSize:jr(process.env.SAMPLING_BATCH_SIZE,5),samplingMaxBackoffSeconds:jr(process.env.SAMPLING_MAX_BACKOFF_SECONDS,30),samplingMaxQueueSize:jr(process.env.SAMPLING_MAX_QUEUE_SIZE,100),samplingRequestTimeoutMs:jr(process.env.SAMPLING_REQUEST_TIMEOUT_MS,3e4),samplingMaxCacheSize:jr(process.env.SAMPLING_MAX_CACHE_SIZE,1e3),samplingCacheExpiryMs:jr(process.env.SAMPLING_CACHE_EXPIRY_MS,3e5),samplingBaseDelayMs:jr(process.env.SAMPLING_BASE_DELAY_MS,1e3),samplingMaxRetries:jr(process.env.SAMPLING_MAX_RETRIES,3),samplingJitterPercent:jr(process.env.SAMPLING_JITTER_PERCENT,25),samplingDefaultMaxTokens:jr(process.env.SAMPLING_DEFAULT_MAX_TOKENS,4e3)};var e}!function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR"}(Ar||(Ar={}));var Mr=new(function(){return h(function e(t){l(this,e),m(this,"logLevel",void 0),this.logLevel=null!==t&&void 0!==t?t:Ar.INFO},[{key:"shouldLog",value:function(e){return e>=this.logLevel}},{key:"trace",value:function(e,t){this.shouldLog(Ar.TRACE)&&this.log("TRACE: ".concat(e),t)}},{key:"debug",value:function(e,t){this.shouldLog(Ar.DEBUG)&&this.log("DEBUG: ".concat(e),t)}},{key:"info",value:function(e,t){this.shouldLog(Ar.INFO)&&this.log("INFO: ".concat(e),t)}},{key:"warn",value:function(e,t){this.shouldLog(Ar.WARN)&&this.log("WARNING: ".concat(e),t)}},{key:"error",value:function(e,t){this.shouldLog(Ar.ERROR)&&this.log("ERROR: ".concat(e),t)}},{key:"log",value:function(e,t){t?console.error(e+": "+JSON.stringify(t)):console.error(e)}}])}())(Rr().levelLogging),Dr=function(){function e(t,n){var r;return l(this,e),m(r=k(this,e,[t]),"toolName",void 0),r.toolName=n,r.name="ToolError",r}return _(e,O(Error)),h(e)}(),Ur=function(){function e(t,n,r){var i;return l(this,e),m(i=k(this,e,[t,r]),"parameter",void 0),i.parameter=n,i.name="ValidationError",i}return _(e,Dr),h(e)}(),Nr=function(){function e(t,n){var r;return l(this,e),m(r=k(this,e,[t]),"promptLength",void 0),r.promptLength=n,r.name="SamplingError",r}return _(e,O(Error)),h(e)}(),Lr=function(){function e(t,n){var r;return l(this,e),m(r=k(this,e,[t]),"filePath",void 0),r.filePath=n,r.name="FileOperationError",r}return _(e,O(Error)),h(e)}(),zr=function(){function e(t,n,r){var i;return l(this,e),m(i=k(this,e,[t]),"requestedPath",void 0),m(i,"allowedDirectories",void 0),i.requestedPath=n,i.allowedDirectories=r,i.name="PathValidationError",i}return _(e,O(Error)),h(e)}(),qr=function(){function e(t,n,r){var i;return l(this,e),m(i=k(this,e,[t]),"path",void 0),m(i,"operation",void 0),i.path=n,i.operation=r,i.name="FilesystemSecurityError",i}return _(e,O(Error)),h(e)}(),Zr=function(){function e(t,n){var r;return l(this,e),m(r=k(this,e,[t]),"command",void 0),r.command=n,r.name="GitError",r}return _(e,O(Error)),h(e)}(),Br=function(){function e(t,n,r){var i;return l(this,e),m(i=k(this,e,[t,r]),"fileUri",void 0),i.fileUri=n,i.name="GitDiffError",i}return _(e,Zr),h(e)}(),Wr=function(){function e(t,n){var r;return l(this,e),(r=k(this,e,[t,n])).name="GitStagingError",r}return _(e,Zr),h(e)}();function Gr(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(f(e)+" is not iterable")}const Hr=e(import.meta.url)("node:child_process"),$r=e(import.meta.url)("node:os");function Vr(){var e=(0,$r.platform)();return{isWindows:"win32"===e,isMac:"darwin"===e,isLinux:"linux"===e,gitCommand:"git"}}function Kr(e,t,n){return Qr.apply(this,arguments)}function Qr(){return Qr=u(s().m(function e(t,n,r){var i,a;return s().w(function(e){for(;;)if(0===e.n)return i=Date.now(),a=n.timeout||3e4,e.a(2,new Promise(function(e,o){var s,c,u,l=(0,Hr.spawn)(r.gitCommand,t,{cwd:n.cwd,env:process.env,windowsHide:!0}),f="",d="",p=!1;a>0&&(u=setTimeout(function(){p=!0,l.kill("SIGTERM"),setTimeout(function(){l.killed||l.kill("SIGKILL")},5e3)},a)),null===(s=l.stdout)||void 0===s||s.on("data",function(e){f+=e.toString(n.encoding||"utf8")}),null===(c=l.stderr)||void 0===c||c.on("data",function(e){d+=e.toString(n.encoding||"utf8")}),l.on("error",function(e){u&&clearTimeout(u),o(new Error("Failed to execute git command: ".concat(e.message,". Is git installed and in PATH?")))}),l.on("close",function(n,r){u&&clearTimeout(u);var s=Date.now()-i,c=null!==n&&void 0!==n?n:-1;p?o(new Error("Git command timed out after ".concat(a,"ms. Command: git ").concat(t.join(" ")))):r?o(new Error("Git command was killed with signal ".concat(r,". Command: git ").concat(t.join(" ")))):e({stdout:f,stderr:d,exitCode:c,duration:s})})}))},e)})),Qr.apply(this,arguments)}function Jr(e,t){return Yr.apply(this,arguments)}function Yr(){return(Yr=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d,p,h,m;return s().w(function(e){for(;;)switch(e.n){case 0:o=Vr(),c=null!==(r=n.maxRetries)&&void 0!==r?r:3,u=null!==(i=n.retryDelay)&&void 0!==i?i:100,l=null===(a=n.useExponentialBackoff)||void 0===a||a,f="git ".concat(t.join(" ")),Mr.debug("Executing git command",{command:f,cwd:n.cwd,platform:(0,$r.platform)(),maxRetries:c,timeout:n.timeout||3e4}),p=0,h=s().m(function e(){var r,i,a;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Kr(t,n,o);case 1:return r=e.v,Mr.debug("Git command completed",{command:f,exitCode:r.exitCode,duration:r.duration,attempt:p+1,stdoutLength:r.stdout.length,stderrLength:r.stderr.length}),0!==r.exitCode&&Mr.warn("Git command completed with non-zero exit code",{command:f,exitCode:r.exitCode,stderr:r.stderr}),e.a(2,{v:r});case 2:if(e.p=2,a=e.v,d=a instanceof Error?a:new Error(String(a)),!(++p>c)){e.n=3;break}throw Mr.error("Git command failed after all retries",{command:f,attempts:p,error:d.message,cwd:n.cwd}),d;case 3:return i=l?u*Math.pow(2,p-1):u,Mr.warn("Git command failed, retrying",{command:f,attempt:p,maxRetries:c,nextRetryDelay:i,error:d.message}),e.n=4,new Promise(function(e){return setTimeout(e,i)});case 4:return e.a(2)}},e,null,[[0,2]])});case 1:if(!(p<=c)){e.n=4;break}return e.d(Gr(h()),2);case 2:if(!(m=e.v)){e.n=3;break}return e.a(2,m.v);case 3:e.n=1;break;case 4:throw d||new Error("Git command failed for unknown reason");case 5:return e.a(2)}},e)}))).apply(this,arguments)}function Xr(e){return e&&e.trim()?e.split(/\s+/).filter(Boolean):[]}function ei(e,t){return ti.apply(this,arguments)}function ti(){return(ti=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d,p,h,m,v,g,y;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.fileUri,i=t.gitDiffOptions,a=t.contextSize,o=void 0===a?0:a,c=["--no-pager","diff"].concat(A(Xr(i)),["-U".concat(o),"--",r]),u="git ".concat(c.join(" ")),Mr.debug("Executing git diff",{fileUri:r,gitDiffOptions:i,contextSize:o,gitCommand:u,cwd:n.cwd}),l=Date.now(),e.p=1,e.n=2,Jr(c,n);case 2:if(0===(f=e.v).exitCode){e.n=3;break}throw new Error("Git diff command exited with code ".concat(f.exitCode,". stderr: ").concat(f.stderr));case 3:if(d=f.stdout,p=f.duration,Mr.debug("Git diff command completed",{fileUri:r,duration:p,diffOutputLength:d.length,stderrLength:f.stderr.length}),Mr.trace("Git diff output preview",{fileUri:r,diffPreview:d}),d){e.n=4;break}return Mr.info("No changes found in git diff",{fileUri:r,gitDiffOptions:i}),e.a(2,{success:!1,error:"No changes found for file: ".concat(r)});case 4:if(h=d.split("\n").filter(function(e){return!e.startsWith("-")}).map(function(e){return e.startsWith("+++")?"Path: ".concat(e.substring(4)):e}).join("\n"),m=h.split("\n").filter(function(e){return e.startsWith("+")}).length,Mr.debug("Git diff processing completed",{fileUri:r,addedLineCount:m,addedLinesLength:h.length}),h.trim()){e.n=5;break}return Mr.info("No added lines found in git diff",{fileUri:r,gitDiffOptions:i,totalLines:d.split("\n").length}),e.a(2,{success:!1,error:"No added lines found in diff for file: ".concat(r)});case 5:return Mr.trace("Git diff successful",{fileUri:r,contentLength:d.length,addedLinesPreview:h}),e.a(2,{success:!0,content:d,addedLines:h});case 6:throw e.p=6,y=e.v,v=Date.now()-l,g="Git diff command failed: ".concat(y instanceof Error?y.message:String(y)),Mr.error("Git diff command failed",{fileUri:r,gitCommand:u,error:g,duration:v,cwd:n.cwd}),new Br(g,r,u);case 7:return e.a(2)}},e,null,[[1,6]])}))).apply(this,arguments)}function ni(e){return e.map(function(e){return function(e){if(!e)return e;var t=(e.match(/\\/g)||[]).length;t>0&&Mr.debug("Normalizing git pathspec with backslashes",{original:e,backslashCount:t});var n=e.replace(/\\/g,"/");return t>0&&Mr.debug("Normalized git pathspec",{original:e,normalized:n}),n}(e)})}function ri(e,t,n){return ii.apply(this,arguments)}function ii(){return(ii=u(s().m(function e(t,n,r){var i,a,o,c,u,l,f,d;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=ni(n),a=["--no-pager","diff"].concat(A(Xr(t)),["--name-only"]),i.length>0&&a.push.apply(a,["--"].concat(A(i))),o="git ".concat(a.join(" ")),Mr.debug("Getting new code changes",{gitDiffFileFilter:i,originalPathspecs:n!==i?n:void 0,gitCommand:o,cwd:r.cwd}),e.p=1,e.n=2,Jr(a,r);case 2:if(0===(c=e.v).exitCode){e.n=3;break}throw new Error("Git command exited with code ".concat(c.exitCode,". stderr: ").concat(c.stderr));case 3:if(u=c.stdout,l=c.duration,Mr.debug("Git new code files command completed",{duration:l,stdoutLength:u.length,stderrLength:c.stderr.length}),Mr.trace("Git new code files output",{stdout:u.substring(0,500)}),u){e.n=4;break}return Mr.warn("No new code files found",{gitDiffFileFilter:i}),e.a(2,[]);case 4:return e.a(2,u.split("\n").filter(Boolean));case 5:throw e.p=5,d=e.v,f="Git command failed: ".concat(d instanceof Error?d.message:String(d)),Mr.error("Git new code files command failed",{gitCommand:o,error:f,cwd:r.cwd}),new Wr(f,o);case 6:return e.a(2)}},e,null,[[1,5]])}))).apply(this,arguments)}function ai(e,t,n){return oi.apply(this,arguments)}function oi(){return oi=u(s().m(function e(t,n,r){var i,a,o,c,l,f,d;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,ri(t,n,r);case 1:return i=e.v,Mr.debug("Processing new code files",{fileCount:i.length,files:i}),a=Date.now(),e.p=2,e.n=3,Promise.all(i.map(function(){var e=u(s().m(function e(n){var i,a;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,Mr.trace("Processing new code file",{file:n}),e.n=1,ei({fileUri:n,gitDiffOptions:t},r);case 1:if(!(i=e.v).success||!i.addedLines){e.n=2;break}return Mr.trace("new code file processed successfully",{file:n,addedLinesLength:i.addedLines.length}),e.a(2,{file:n,content:i.addedLines});case 2:return Mr.warn("Git diff failed for new code file",{file:n,error:i.error}),e.a(2,void 0);case 3:e.n=5;break;case 4:return e.p=4,a=e.v,Mr.warn("Git diff failed for new code file",{file:n,error:a instanceof Error?a.message:String(a)}),e.a(2,void 0);case 5:return e.a(2)}},e,null,[[0,4]])}));return function(t){return e.apply(this,arguments)}}()));case 3:return o=e.v,c=o.filter(function(e){return void 0!==e}),Mr.debug("New code changes processing completed",{totalFiles:i.length,processedFiles:c.length,skippedFiles:i.length-c.length}),e.a(2,{success:!0,newCodeFiles:c});case 4:throw e.p=4,d=e.v,l=Date.now()-a,f="Git command failed: ".concat(d instanceof Error?d.message:String(d)),Mr.error("Git new code changes command failed",{error:f,duration:l,cwd:r.cwd}),new Wr(f);case 5:return e.a(2)}},e,null,[[2,4]])})),oi.apply(this,arguments)}var si=new(function(){return h(function e(){l(this,e)},[{key:"getDiff",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,ei(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNewCodeChanges",value:function(){var e=u(s().m(function e(t,n,r){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,ai(t,n,r))},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getDiffFilesWithFilter",value:function(){var e=u(s().m(function e(t,n,r){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,ri(t,n,r))},e)}));return function(t,n,r){return e.apply(this,arguments)}}()}])}());const ci=e(import.meta.url)("crypto");var ui=["resolve","reject"],li=function(){return h(function e(t){l(this,e),m(this,"server",void 0),m(this,"batchConfig",void 0),m(this,"requestQueue",[]),m(this,"batchTimer",null),m(this,"currentBackoffDelay",1e3),m(this,"retryCount",0),m(this,"isProcessingBatch",!1),m(this,"envConfig",void 0),this.server=t,this.envConfig=Rr(),this.batchConfig={batchSize:this.envConfig.samplingBatchSize,maxBackoffSeconds:this.envConfig.samplingMaxBackoffSeconds,baseDelayMs:this.envConfig.samplingBaseDelayMs,maxRetries:this.envConfig.samplingMaxRetries,jitterPercent:this.envConfig.samplingJitterPercent,maxQueueSize:this.envConfig.samplingMaxQueueSize,requestTimeoutMs:this.envConfig.samplingRequestTimeoutMs,maxCacheSize:this.envConfig.samplingMaxCacheSize,cacheExpiryMs:this.envConfig.samplingCacheExpiryMs},Mr.info("McpSamplingService initialized with batch configuration",{batchSize:this.batchConfig.batchSize,maxBackoffSeconds:this.batchConfig.maxBackoffSeconds,baseDelayMs:this.batchConfig.baseDelayMs,maxRetries:this.batchConfig.maxRetries})},[{key:"sample",value:function(){var e=u(s().m(function e(t){var n=this;return s().w(function(e){for(;;)if(0===e.n)return t.id||(t.id=(0,ci.randomUUID)()),Mr.trace("Adding request to batch queue",{requestId:t.id,promptLength:this.getRequestPromptLength(t),currentQueueSize:this.requestQueue.length,batchSize:this.batchConfig.batchSize}),e.a(2,new Promise(function(e,r){var i=g(g({},t),{},{resolve:e,reject:r});n.requestQueue.push(i),Mr.debug("Request queued for batch processing",{requestId:t.id,queueSize:n.requestQueue.length,batchThreshold:n.batchConfig.batchSize}),n.requestQueue.length>=n.batchConfig.batchSize?(Mr.debug("Batch size threshold reached, processing immediately",{queueSize:n.requestQueue.length,batchSize:n.batchConfig.batchSize}),n.processBatch()):n.batchTimer||(Mr.trace("Starting batch timer for delayed processing",{delayMs:n.batchConfig.baseDelayMs,queueSize:n.requestQueue.length}),n.batchTimer=setTimeout(function(){Mr.debug("Batch timer expired, processing pending requests",{queueSize:n.requestQueue.length}),n.processBatch()},n.batchConfig.baseDelayMs))}))},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"flushBatch",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:if(!(this.requestQueue.length>0)){e.n=2;break}return Mr.info("Flushing pending batch requests",{queueSize:this.requestQueue.length}),e.n=1,this.processBatch();case 1:e.n=3;break;case 2:Mr.debug("No pending requests to flush");case 3:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"processBatch",value:function(){var e=u(s().m(function e(){var t,n,r,i,a,o=this;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isProcessingBatch&&0!==this.requestQueue.length){e.n=1;break}return Mr.trace("Skipping batch processing",{isProcessing:this.isProcessingBatch,queueSize:this.requestQueue.length}),e.a(2);case 1:return this.isProcessingBatch=!0,this.batchTimer&&(clearTimeout(this.batchTimer),this.batchTimer=null),t=this.requestQueue.splice(0,this.batchConfig.batchSize),n=(0,ci.randomUUID)(),Mr.debug("Starting batch processing",{batchId:n,requestCount:t.length,remainingInQueue:this.requestQueue.length}),e.p=2,r={requests:t.map(function(e){e.resolve,e.reject;return T(e,ui)}),batchId:n,timestamp:Date.now()},e.n=3,this.executeBatch(r);case 3:i=e.v,this.resetBackoff(),t.forEach(function(e,t){var r=i.responses[t];if(r)Mr.trace("Resolving individual request from batch",{batchId:n,requestId:e.id,success:r.success}),e.resolve(r);else{var a=new Nr("No response for request ".concat(e.id," in batch ").concat(n),o.getRequestPromptLength(e));Mr.error("Missing response for request in batch",{batchId:n,requestId:e.id,error:a.message}),e.reject(a)}}),Mr.info("Batch processing completed successfully",{batchId:n,requestCount:t.length,duration:i.duration,successCount:i.responses.filter(function(e){return e.success}).length}),e.n=5;break;case 4:return e.p=4,a=e.v,e.n=5,this.handleBatchError(a,t,n);case 5:return e.p=5,this.isProcessingBatch=!1,this.requestQueue.length>0&&(Mr.debug("Processing remaining requests in queue",{remainingCount:this.requestQueue.length}),setImmediate(function(){return o.processBatch()})),e.f(5);case 6:return e.a(2)}},e,this,[[2,4,5,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"executeBatch",value:function(){var e=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f,d,p,h,m,v,g=this;return s().w(function(e){for(;;)switch(e.n){case 0:return n=Date.now(),r=[],i=[],Mr.debug("Executing batch request",{batchId:t.batchId,requestCount:t.requests.length,averagePromptLength:Math.round(this.getBatchRequestPromptLength(t.requests)/t.requests.length)}),a=t.requests.map(function(e){return g.executeSingleRequest(e)}),e.n=1,Promise.allSettled(a);case 1:for(o=e.v,c=0;c<o.length;c++)u=o[c],l=t.requests[c],"fulfilled"===u.status?(d=u.value,r.push(d),Mr.trace("Individual request completed in batch",{batchId:t.batchId,requestId:l.id,success:d.success,responseLength:null===(f=d.content)||void 0===f?void 0:f.text.length})):(p=u.reason,h=p instanceof Error?p.message:String(p),i.push("Request ".concat(l.id,": ").concat(h)),r.push({content:{type:"text",text:h},model:"",stopReason:void 0,success:!1,error:h,id:l.id}),Mr.warn("Individual request failed in batch",{batchId:t.batchId,requestId:l.id,error:h}));return m=Date.now()-n,v=r.filter(function(e){return e.success}).length,Mr.debug("Batch execution completed",{batchId:t.batchId,duration:m,successCount:v,failureCount:r.length-v,totalRequests:r.length}),e.a(2,{responses:r,batchId:t.batchId,success:v>0,processedAt:Date.now(),duration:m,errors:i.length>0?i:void 0})}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"executeSingleRequest",value:function(){var e=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f,d,p,h;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=Date.now(),a=t.message,o=a.messages.reduce(function(e,t){return"text"===t.content.type?e+t.content.text.length:e},null!==(n=null===a||void 0===a||null===(r=a.systemPrompt)||void 0===r?void 0:r.length)&&void 0!==n?n:0),c=t.message.maxTokens||Math.max(o,this.envConfig.samplingDefaultMaxTokens),Mr.trace("Executing single sampling request",{requestId:t.id,promptLength:o,maxTokens:c,hasCustomMaxTokens:!!c}),e.p=1,e.n=2,this.server.createMessage(t.message);case 2:if(u=e.v,l=Date.now()-i,"text"!==u.content.type){e.n=3;break}return Mr.trace("Single request completed successfully",{requestId:t.id,duration:l,promptLength:o,responseLength:u.content.text.length,stopReason:u.stopReason,model:u.model,tokensUsed:c}),e.a(2,{content:u.content,model:u.model,stopReason:u.stopReason,success:!0,id:t.id});case 3:return f="Unexpected response type from sampling request",Mr.warn("Unexpected response type from single request",{requestId:t.id,duration:l,promptLength:o,responseType:u.content.type}),e.a(2,{content:{type:"text",text:f},model:null===u||void 0===u?void 0:u.model,stopReason:null===u||void 0===u?void 0:u.stopReason,success:!1,error:f,id:t.id});case 4:e.n=6;break;case 5:throw e.p=5,h=e.v,d=Date.now()-i,p="Sampling failed: ".concat(h instanceof Error?h.message:String(h)),Mr.error("Single sampling request failed",{requestId:t.id,error:p,stack:h instanceof Error?h.stack:void 0,duration:d,promptLength:o,maxTokens:c}),new Nr(p,o);case 6:return e.a(2)}},e,this,[[1,5]])}));return function(t){return e.apply(this,arguments)}}()},{key:"handleBatchError",value:function(){var e=u(s().m(function e(t,n,r){var i,a,o,c,u=this;return s().w(function(e){for(;;)switch(e.n){case 0:if(this.retryCount++,i=t instanceof Error?t.message:String(t),Mr.error("Batch processing failed",{batchId:r,error:i,retryCount:this.retryCount,maxRetries:this.batchConfig.maxRetries,requestCount:n.length}),!(this.retryCount<this.batchConfig.maxRetries)){e.n=2;break}return o=this.calculateBackoffDelay(),Mr.warn("Retrying batch after backoff delay",{batchId:r,backoffDelayMs:o,retryAttempt:this.retryCount}),e.n=1,this.sleep(o);case 1:(a=this.requestQueue).unshift.apply(a,A(n)),setImmediate(function(){return u.processBatch()}),e.n=3;break;case 2:Mr.error("Max retries exceeded, failing all requests in batch",{batchId:r,requestCount:n.length,maxRetries:this.batchConfig.maxRetries}),c=new Nr("Batch processing failed after ".concat(this.batchConfig.maxRetries," retries: ").concat(i),this.getBatchRequestPromptLength(n)),n.forEach(function(e){e.reject(c)}),this.resetBackoff();case 3:return e.a(2)}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"calculateBackoffDelay",value:function(){var e=Math.min(this.currentBackoffDelay,1e3*this.batchConfig.maxBackoffSeconds),t=e*(this.batchConfig.jitterPercent/100),n=2*(Math.random()-.5)*t,r=e+n;return this.currentBackoffDelay=Math.min(2*this.currentBackoffDelay,1e3*this.batchConfig.maxBackoffSeconds),Mr.trace("Calculated backoff delay",{baseDelay:e,jitterAmount:n,finalDelay:r,nextBackoffDelay:this.currentBackoffDelay,retryCount:this.retryCount}),Math.max(r,100)}},{key:"resetBackoff",value:function(){var e=this.currentBackoffDelay>this.batchConfig.baseDelayMs||this.retryCount>0;this.currentBackoffDelay=this.batchConfig.baseDelayMs,this.retryCount=0,e&&Mr.info("Backoff reset after successful batch processing",{resetToDelayMs:this.batchConfig.baseDelayMs})}},{key:"sleep",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}},{key:"getBatchRequestPromptLength",value:function(e){var t=this;return e.reduce(function(e,n){return e+t.getRequestPromptLength(n)},0)}},{key:"getRequestPromptLength",value:function(e){var t,n;return e.message.messages.reduce(function(e,t){return"text"===t.content.type?e+t.content.text.length:e},null!==(t=null===(n=e.message)||void 0===n||null===(n=n.systemPrompt)||void 0===n?void 0:n.length)&&void 0!==t?t:0)}}])}();const fi=e(import.meta.url)("fs/promises"),di=e(import.meta.url)("fs"),pi=e(import.meta.url)("path");function hi(){}function mi(e,t,n,r,i){for(var a,o=[];t;)o.push(t),a=t.previousComponent,delete t.previousComponent,t=a;o.reverse();for(var s=0,c=o.length,u=0,l=0;s<c;s++){var f=o[s];if(f.removed){if(f.value=e.join(r.slice(l,l+f.count)),l+=f.count,s&&o[s-1].added){var d=o[s-1];o[s-1]=o[s],o[s]=d}}else{if(!f.added&&i){var p=n.slice(u,u+f.count);p=p.map(function(e,t){var n=r[l+t];return n.length>e.length?n:e}),f.value=e.join(p)}else f.value=e.join(n.slice(u,u+f.count));u+=f.count,f.added||(l+=f.count)}}var h=o[c-1];return c>1&&"string"===typeof h.value&&(h.added||h.removed)&&e.equals("",h.value)&&(o[c-2].value+=h.value,o.pop()),o}hi.prototype={diff:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.callback;"function"===typeof r&&(i=r,r={}),this.options=r;var a=this;function o(e){return i?(setTimeout(function(){i(void 0,e)},0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var s=(t=this.removeEmpty(this.tokenize(t))).length,c=e.length,u=1,l=s+c;r.maxEditLength&&(l=Math.min(l,r.maxEditLength));var f=null!==(n=r.timeout)&&void 0!==n?n:1/0,d=Date.now()+f,p=[{oldPos:-1,lastComponent:void 0}],h=this.extractCommon(p[0],t,e,0);if(p[0].oldPos+1>=c&&h+1>=s)return o([{value:this.join(t),count:t.length}]);var m=-1/0,v=1/0;function g(){for(var n=Math.max(m,-u);n<=Math.min(v,u);n+=2){var r=void 0,i=p[n-1],l=p[n+1];i&&(p[n-1]=void 0);var f=!1;if(l){var d=l.oldPos-n;f=l&&0<=d&&d<s}var g=i&&i.oldPos+1<c;if(f||g){if(r=!g||f&&i.oldPos+1<l.oldPos?a.addToPath(l,!0,void 0,0):a.addToPath(i,void 0,!0,1),h=a.extractCommon(r,t,e,n),r.oldPos+1>=c&&h+1>=s)return o(mi(a,r.lastComponent,t,e,a.useLongestToken));p[n]=r,r.oldPos+1>=c&&(v=Math.min(v,n-1)),h+1>=s&&(m=Math.max(m,n+1))}else p[n]=void 0}u++}if(i)!function e(){setTimeout(function(){if(u>l||Date.now()>d)return i();g()||e()},0)}();else for(;u<=l&&Date.now()<=d;){var y=g();if(y)return y}},addToPath:function(e,t,n,r){var i=e.lastComponent;return i&&i.added===t&&i.removed===n?{oldPos:e.oldPos+r,lastComponent:{count:i.count+1,added:t,removed:n,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+r,lastComponent:{count:1,added:t,removed:n,previousComponent:i}}},extractCommon:function(e,t,n,r){for(var i=t.length,a=n.length,o=e.oldPos,s=o-r,c=0;s+1<i&&o+1<a&&this.equals(t[s+1],n[o+1]);)s++,o++,c++;return c&&(e.lastComponent={count:c,previousComponent:e.lastComponent}),e.oldPos=o,s},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};new hi;var vi=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,gi=/\S/,yi=new hi;yi.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!gi.test(e)&&!gi.test(t)},yi.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&vi.test(t[n])&&vi.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var wi=new hi;wi.tokenize=function(e){this.options.stripTrailingCr&&(e=e.replace(/\r\n/g,"\n"));var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var i=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),t.push(i))}return t};var bi=new hi;bi.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var ki=new hi;function xi(e){return xi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xi(e)}function _i(e){return function(e){if(Array.isArray(e))return Si(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Si(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Si(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Si(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ki.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var Ci=Object.prototype.toString,Ei=new hi;function Ti(e,t,n,r,i){var a,o;for(t=t||[],n=n||[],r&&(e=r(i,e)),a=0;a<t.length;a+=1)if(t[a]===e)return n[a];if("[object Array]"===Ci.call(e)){for(t.push(e),o=new Array(e.length),n.push(o),a=0;a<e.length;a+=1)o[a]=Ti(e[a],t,n,r,i);return t.pop(),n.pop(),o}if(e&&e.toJSON&&(e=e.toJSON()),"object"===xi(e)&&null!==e){t.push(e),o={},n.push(o);var s,c=[];for(s in e)e.hasOwnProperty(s)&&c.push(s);for(c.sort(),a=0;a<c.length;a+=1)o[s=c[a]]=Ti(e[s],t,n,r,s);t.pop(),n.pop()}else o=e;return o}Ei.useLongestToken=!0,Ei.tokenize=wi.tokenize,Ei.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,i=void 0===r?function(e,t){return"undefined"===typeof t?n:t}:r;return"string"===typeof e?e:JSON.stringify(Ti(e,null,null,i),i,"  ")},Ei.equals=function(e,t){return hi.prototype.equals.call(Ei,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var Pi=new hi;function Oi(e,t,n,r,i,a,o){o||(o={}),"undefined"===typeof o.context&&(o.context=4);var s=function(e,t,n){return wi.diff(e,t,n)}(n,r,o);if(s){s.push({value:"",lines:[]});for(var c=[],u=0,l=0,f=[],d=1,p=1,h=function(e){var t=s[e],i=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=i,t.added||t.removed){var a;if(!u){var h=s[e-1];u=d,l=p,h&&(f=o.context>0?v(h.lines.slice(-o.context)):[],u-=f.length,l-=f.length)}(a=f).push.apply(a,_i(i.map(function(e){return(t.added?"+":"-")+e}))),t.added?p+=i.length:d+=i.length}else{if(u)if(i.length<=2*o.context&&e<s.length-2){var m;(m=f).push.apply(m,_i(v(i)))}else{var g,y=Math.min(i.length,o.context);(g=f).push.apply(g,_i(v(i.slice(0,y))));var w={oldStart:u,oldLines:d-u+y,newStart:l,newLines:p-l+y,lines:f};if(e>=s.length-2&&i.length<=o.context){var b=/\n$/.test(n),k=/\n$/.test(r),x=0==i.length&&f.length>w.oldLines;!b&&x&&n.length>0&&f.splice(w.oldLines,0,"\\ No newline at end of file"),(b||x)&&k||f.push("\\ No newline at end of file")}c.push(w),u=0,l=0,f=[]}d+=i.length,p+=i.length}},m=0;m<s.length;m++)h(m);return{oldFileName:e,newFileName:t,oldHeader:i,newHeader:a,hunks:c}}function v(e){return e.map(function(e){return" "+e})}}function Ai(e){if(Array.isArray(e))return e.map(Ai).join("\n");var t=[];e.oldFileName==e.newFileName&&t.push("Index: "+e.oldFileName),t.push("==================================================================="),t.push("--- "+e.oldFileName+("undefined"===typeof e.oldHeader?"":"\t"+e.oldHeader)),t.push("+++ "+e.newFileName+("undefined"===typeof e.newHeader?"":"\t"+e.newHeader));for(var n=0;n<e.hunks.length;n++){var r=e.hunks[n];0===r.oldLines&&(r.oldStart-=1),0===r.newLines&&(r.newStart-=1),t.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@"),t.push.apply(t,r.lines)}return t.join("\n")+"\n"}function Fi(e,t,n,r,i,a,o){return Ai(Oi(e,t,n,r,i,a,o))}Pi.tokenize=function(e){return e.slice()},Pi.join=Pi.removeEmpty=function(e){return e};var Ii=function(e,t,n){var r=e instanceof RegExp?ji(e,n):e,i=t instanceof RegExp?ji(t,n):t,a=null!==r&&null!=i&&Ri(r,i,n);return a&&{start:a[0],end:a[1],pre:n.slice(0,a[0]),body:n.slice(a[0]+r.length,a[1]),post:n.slice(a[1]+i.length)}},ji=function(e,t){var n=t.match(e);return n?n[0]:null},Ri=function(e,t,n){var r,i,a,o,s=void 0,c=n.indexOf(e),u=n.indexOf(t,c+1),l=c;if(c>=0&&u>0){if(e===t)return[c,u];for(r=[],a=n.length;l>=0&&!o;){if(l===c)r.push(l),c=n.indexOf(e,l+1);else if(1===r.length){var f=r.pop();void 0!==f&&(o=[f,u])}else void 0!==(i=r.pop())&&i<a&&(a=i,s=u),u=n.indexOf(t,l+1);l=c<u&&c>=0?c:u}r.length&&void 0!==s&&(o=[a,s])}return o},Mi="\0SLASH"+Math.random()+"\0",Di="\0OPEN"+Math.random()+"\0",Ui="\0CLOSE"+Math.random()+"\0",Ni="\0COMMA"+Math.random()+"\0",Li="\0PERIOD"+Math.random()+"\0",zi=new RegExp(Mi,"g"),qi=new RegExp(Di,"g"),Zi=new RegExp(Ui,"g"),Bi=new RegExp(Ni,"g"),Wi=new RegExp(Li,"g"),Gi=/\\\\/g,Hi=/\\{/g,$i=/\\}/g,Vi=/\\,/g,Ki=/\\./g;function Qi(e){return isNaN(e)?e.charCodeAt(0):parseInt(e,10)}function Ji(e){return e.replace(zi,"\\").replace(qi,"{").replace(Zi,"}").replace(Bi,",").replace(Wi,".")}function Yi(e){if(!e)return[""];var t=[],n=Ii("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,a=n.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var s=Yi(a);return a.length&&(o[o.length-1]+=s.shift(),o.push.apply(o,s)),t.push.apply(t,o),t}function Xi(e){return e?("{}"===e.slice(0,2)&&(e="\\{\\}"+e.slice(2)),ia(function(e){return e.replace(Gi,Mi).replace(Hi,Di).replace($i,Ui).replace(Vi,Ni).replace(Ki,Li)}(e),!0).map(Ji)):[]}function ea(e){return"{"+e+"}"}function ta(e){return/^-?0\d/.test(e)}function na(e,t){return e<=t}function ra(e,t){return e>=t}function ia(e,t){var n=[],r=Ii("{","}",e);if(!r)return[e];var i=r.pre,a=r.post.length?ia(r.post,!1):[""];if(/\$$/.test(r.pre))for(var o=0;o<a.length;o++){var s=i+"{"+r.body+"}"+a[o];n.push(s)}else{var c,u,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),f=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),d=l||f,p=r.body.indexOf(",")>=0;if(!d&&!p)return r.post.match(/,(?!,).*\}/)?ia(e=r.pre+"{"+r.body+Ui+r.post):[e];if(d)c=r.body.split(/\.\./);else if(1===(c=Yi(r.body)).length&&void 0!==c[0]&&1===(c=ia(c[0],!1).map(ea)).length)return a.map(function(e){return r.pre+c[0]+e});if(d&&void 0!==c[0]&&void 0!==c[1]){var h=Qi(c[0]),m=Qi(c[1]),v=Math.max(c[0].length,c[1].length),g=3===c.length&&void 0!==c[2]?Math.abs(Qi(c[2])):1,y=na;m<h&&(g*=-1,y=ra);var w=c.some(ta);u=[];for(var b=h;y(b,m);b+=g){var k=void 0;if(f)"\\"===(k=String.fromCharCode(b))&&(k="");else if(k=String(b),w){var x=v-k.length;if(x>0){var _=new Array(x+1).join("0");k=b<0?"-"+_+k.slice(1):_+k}}u.push(k)}}else{u=[];for(var S=0;S<c.length;S++)u.push.apply(u,ia(c[S],!1))}for(var C=0;C<u.length;C++)for(var E=0;E<a.length;E++){var T=i+u[C]+a[E];(!t||d||T)&&n.push(T)}}return n}var aa=function(e){if("string"!==typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};function oa(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sa(e,t,n){oa(e,t),t.set(e,n)}function ca(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function ua(e,t){return e.get(ca(e,t))}function la(e,t,n){return e.set(ca(e,t),n),n}var fa,da={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},pa=function(e){return e.replace(/[[\]\\-]/g,"\\$&")},ha=function(e){return e.join("")},ma=function(e,t){var n=t;if("["!==e.charAt(n))throw new Error("not in a brace expression");var r,i=[],a=[],o=n+1,s=!1,c=!1,u=!1,l=!1,f=n,d="";e:for(;o<e.length;){var p=e.charAt(o);if("!"!==p&&"^"!==p||o!==n+1){if("]"===p&&s&&!u){f=o+1;break}if(s=!0,"\\"!==p||u){if("["===p&&!u)for(var h=0,m=Object.entries(da);h<m.length;h++){var v=E(m[h],2),g=v[0],y=E(v[1],3),w=y[0],b=y[1],k=y[2];if(e.startsWith(g,o)){if(d)return["$.",!1,e.length-n,!0];o+=g.length,k?a.push(w):i.push(w),c=c||b;continue e}}u=!1,d?(p>d?i.push(pa(d)+"-"+pa(p)):p===d&&i.push(pa(p)),d="",o++):e.startsWith("-]",o+1)?(i.push(pa(p+"-")),o+=2):e.startsWith("-",o+1)?(d=p,o+=2):(i.push(pa(p)),o++)}else u=!0,o++}else l=!0,o++}if(f<o)return["",!1,0,!1];if(!i.length&&!a.length)return["$.",!1,e.length-n,!0];if(0===a.length&&1===i.length&&/^\\?.$/.test(i[0])&&!l){var x=2===i[0].length?i[0].slice(-1):i[0];return[(r=x,r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,f-n,!1]}var _="["+(l?"^":"")+ha(i)+"]",S="["+(l?"":"^")+ha(a)+"]";return[i.length&&a.length?"("+_+"|"+S+")":i.length?_:S,c,f-n,!0]},va=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).windowsPathsNoEscape;return void 0!==t&&t?e.replace(/\[([^\/\\])\]/g,"$1"):e.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")},ga=new Set(["!","?","+","*","@"]),ya=function(e){return ga.has(e)},wa="(?!\\.)",ba=new Set(["[","."]),ka=new Set(["..","."]),xa=new Set("().*{}+?[]^$\\!"),_a=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},Sa="[^/]",Ca=Sa+"*?",Ea=Sa+"+?",Ta=new WeakMap,Pa=new WeakMap,Oa=new WeakMap,Aa=new WeakMap,Fa=new WeakMap,Ia=new WeakMap,ja=new WeakMap,Ra=new WeakMap,Ma=new WeakMap,Da=new WeakMap,Ua=new WeakMap,Na=new WeakSet,La=function(){function e(t,n){var r,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l(this,e),oa(r=this,i=Na),i.add(r),m(this,"type",void 0),sa(this,Ta,void 0),sa(this,Pa,void 0),sa(this,Oa,!1),sa(this,Aa,[]),sa(this,Fa,void 0),sa(this,Ia,void 0),sa(this,ja,void 0),sa(this,Ra,!1),sa(this,Ma,void 0),sa(this,Da,void 0),sa(this,Ua,!1),this.type=t,t&&la(Pa,this,!0),la(Fa,this,n),la(Ta,this,ua(Fa,this)?ua(Ta,ua(Fa,this)):this),la(Ma,this,ua(Ta,this)===this?a:ua(Ma,ua(Ta,this))),la(ja,this,ua(Ta,this)===this?[]:ua(ja,ua(Ta,this))),"!"!==t||ua(Ra,ua(Ta,this))||ua(ja,this).push(this),la(Ia,this,ua(Fa,this)?ua(Aa,ua(Fa,this)).length:0)}return h(e,[{key:"hasMagic",get:function(){if(void 0!==ua(Pa,this))return ua(Pa,this);var e,t=P(ua(Aa,this));try{for(t.s();!(e=t.n()).done;){var n=e.value;if("string"!==typeof n&&(n.type||n.hasMagic))return la(Pa,this,!0)}}catch(r){t.e(r)}finally{t.f()}return ua(Pa,this)}},{key:"toString",value:function(){return void 0!==ua(Da,this)?ua(Da,this):this.type?la(Da,this,this.type+"("+ua(Aa,this).map(function(e){return String(e)}).join("|")+")"):la(Da,this,ua(Aa,this).map(function(e){return String(e)}).join(""))}},{key:"push",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];if(""!==o){if("string"!==typeof o&&!(o instanceof e&&ua(Fa,o)===this))throw new Error("invalid part: "+o);ua(Aa,this).push(o)}}}},{key:"toJSON",value:function(){var e,t=null===this.type?ua(Aa,this).slice().map(function(e){return"string"===typeof e?e:e.toJSON()}):[this.type].concat(A(ua(Aa,this).map(function(e){return e.toJSON()})));return this.isStart()&&!this.type&&t.unshift([]),this.isEnd()&&(this===ua(Ta,this)||ua(Ra,ua(Ta,this))&&"!"===(null===(e=ua(Fa,this))||void 0===e?void 0:e.type))&&t.push({}),t}},{key:"isStart",value:function(){var t;if(ua(Ta,this)===this)return!0;if(null===(t=ua(Fa,this))||void 0===t||!t.isStart())return!1;if(0===ua(Ia,this))return!0;for(var n=ua(Fa,this),r=0;r<ua(Ia,this);r++){var i=ua(Aa,n)[r];if(!(i instanceof e&&"!"===i.type))return!1}return!0}},{key:"isEnd",value:function(){var e,t,n;if(ua(Ta,this)===this)return!0;if("!"===(null===(e=ua(Fa,this))||void 0===e?void 0:e.type))return!0;if(null===(t=ua(Fa,this))||void 0===t||!t.isEnd())return!1;if(!this.type)return null===(n=ua(Fa,this))||void 0===n?void 0:n.isEnd();var r=ua(Fa,this)?ua(Aa,ua(Fa,this)).length:0;return ua(Ia,this)===r-1}},{key:"copyIn",value:function(e){"string"===typeof e?this.push(e):this.push(e.clone(this))}},{key:"clone",value:function(t){var n,r=new e(this.type,t),i=P(ua(Aa,this));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.copyIn(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"toMMPattern",value:function(){if(this!==ua(Ta,this))return ua(Ta,this).toMMPattern();var e=this.toString(),t=E(this.toRegExpSource(),4),n=t[0],r=t[1],i=t[2],a=t[3];if(!(i||ua(Pa,this)||ua(Ma,this).nocase&&!ua(Ma,this).nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return r;var o=(ua(Ma,this).nocase?"i":"")+(a?"u":"");return Object.assign(new RegExp("^".concat(n,"$"),o),{_src:n,_glob:e})}},{key:"options",get:function(){return ua(Ma,this)}},{key:"toRegExpSource",value:function(t){var n=this,r=null!==t&&void 0!==t?t:!!ua(Ma,this).dot;if(ua(Ta,this)===this&&ca(Na,this,za).call(this),!this.type){var i,a=this.isStart()&&this.isEnd(),o=ua(Aa,this).map(function(r){var i=E("string"===typeof r?Ba.call(e,r,ua(Pa,n),a):r.toRegExpSource(t),4),o=i[0],s=(i[1],i[2]),c=i[3];return la(Pa,n,ua(Pa,n)||s),la(Oa,n,ua(Oa,n)||c),o}).join(""),s="";if(this.isStart())if("string"===typeof ua(Aa,this)[0])if(!(1===ua(Aa,this).length&&ka.has(ua(Aa,this)[0]))){var c=ba,u=r&&c.has(o.charAt(0))||o.startsWith("\\.")&&c.has(o.charAt(2))||o.startsWith("\\.\\.")&&c.has(o.charAt(4)),l=!r&&!t&&c.has(o.charAt(0));s=u?"(?!(?:^|/)\\.\\.?(?:$|/))":l?wa:""}var f="";return this.isEnd()&&ua(Ra,ua(Ta,this))&&"!"===(null===(i=ua(Fa,this))||void 0===i?void 0:i.type)&&(f="(?:$|\\/)"),[s+o+f,va(o),la(Pa,this,!!ua(Pa,this)),ua(Oa,this)]}var d="*"===this.type||"+"===this.type,p="!"===this.type?"(?:(?!(?:":"(?:",h=ca(Na,this,Za).call(this,r);if(this.isStart()&&this.isEnd()&&!h&&"!"!==this.type){var m=this.toString();return la(Aa,this,[m]),this.type=null,la(Pa,this,void 0),[m,va(this.toString()),!1,!1]}var v=!d||t||r?"":ca(Na,this,Za).call(this,!0);v===h&&(v=""),v&&(h="(?:".concat(h,")(?:").concat(v,")*?"));var g="";"!"===this.type&&ua(Ua,this)?g=(this.isStart()&&!r?wa:"")+Ea:g=p+h+("!"===this.type?"))"+(!this.isStart()||r||t?"":wa)+Ca+")":"@"===this.type?")":"?"===this.type?")?":"+"===this.type&&v?")":"*"===this.type&&v?")?":")".concat(this.type));return[g,va(h),la(Pa,this,!!ua(Pa,this)),ua(Oa,this)]}}],[{key:"fromGlob",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new e(null,void 0,n);return qa.call(e,t,r,0,n),r}}])}();function za(){if(this!==ua(Ta,this))throw new Error("should only call on root");if(ua(Ra,this))return this;var e;for(this.toString(),la(Ra,this,!0);e=ua(ja,this).pop();)if("!"===e.type)for(var t=e,n=ua(Fa,t);n;){for(var r=ua(Ia,t)+1;!n.type&&r<ua(Aa,n).length;r++){var i,a=P(ua(Aa,e));try{for(a.s();!(i=a.n()).done;){var o=i.value;if("string"===typeof o)throw new Error("string part in extglob AST??");o.copyIn(ua(Aa,n)[r])}}catch(s){a.e(s)}finally{a.f()}}n=ua(Fa,t=n)}return this}function qa(e,t,n,r){var i=!1,a=!1,o=-1,s=!1;if(null===t.type){for(var c=n,u="";c<e.length;){var l=e.charAt(c++);if(i||"\\"===l)i=!i,u+=l;else if(a)c===o+1?"^"!==l&&"!"!==l||(s=!0):"]"!==l||c===o+2&&s||(a=!1),u+=l;else if("["!==l)if(r.noext||!ya(l)||"("!==e.charAt(c))u+=l;else{t.push(u),u="";var f=new fa(l,t);c=qa.call(fa,e,f,c,r),t.push(f)}else a=!0,o=c,s=!1,u+=l}return t.push(u),c}for(var d=n+1,p=new fa(null,t),h=[],m="";d<e.length;){var v=e.charAt(d++);if(i||"\\"===v)i=!i,m+=v;else if(a)d===o+1?"^"!==v&&"!"!==v||(s=!0):"]"!==v||d===o+2&&s||(a=!1),m+=v;else if("["!==v)if(ya(v)&&"("===e.charAt(d)){p.push(m),m="";var g=new fa(v,p);p.push(g),d=qa.call(fa,e,g,d,r)}else if("|"!==v){if(")"===v)return""===m&&0===ua(Aa,t).length&&la(Ua,t,!0),p.push(m),m="",t.push.apply(t,h.concat([p])),d;m+=v}else p.push(m),m="",h.push(p),p=new fa(null,t);else a=!0,o=d,s=!1,m+=v}return t.type=null,la(Pa,t,void 0),la(Aa,t,[e.substring(n-1)]),d}function Za(e){var t=this;return ua(Aa,this).map(function(n){if("string"===typeof n)throw new Error("string type in extglob ast??");var r=E(n.toRegExpSource(e),4),i=r[0],a=(r[1],r[2],r[3]);return la(Oa,t,ua(Oa,t)||a),i}).filter(function(e){return!(t.isStart()&&t.isEnd())||!!e}).join("|")}function Ba(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,i="",a=!1,o=0;o<e.length;o++){var s=e.charAt(o);if(r)r=!1,i+=(xa.has(s)?"\\":"")+s;else if("\\"!==s){if("["===s){var c=E(ma(e,o),4),u=c[0],l=c[1],f=c[2],d=c[3];if(f){i+=u,a=a||l,o+=f-1,t=t||d;continue}}"*"!==s?"?"!==s?i+=_a(s):(i+=Sa,t=!0):(i+=n&&"*"===e?Ea:Ca,t=!0)}else o===e.length-1?i+="\\\\":r=!0}return[i,va(e),!!t,a]}fa=La;var Wa=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return aa(t),!(!n.nocomment&&"#"===t.charAt(0))&&new go(t,n).match(e)},Ga=/^\*+([^+@!?\*\[\(]*)$/,Ha=function(e){return function(t){return!t.startsWith(".")&&t.endsWith(e)}},$a=function(e){return function(t){return t.endsWith(e)}},Va=function(e){return e=e.toLowerCase(),function(t){return!t.startsWith(".")&&t.toLowerCase().endsWith(e)}},Ka=function(e){return e=e.toLowerCase(),function(t){return t.toLowerCase().endsWith(e)}},Qa=/^\*+\.\*+$/,Ja=function(e){return!e.startsWith(".")&&e.includes(".")},Ya=function(e){return"."!==e&&".."!==e&&e.includes(".")},Xa=/^\.\*+$/,eo=function(e){return"."!==e&&".."!==e&&e.startsWith(".")},to=/^\*+$/,no=function(e){return 0!==e.length&&!e.startsWith(".")},ro=function(e){return 0!==e.length&&"."!==e&&".."!==e},io=/^\?+([^+@!?\*\[\(]*)?$/,ao=function(e){var t=E(e,2),n=t[0],r=t[1],i=void 0===r?"":r,a=uo([n]);return i?(i=i.toLowerCase(),function(e){return a(e)&&e.toLowerCase().endsWith(i)}):a},oo=function(e){var t=E(e,2),n=t[0],r=t[1],i=void 0===r?"":r,a=lo([n]);return i?(i=i.toLowerCase(),function(e){return a(e)&&e.toLowerCase().endsWith(i)}):a},so=function(e){var t=E(e,2),n=t[0],r=t[1],i=void 0===r?"":r,a=lo([n]);return i?function(e){return a(e)&&e.endsWith(i)}:a},co=function(e){var t=E(e,2),n=t[0],r=t[1],i=void 0===r?"":r,a=uo([n]);return i?function(e){return a(e)&&e.endsWith(i)}:a},uo=function(e){var t=E(e,1)[0].length;return function(e){return e.length===t&&!e.startsWith(".")}},lo=function(e){var t=E(e,1)[0].length;return function(e){return e.length===t&&"."!==e&&".."!==e}},fo="object"===typeof process&&process?"object"===typeof process.env&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";Wa.sep="win32"===fo?{sep:"\\"}.sep:{sep:"/"}.sep;var po=Symbol("globstar **");Wa.GLOBSTAR=po;Wa.filter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return Wa(n,e,t)}};var ho=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign({},e,t)};Wa.defaults=function(e){if(!e||"object"!==typeof e||!Object.keys(e).length)return Wa;var t=Wa;return Object.assign(function(n,r){return t(n,r,ho(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}))},{Minimatch:function(n){function r(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(this,r),k(this,r,[t,ho(e,n)])}return _(r,n),h(r,null,[{key:"defaults",value:function(n){return t.defaults(ho(e,n)).Minimatch}}])}(t.Minimatch),AST:function(n){function r(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(this,r),k(this,r,[t,n,ho(e,i)])}return _(r,n),h(r,null,[{key:"fromGlob",value:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.AST.fromGlob(n,ho(e,r))}}])}(t.AST),unescape:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.unescape(n,ho(e,r))},escape:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.escape(n,ho(e,r))},filter:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.filter(n,ho(e,r))},defaults:function(n){return t.defaults(ho(e,n))},makeRe:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.makeRe(n,ho(e,r))},braceExpand:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.braceExpand(n,ho(e,r))},match:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.match(n,r,ho(e,i))},sep:t.sep,GLOBSTAR:po})};var mo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return aa(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:Xi(e)};Wa.braceExpand=mo;Wa.makeRe=function(e){return new go(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).makeRe()};Wa.match=function(e,t){var n=new go(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return e=e.filter(function(e){return n.match(e)}),n.options.nonull&&!e.length&&e.push(t),e};var vo=/[?*]|[+@!]\(.*?\)|\[|\]/,go=function(){return h(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l(this,e),m(this,"options",void 0),m(this,"set",void 0),m(this,"pattern",void 0),m(this,"windowsPathsNoEscape",void 0),m(this,"nonegate",void 0),m(this,"negate",void 0),m(this,"comment",void 0),m(this,"empty",void 0),m(this,"preserveMultipleSlashes",void 0),m(this,"partial",void 0),m(this,"globSet",void 0),m(this,"globParts",void 0),m(this,"nocase",void 0),m(this,"isWindows",void 0),m(this,"platform",void 0),m(this,"windowsNoMagicRoot",void 0),m(this,"regexp",void 0),aa(t),n=n||{},this.options=n,this.pattern=t,this.platform=n.platform||fo,this.isWindows="win32"===this.platform,this.windowsPathsNoEscape=!!n.windowsPathsNoEscape||!1===n.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!n.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!n.nonegate,this.comment=!1,this.empty=!1,this.partial=!!n.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=void 0!==n.windowsNoMagicRoot?n.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()},[{key:"hasMagic",value:function(){if(this.options.magicalBraces&&this.set.length>1)return!0;var e,t=P(this.set);try{for(t.s();!(e=t.n()).done;){var n,r=P(e.value);try{for(r.s();!(n=r.n()).done;){if("string"!==typeof n.value)return!0}}catch(i){r.e(i)}finally{r.f()}}}catch(i){t.e(i)}finally{t.f()}return!1}},{key:"debug",value:function(){}},{key:"make",value:function(){var e=this,t=this.pattern,n=this.options;if(n.nocomment||"#"!==t.charAt(0))if(t){this.parseNegate(),this.globSet=A(new Set(this.braceExpand())),n.debug&&(this.debug=function(){var e;return(e=console).error.apply(e,arguments)}),this.debug(this.pattern,this.globSet);var r=this.globSet.map(function(t){return e.slashSplit(t)});this.globParts=this.preprocess(r),this.debug(this.pattern,this.globParts);var i=this.globParts.map(function(t,n,r){if(e.isWindows&&e.windowsNoMagicRoot){var i=""===t[0]&&""===t[1]&&("?"===t[2]||!vo.test(t[2]))&&!vo.test(t[3]),a=/^[a-z]:/i.test(t[0]);if(i)return[].concat(A(t.slice(0,4)),A(t.slice(4).map(function(t){return e.parse(t)})));if(a)return[t[0]].concat(A(t.slice(1).map(function(t){return e.parse(t)})))}return t.map(function(t){return e.parse(t)})});if(this.debug(this.pattern,i),this.set=i.filter(function(e){return-1===e.indexOf(!1)}),this.isWindows)for(var a=0;a<this.set.length;a++){var o=this.set[a];""===o[0]&&""===o[1]&&"?"===this.globParts[a][2]&&"string"===typeof o[3]&&/^[a-z]:$/i.test(o[3])&&(o[2]="?")}this.debug(this.pattern,this.set)}else this.empty=!0;else this.comment=!0}},{key:"preprocess",value:function(e){if(this.options.noglobstar)for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)"**"===e[t][n]&&(e[t][n]="*");var r=this.options.optimizationLevel,i=void 0===r?1:r;return i>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):e=i>=1?this.levelOneOptimize(e):this.adjascentGlobstarOptimize(e),e}},{key:"adjascentGlobstarOptimize",value:function(e){return e.map(function(e){for(var t=-1;-1!==(t=e.indexOf("**",t+1));){for(var n=t;"**"===e[n+1];)n++;n!==t&&e.splice(t,n-t)}return e})}},{key:"levelOneOptimize",value:function(e){return e.map(function(e){return 0===(e=e.reduce(function(e,t){var n=e[e.length-1];return"**"===t&&"**"===n?e:".."===t&&n&&".."!==n&&"."!==n&&"**"!==n?(e.pop(),e):(e.push(t),e)},[])).length?[""]:e})}},{key:"levelTwoFileOptimize",value:function(e){Array.isArray(e)||(e=this.slashSplit(e));var t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(var n=1;n<e.length-1;n++){var r=e[n];1===n&&""===r&&""===e[0]||("."!==r&&""!==r||(t=!0,e.splice(n,1),n--))}"."!==e[0]||2!==e.length||"."!==e[1]&&""!==e[1]||(t=!0,e.pop())}for(var i=0;-1!==(i=e.indexOf("..",i+1));){var a=e[i-1];a&&"."!==a&&".."!==a&&"**"!==a&&(t=!0,e.splice(i-1,2),i-=2)}}while(t);return 0===e.length?[""]:e}},{key:"firstPhasePreProcess",value:function(e){var t=!1;do{t=!1;var n,r=P(e);try{for(r.s();!(n=r.n()).done;){for(var i=n.value,a=-1;-1!==(a=i.indexOf("**",a+1));){for(var o=a;"**"===i[o+1];)o++;o>a&&i.splice(a+1,o-a);var s=i[a+1],c=i[a+2],u=i[a+3];if(".."===s&&(c&&"."!==c&&".."!==c&&u&&"."!==u&&".."!==u)){t=!0,i.splice(a,1);var l=i.slice(0);l[a]="**",e.push(l),a--}}if(!this.preserveMultipleSlashes){for(var f=1;f<i.length-1;f++){var d=i[f];1===f&&""===d&&""===i[0]||("."!==d&&""!==d||(t=!0,i.splice(f,1),f--))}"."!==i[0]||2!==i.length||"."!==i[1]&&""!==i[1]||(t=!0,i.pop())}for(var p=0;-1!==(p=i.indexOf("..",p+1));){var h=i[p-1];if(h&&"."!==h&&".."!==h&&"**"!==h){t=!0;var m=1===p&&"**"===i[p+1]?["."]:[];i.splice.apply(i,[p-1,2].concat(m)),0===i.length&&i.push(""),p-=2}}}}catch(v){r.e(v)}finally{r.f()}}while(t);return e}},{key:"secondPhasePreProcess",value:function(e){for(var t=0;t<e.length-1;t++)for(var n=t+1;n<e.length;n++){var r=this.partsMatch(e[t],e[n],!this.preserveMultipleSlashes);if(r){e[t]=[],e[n]=r;break}}return e.filter(function(e){return e.length})}},{key:"partsMatch",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0,i=0,a=[],o="";r<e.length&&i<t.length;)if(e[r]===t[i])a.push("b"===o?t[i]:e[r]),r++,i++;else if(n&&"**"===e[r]&&t[i]===e[r+1])a.push(e[r]),r++;else if(n&&"**"===t[i]&&e[r]===t[i+1])a.push(t[i]),i++;else if("*"!==e[r]||!t[i]||!this.options.dot&&t[i].startsWith(".")||"**"===t[i]){if("*"!==t[i]||!e[r]||!this.options.dot&&e[r].startsWith(".")||"**"===e[r])return!1;if("a"===o)return!1;o="b",a.push(t[i]),r++,i++}else{if("b"===o)return!1;o="a",a.push(e[r]),r++,i++}return e.length===t.length&&a}},{key:"parseNegate",value:function(){if(!this.nonegate){for(var e=this.pattern,t=!1,n=0,r=0;r<e.length&&"!"===e.charAt(r);r++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}}},{key:"matchOne",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options;if(this.isWindows){var i="string"===typeof e[0]&&/^[a-z]:$/i.test(e[0]),a=!i&&""===e[0]&&""===e[1]&&"?"===e[2]&&/^[a-z]:$/i.test(e[3]),o="string"===typeof t[0]&&/^[a-z]:$/i.test(t[0]),s=a?3:i?0:void 0,c=!o&&""===t[0]&&""===t[1]&&"?"===t[2]&&"string"===typeof t[3]&&/^[a-z]:$/i.test(t[3])?3:o?0:void 0;if("number"===typeof s&&"number"===typeof c){var u=[e[s],t[c]],l=u[0],f=u[1];l.toLowerCase()===f.toLowerCase()&&(t[c]=l,c>s?t=t.slice(c):s>c&&(e=e.slice(s)))}}var d=this.options.optimizationLevel;(void 0===d?1:d)>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var p=0,h=0,m=e.length,v=t.length;p<m&&h<v;p++,h++){this.debug("matchOne loop");var g=t[h],y=e[p];if(this.debug(t,g,y),!1===g)return!1;if(g===po){this.debug("GLOBSTAR",[t,g,y]);var w=p,b=h+1;if(b===v){for(this.debug("** at the end");p<m;p++)if("."===e[p]||".."===e[p]||!r.dot&&"."===e[p].charAt(0))return!1;return!0}for(;w<m;){var k=e[w];if(this.debug("\nglobstar while",e,w,t,b,k),this.matchOne(e.slice(w),t.slice(b),n))return this.debug("globstar found match!",w,m,k),!0;if("."===k||".."===k||!r.dot&&"."===k.charAt(0)){this.debug("dot detected!",e,w,t,b);break}this.debug("globstar swallow a segment, and continue"),w++}return!(!n||(this.debug("\n>>> no match, partial?",e,w,t,b),w!==m))}var x=void 0;if("string"===typeof g?(x=y===g,this.debug("string match",g,y,x)):(x=g.test(y),this.debug("pattern match",g,y,x)),!x)return!1}if(p===m&&h===v)return!0;if(p===m)return n;if(h===v)return p===m-1&&""===e[p];throw new Error("wtf?")}},{key:"braceExpand",value:function(){return mo(this.pattern,this.options)}},{key:"parse",value:function(e){aa(e);var t,n=this.options;if("**"===e)return po;if(""===e)return"";var r=null;(t=e.match(to))?r=n.dot?ro:no:(t=e.match(Ga))?r=(n.nocase?n.dot?Ka:Va:n.dot?$a:Ha)(t[1]):(t=e.match(io))?r=(n.nocase?n.dot?oo:ao:n.dot?so:co)(t):(t=e.match(Qa))?r=n.dot?Ya:Ja:(t=e.match(Xa))&&(r=eo);var i=La.fromGlob(e,this.options).toMMPattern();return r&&"object"===typeof i&&Reflect.defineProperty(i,"test",{value:r}),i}},{key:"makeRe",value:function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",r=new Set(t.nocase?["i"]:[]),i=e.map(function(e){var t=e.map(function(e){if(e instanceof RegExp){var t,n=P(e.flags.split(""));try{for(n.s();!(t=n.n()).done;){var i=t.value;r.add(i)}}catch(a){n.e(a)}finally{n.f()}}return"string"===typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===po?po:e._src});return t.forEach(function(e,r){var i=t[r+1],a=t[r-1];e===po&&a!==po&&(void 0===a?void 0!==i&&i!==po?t[r+1]="(?:\\/|"+n+"\\/)?"+i:t[r]=n:void 0===i?t[r-1]=a+"(?:\\/|"+n+")?":i!==po&&(t[r-1]=a+"(?:\\/|\\/"+n+"\\/)"+i,t[r+1]=po))}),t.filter(function(e){return e!==po}).join("/")}).join("|"),a=E(e.length>1?["(?:",")"]:["",""],2);i="^"+a[0]+i+a[1]+"$",this.negate&&(i="^(?!"+i+").+$");try{this.regexp=new RegExp(i,A(r).join(""))}catch(o){this.regexp=!1}return this.regexp}},{key:"slashSplit",value:function(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?[""].concat(A(e.split(/\/+/))):e.split(/\/+/)}},{key:"match",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.partial;if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;this.isWindows&&(e=e.split("\\").join("/"));var r=this.slashSplit(e);this.debug(this.pattern,"split",r);var i=this.set;this.debug(this.pattern,"set",i);var a=r[r.length-1];if(!a)for(var o=r.length-2;!a&&o>=0;o--)a=r[o];for(var s=0;s<i.length;s++){var c=i[s],u=r;if(n.matchBase&&1===c.length&&(u=[a]),this.matchOne(u,c,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate}}],[{key:"defaults",value:function(e){return Wa.defaults(e).Minimatch}}])}();Wa.AST=La,Wa.Minimatch=go,Wa.escape=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).windowsPathsNoEscape;return void 0!==t&&t?e.replace(/[?*()[\]]/g,"[$&]"):e.replace(/[?*()[\]\\]/g,"\\$&")},Wa.unescape=va;var yo=a(857);function wo(e){if((e=e.trim().replace(/^["']|["']$/g,"")).startsWith("/")&&!e.match(/^\/mnt\/[a-z]\//i)&&!e.match(/^\/[a-zA-Z]\//))return e.replace(/\/+/g,"/").replace(/\/+$/,"");if((e=function(e){if(e.startsWith("/mnt/")){var t=e.charAt(5).toUpperCase(),n=e.slice(6).replace(/\//g,"\\");return"".concat(t,":").concat(n)}if(e.match(/^\/[a-zA-Z]\//)){var r=e.charAt(1).toUpperCase(),i=e.slice(2).replace(/\//g,"\\");return"".concat(r,":").concat(i)}return e.match(/^[a-zA-Z]:/)?e.replace(/\//g,"\\"):e}(e)).startsWith("\\\\")){var t=e;e="\\\\"+(t=t.replace(/^\\{2,}/,"\\\\")).substring(2).replace(/\\\\/g,"\\")}else e=e.replace(/\\\\/g,"\\");var n=pi.normalize(e);if(e.startsWith("\\\\")&&!n.startsWith("\\\\")&&(n="\\"+n),n.match(/^[a-zA-Z]:/)){var r=n.replace(/\//g,"\\");return/^[a-z]:/.test(r)&&(r=r.charAt(0).toUpperCase()+r.slice(1)),r}return n.replace(/\//g,"\\")}function bo(e){return e.startsWith("~/")||"~"===e?pi.join(yo.homedir(),e.slice(1)):e}function ko(e,t){if("string"!==typeof e||!Array.isArray(t))return!1;if(!e||0===t.length)return!1;if(e.includes("\0"))return!1;var n;try{n=pi.resolve(pi.normalize(e))}catch(r){return!1}if(!pi.isAbsolute(n))throw new Error("Path must be absolute after normalization");return t.some(function(e){if("string"!==typeof e||!e)return!1;if(e.includes("\0"))return!1;var t;try{t=pi.resolve(pi.normalize(e))}catch(i){return!1}if(!pi.isAbsolute(t))throw new Error("Allowed directories must be absolute paths after normalization");if(n===t)return!0;if(t===pi.sep)return n.startsWith(pi.sep);if("\\"===pi.sep&&t.match(/^[A-Za-z]:\\?$/)){var r=t.charAt(0).toLowerCase();return n.charAt(0).toLowerCase()===r&&n.startsWith(t.replace(/\\?$/,"\\"))}return n.startsWith(t+pi.sep)})}var xo=[];function _o(e){return e.replace(/\r\n/g,"\n")}function So(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"file";return Fi(n,n,_o(e),_o(t),"original","modified")}function Co(e){return Eo.apply(this,arguments)}function Eo(){return(Eo=u(s().m(function e(t){var n,r,i,a,o,c,u;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t){e.n=1;break}throw new zr("Path is required");case 1:if(n=bo(t),r=pi.isAbsolute(n)?pi.resolve(n):pi.resolve(process.cwd(),n),i=wo(r),ko(i,xo)){e.n=2;break}throw new zr("Access denied - path outside allowed directories: ".concat(r),r,xo);case 2:return e.p=2,e.n=3,fi.realpath(r);case 3:if(a=e.v,ko(wo(a),xo)){e.n=4;break}throw new qr("Access denied - symlink target outside allowed directories: ".concat(a),a,"symlink_validation");case 4:return e.a(2,a);case 5:if(e.p=5,"ENOENT"!==(u=e.v).code){e.n=10;break}return o=pi.dirname(r),e.p=6,e.n=7,fi.realpath(o);case 7:if(c=e.v,ko(wo(c),xo)){e.n=8;break}throw new zr("Access denied - parent directory outside allowed directories: ".concat(c),c,xo);case 8:return e.a(2,r);case 9:throw e.p=9,e.v,new Lr("Parent directory does not exist: ".concat(o),o);case 10:throw u;case 11:return e.a(2)}},e,null,[[6,9],[2,5]])}))).apply(this,arguments)}function To(e){return Po.apply(this,arguments)}function Po(){return(Po=u(s().m(function e(t){var n,r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fi.stat(t);case 1:return n=e.v,e.a(2,{size:n.size,created:n.birthtime,modified:n.mtime,accessed:n.atime,isDirectory:n.isDirectory(),isFile:n.isFile(),permissions:n.mode.toString(8).slice(-3)});case 2:throw e.p=2,r=e.v,new Lr("Failed to get file stats: ".concat(r instanceof Error?r.message:String(r)),t);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function Oo(e){return Ao.apply(this,arguments)}function Ao(){return Ao=u(s().m(function e(t){var n,r,i,a,o,c,u=arguments;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:{},e.p=1,r=n.encoding,i=void 0===r?"utf-8":r,a=n.head,o=n.tail,!a||!o){e.n=2;break}throw new Error("Cannot specify both head and tail parameters simultaneously");case 2:if(!o){e.n=4;break}return e.n=3,jo(t,o);case 3:case 5:case 7:return e.a(2,e.v);case 4:if(!a){e.n=6;break}return e.n=5,Mo(t,a);case 6:return e.n=7,fi.readFile(t,i);case 8:throw e.p=8,c=e.v,new Lr("Failed to read file: ".concat(c instanceof Error?c.message:String(c)),t);case 9:return e.a(2)}},e,null,[[1,8]])})),Ao.apply(this,arguments)}function Fo(e,t){return Io.apply(this,arguments)}function Io(){return Io=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d=arguments;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=d.length>2&&void 0!==d[2]?d[2]:{},e.p=1,i=r.encoding,a=void 0===i?"utf-8":i,o=r.flag,e.p=2,e.n=3,fi.writeFile(t,n,{encoding:a,flag:o||"wx"});case 3:e.n=15;break;case 4:if(e.p=4,"EEXIST"!==(u=e.v).code){e.n=14;break}return c="".concat(t,".").concat((0,ci.randomBytes)(16).toString("hex"),".tmp"),e.p=5,e.n=6,fi.writeFile(c,n,a);case 6:return e.n=7,fi.rename(c,t);case 7:e.n=13;break;case 8:return e.p=8,l=e.v,e.p=9,e.n=10,fi.unlink(c);case 10:e.n=12;break;case 11:e.p=11,e.v;case 12:throw l;case 13:e.n=15;break;case 14:throw u;case 15:e.n=17;break;case 16:throw e.p=16,f=e.v,new Lr("Failed to write file: ".concat(f instanceof Error?f.message:String(f)),t);case 17:return e.a(2)}},e,null,[[9,11],[5,8],[2,4],[1,16]])})),Io.apply(this,arguments)}function jo(e,t){return Ro.apply(this,arguments)}function Ro(){return Ro=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d,p,h,m,v,g,y,w;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=1024,e.p=1,e.n=2,fi.stat(t);case 2:if(i=e.v,0!==(a=i.size)){e.n=3;break}return e.a(2,"");case 3:return e.n=4,fi.open(t,"r");case 4:o=e.v,e.p=5,c=[],u=a,l=Buffer.alloc(r),f=0,d="";case 6:if(!(u>0&&f<n)){e.n=9;break}return p=Math.min(r,u),u-=p,e.n=7,o.read(l,0,p,u);case 7:if(h=e.v,m=h.bytesRead){e.n=8;break}return e.a(3,9);case 8:for(v=l.slice(0,m).toString("utf-8"),g=_o(v+d).split("\n"),u>0&&(d=g[0],g.shift()),y=g.length-1;y>=0&&f<n;y--)c.unshift(g[y]),f++;e.n=6;break;case 9:return e.a(2,c.join("\n"));case 10:return e.p=10,e.n=11,o.close();case 11:return e.f(10);case 12:e.n=14;break;case 13:throw e.p=13,w=e.v,new Lr("Failed to tail file: ".concat(w instanceof Error?w.message:String(w)),t);case 14:return e.a(2)}},e,null,[[5,,10,12],[1,13]])})),Ro.apply(this,arguments)}function Mo(e,t){return Do.apply(this,arguments)}function Do(){return(Do=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d,p,h,m,v;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fi.open(t,"r");case 1:r=e.v,e.p=2,i=[],a="",o=0,c=Buffer.alloc(1024);case 3:if(!(i.length<n)){e.n=13;break}return e.n=4,r.read(c,0,c.length,o);case 4:if(0!==(u=e.v).bytesRead){e.n=5;break}return e.a(3,13);case 5:if(o+=u.bytesRead,a+=c.slice(0,u.bytesRead).toString("utf-8"),-1===(l=a.lastIndexOf("\n"))){e.n=12;break}f=a.slice(0,l).split("\n"),a=a.slice(l+1),d=P(f),e.p=6,d.s();case 7:if((p=d.n()).done){e.n=9;break}if(h=p.value,i.push(h),!(i.length>=n)){e.n=8;break}return e.a(3,9);case 8:e.n=7;break;case 9:e.n=11;break;case 10:e.p=10,m=e.v,d.e(m);case 11:return e.p=11,d.f(),e.f(11);case 12:e.n=3;break;case 13:return a.length>0&&i.length<n&&i.push(a),e.a(2,i.join("\n"));case 14:return e.p=14,e.n=15,r.close();case 15:return e.f(14);case 16:e.n=18;break;case 17:throw e.p=17,v=e.v,new Lr("Failed to head file: ".concat(v instanceof Error?v.message:String(v)),t);case 18:return e.a(2)}},e,null,[[6,10,11,12],[2,,14,16],[0,17]])}))).apply(this,arguments)}function Uo(e){return No.apply(this,arguments)}function No(){return(No=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){var r=(0,di.createReadStream)(t),i=[];r.on("data",function(e){i.push(e)}),r.on("end",function(){var t=Buffer.concat(i);e(t.toString("base64"))}),r.on("error",function(e){return n(e)})}))},e)}))).apply(this,arguments)}function Lo(e){return zo.apply(this,arguments)}function zo(){return(zo=u(s().m(function e(t){var n,r,i,a,o;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=pi.extname(t).toLowerCase(),r={".png":"image/png",".jpg":"image/jpeg",".jpeg":"image/jpeg",".gif":"image/gif",".webp":"image/webp",".bmp":"image/bmp",".svg":"image/svg+xml",".mp3":"audio/mpeg",".wav":"audio/wav",".ogg":"audio/ogg",".flac":"audio/flac"}[n]||"application/octet-stream",e.n=1,Uo(t);case 1:return i=e.v,a=r.startsWith("image/")?"image":r.startsWith("audio/")?"audio":"blob",e.a(2,{data:i,mimeType:r,type:a});case 2:throw e.p=2,o=e.v,new Lr("Failed to read media file: ".concat(o instanceof Error?o.message:String(o)),t);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function qo(e){return Zo.apply(this,arguments)}function Zo(){return Zo=u(s().m(function e(t){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Promise.all(t.map(function(){var e=u(s().m(function e(t){var n,r,i,a;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Co(t);case 1:return n=e.v,e.n=2,Oo(n);case 2:return r=e.v,e.a(2,{path:t,content:r});case 3:return e.p=3,a=e.v,i=a instanceof Error?a.message:String(a),e.a(2,{path:t,content:"",error:i})}},e,null,[[0,3]])}));return function(t){return e.apply(this,arguments)}}()));case 1:return e.a(2,e.v)}},e)})),Zo.apply(this,arguments)}function Bo(e){return Wo.apply(this,arguments)}function Wo(){return(Wo=u(s().m(function e(t){var n;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fi.mkdir(t,{recursive:!0});case 1:e.n=3;break;case 2:throw e.p=2,n=e.v,new Lr("Failed to create directory: ".concat(n instanceof Error?n.message:String(n)),t);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function Go(e,t){return Ho.apply(this,arguments)}function Ho(){return(Ho=u(s().m(function e(t,n){var r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fi.rename(t,n);case 1:e.n=3;break;case 2:throw e.p=2,r=e.v,new Lr("Failed to move file: ".concat(r instanceof Error?r.message:String(r)),t);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function $o(e){return Vo.apply(this,arguments)}function Vo(){return Vo=u(s().m(function e(t){var n,r,i,a,o,c=arguments;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=c.length>1&&void 0!==c[1]&&c[1],r=c.length>2&&void 0!==c[2]?c[2]:"name",e.p=1,e.n=2,fi.readdir(t,{withFileTypes:!0});case 2:if(i=e.v,n){e.n=3;break}return e.a(2,i.map(function(e){return{name:e.name,isDirectory:e.isDirectory()}}));case 3:return e.n=4,Promise.all(i.map(function(){var e=u(s().m(function e(n){var r,i;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=pi.join(t,n.name),e.p=1,e.n=2,fi.stat(r);case 2:return i=e.v,e.a(2,{name:n.name,isDirectory:n.isDirectory(),size:i.size,mtime:i.mtime});case 3:return e.p=3,e.v,e.a(2,{name:n.name,isDirectory:n.isDirectory(),size:0,mtime:new Date(0)})}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()));case 4:return a=e.v,e.a(2,A(a).sort(function(e,t){return"size"===r?(t.size||0)-(e.size||0):e.name.localeCompare(t.name)}));case 5:throw e.p=5,o=e.v,new Lr("Failed to list directory: ".concat(o instanceof Error?o.message:String(o)),t);case 6:return e.a(2)}},e,null,[[1,5]])})),Vo.apply(this,arguments)}function Ko(e,t){return Qo.apply(this,arguments)}function Qo(){return Qo=u(s().m(function e(t,n){var r,i,a,o,c,l=arguments;return s().w(function(e){for(;;)switch(e.n){case 0:return c=function(){return(c=u(s().m(function e(r){var c,u,l,f,d;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fi.readdir(r,{withFileTypes:!0});case 1:c=e.v,u=P(c),e.p=2,f=s().m(function e(){var c,u,f;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return c=l.value,u=pi.join(r,c.name),e.p=1,e.n=2,Co(u);case 2:if(f=pi.relative(t,u),!i.some(function(e){return Wa(f,e,{dot:!0})})){e.n=3;break}return e.a(2,0);case 3:if(Wa(f,n,{dot:!0})&&a.push(u),!c.isDirectory()){e.n=4;break}return e.n=4,o(u);case 4:e.n=6;break;case 5:return e.p=5,e.v,e.a(2,0);case 6:return e.a(2)}},e,null,[[1,5]])}),u.s();case 3:if((l=u.n()).done){e.n=6;break}return e.d(Gr(f()),4);case 4:if(0!==e.v){e.n=5;break}return e.a(3,5);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,d=e.v,u.e(d);case 8:return e.p=8,u.f(),e.f(8);case 9:e.n=11;break;case 10:e.p=10,e.v;case 11:return e.a(2)}},e,null,[[2,7,8,9],[0,10]])}))).apply(this,arguments)},o=function(e){return c.apply(this,arguments)},r=(l.length>2&&void 0!==l[2]?l[2]:{}).excludePatterns,i=void 0===r?[]:r,a=[],e.n=1,o(t);case 1:return e.a(2,a)}},e)})),Qo.apply(this,arguments)}function Jo(e,t){return Yo.apply(this,arguments)}function Yo(){return Yo=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d,p,h,m,v,g,y,w=arguments;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=(w.length>2&&void 0!==w[2]?w[2]:{}).dryRun,i=void 0!==r&&r,e.p=1,m=_o,e.n=2,fi.readFile(t,"utf-8");case 2:a=m(e.v),o=a,c=P(n),e.p=3,l=s().m(function e(){var t,n,r,i,a,c,l,f;return s().w(function(e){for(;;)switch(e.n){case 0:if(t=u.value,n=_o(t.oldText),r=_o(t.newText),!o.includes(n)){e.n=1;break}return o=o.replace(n,r),e.a(2,1);case 1:i=n.split("\n"),a=o.split("\n"),c=!1,l=s().m(function e(){var t,n,u,l;return s().w(function(e){for(;;)switch(e.n){case 0:if(t=a.slice(f,f+i.length),!i.every(function(e,n){var r=t[n];return e.trim()===r.trim()})){e.n=1;break}return u=(null===(n=a[f].match(/^\s*/))||void 0===n?void 0:n[0])||"",l=r.split("\n").map(function(e,t){var n,r;if(0===t)return u+e.trimStart();var a=(null===(n=i[t])||void 0===n||null===(n=n.match(/^\s*/))||void 0===n?void 0:n[0])||"",o=(null===(r=e.match(/^\s*/))||void 0===r?void 0:r[0])||"";if(a&&o){var s=o.length-a.length;return u+" ".repeat(Math.max(0,s))+e.trimStart()}return e}),a.splice.apply(a,[f,i.length].concat(A(l))),o=a.join("\n"),c=!0,e.a(2,1);case 1:return e.a(2)}},e)}),f=0;case 2:if(!(f<=a.length-i.length)){e.n=5;break}return e.d(Gr(l()),3);case 3:if(!e.v){e.n=4;break}return e.a(3,5);case 4:f++,e.n=2;break;case 5:if(c){e.n=6;break}throw new Error("Could not find exact match for edit:\n".concat(t.oldText));case 6:return e.a(2)}},e)}),c.s();case 4:if((u=c.n()).done){e.n=7;break}return e.d(Gr(l()),5);case 5:if(!e.v){e.n=6;break}return e.a(3,6);case 6:e.n=4;break;case 7:e.n=9;break;case 8:e.p=8,v=e.v,c.e(v);case 9:return e.p=9,c.f(),e.f(9);case 10:for(f=So(a,o,t),d=3;f.includes("`".repeat(d));)d++;if(p="".concat("`".repeat(d),"diff\n").concat(f).concat("`".repeat(d),"\n\n"),i){e.n=19;break}return h="".concat(t,".").concat((0,ci.randomBytes)(16).toString("hex"),".tmp"),e.p=11,e.n=12,fi.writeFile(h,o,"utf-8");case 12:return e.n=13,fi.rename(h,t);case 13:e.n=19;break;case 14:return e.p=14,g=e.v,e.p=15,e.n=16,fi.unlink(h);case 16:e.n=18;break;case 17:e.p=17,e.v;case 18:throw g;case 19:return e.a(2,p);case 20:throw e.p=20,y=e.v,new Lr("Failed to apply file edits: ".concat(y instanceof Error?y.message:String(y)),t);case 21:return e.a(2)}},e,null,[[15,17],[11,14],[3,8,9,10],[1,20]])})),Yo.apply(this,arguments)}var Xo=new(function(){return h(function e(){l(this,e)},[{key:"validatePath",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Co(t))},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFileStats",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,To(t))},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"readFileContent",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Oo(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"writeFileContent",value:function(){var e=u(s().m(function e(t,n,r){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Fo(t,n,r))},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createDirectory",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Bo(t))},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"moveFile",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Go(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"listDirectory",value:function(){var e=u(s().m(function e(t,n,r){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,$o(t,n,r))},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"searchFiles",value:function(){var e=u(s().m(function e(t,n,r){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Ko(t,n,r))},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"applyFileEdits",value:function(){var e=u(s().m(function e(t,n,r){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Jo(t,n,r))},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"readMediaFile",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Lo(t))},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"readMultipleFiles",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,qo(t))},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"tailFile",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,jo(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"headFile",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Mo(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getAllowedDirectories",value:function(){return A(xo)}},{key:"setAllowedDirectories",value:function(e){return function(e){xo=A(e),Mr.debug("Updated allowed directories",{count:e.length})}(e)}}])}()),es=function(e,t,n){return e&&""!==e.trim()?e.replace("${code}",t).replace("${convention}",n):function(e,t){return"\n<goal>\nYou are an expert AI Code Review Agent. Your sole purpose is to analyze a `git diff` snippet and identify violations of the provided coding conventions.\n**Strictly Scoped:** Your analysis and suggestions **must not** extend beyond the code shown in the diff chunks. Do not comment on or suggest changes that are not directly related to the diff.\n**Convention-Based:** Every issue you identify **must** directly correspond to a specific rule in the provided `<convention>`. If a change does not violate a provided rule, it is not an issue.\n**Minimal & Direct Fixes:** Your proposed fixes must be minimal and directly correct the violation on the specified line(s) from the diff. Do **not** refactor, add new logic, or reformat code that is not in violation.\n**No Assumptions:** If the diff lacks the context to confirm a violation, do not flag it.\n</goal>\n\n<executionFlow>\n\n1.  **Internal Analysis (Chain of Thought):**\n    - Iterate through the `git diff` chunk by chunk (each `@@ ... @@` section).\n    - Compare each added line against every rule in the `<convention>` document.\n    - If a violation is found, note the rule violated and formulate a direct, minimal fix for only that line.\n2.  **Final Output Generation:**\n    - Based on your internal analysis, format all identified violations using the precise `<violationsTemplate>`.\n    - If no violations are found after reviewing all diff chunks, your entire output **must** be only the phrase: `No violations found.`\n\n</executionFlow>\n\n<violationsTemplate>\n\n```md\n## Issue: [A concise description of the violation, referencing the specific coding convention rule.]\n\n### Fix: [A numbered list of clear, self-contained steps to resolve the issue.]\n```\n\n</violationsTemplate>\n\n<codeReviewContext>\n<code>\n".concat(e,"\n</code>\n<convention>\n").concat(t,"\n</convention>\n</codeReviewContext>\n\nOkay, I will review the provided code and identify violations based on provided conventions:\n\n```md\n--YOUR RESPONSE HERE--\n```\n")}(t,n)},ts=function(e,t){return e&&""!==e.trim()?e.replace("${codeChanges}",t):function(e){return'\nYou are an expert Test Engineer responsible for maintaining a high-quality, robust unit test suite. Your task is to activate "Ultrathink" mode and perform a step-by-step analysis of the code changes and create a precise, actionable maintenance plan for the corresponding unit tests.\n\n<goal>\n- Analyze the provided git diff to identify functions that have been added, modified, or deleted.\n- For each function change, determine what unit test maintenance is required.\n- Generate a structured maintenance plan following the exact format specified in the <output_format> section.\n- Focus on identifying specific functions and their changes, not general file-level changes.\n</goal>\n\n<analysis_instructions>\n1. Parse the git diff to identify:\n   - NEW functions: Functions that appear only in + lines (additions)\n   - UPDATED functions: Functions that appear in both - and + lines (modifications)\n   - DELETED functions: Functions that appear only in - lines (deletions)\n   - RENAMED: **Recognize function renames (a deletion and an addition with a highly similar body/signature) and classify them as UPDATED. Explicitly mention the name change in the action items.\n\n2. For each identified function change, determine the unit test maintenance actions:\n   - NEW: Create comprehensive unit tests covering all code paths\n   - UPDATED: Update existing tests to match new behavior, add tests for new code paths\n   - DELETED: Remove corresponding unit tests and clean up test dependencies\n\n3. Provide specific, actionable steps for each test maintenance task. Actions must ensure all new/modified logic paths, edge cases, and error-handling scenarios are fully tested.\n</analysis_instructions>\n\n<output_format>\nGenerate a markdown checklist following this **exact format** for each function requiring test maintenance. Do not add any extra commentary before or after the list.\n\n- [ ] **[NEW/UPDATED/DELETED]**: functionName()\n- **Actions**:\n  1. [First specific, actionable step]\n  2. [Second specific, actionable step]\n  3. ...\n</output_format>\n\n<example_format>\n- [ ] **NEW**: calculateTotal() in \n- **Actions**:\n  1. Create a new test file tests/utils/calculations.test.js.\n  2. Write a test case for a standard array of positive numbers.\n  3. Add test cases for edge scenarios, including an empty array and an array with zero/negative values.\n  4. Test error handling when the input is not an array (e.g., null, string).\n  5. Assert that the return value is of the correct data type (number).\n\n- [ ] **UPDATED**: processPayment()\n- **Actions**:\n  1. Locate the existing tests in tests/services/payment.test.js.\n  2. Update test cases to reflect the new currency parameter in the function signature.\n  3. Add a new test to validate the behavior of the added currency conversion logic.\n  4. Update mocks for the CurrencyConverter dependency to include the new endpoint.\n\n- [ ] **DELETED**: isUserActive()\n- **Actions**:\n  1. Remove the entire isUserActive.test.js test file.\n  2. Search the codebase for any test files that imported and used isUserActive() and remove those dependencies.\n</example_format>\n\n<ImportantReminder>\nOnly include functions that actually require unit test changes. Do not include trivial changes like formatting, comments, or variable renames that don\'t affect functionality.\n</ImportantReminder>\n\n<code_diff>\n'.concat(e,"\n</code_diff>\n")}(t)},ns=Rr(),rs=function(){var e=u(s().m(function e(){var t,n,r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!ns.describeImageTemplateUri){e.n=4;break}return e.p=1,Mr.debug("Loading describe image prompt from template URI",{templateUri:ns.describeImageTemplateUri}),e.n=2,Xo.readFileContent(ns.describeImageTemplateUri);case 2:return t=e.v,Mr.debug("Successfully loaded prompt template from URI",{TemplatePreview:t.slice(0,100)+"..."+t.slice(-100)}),e.a(2,t);case 3:return e.p=3,r=e.v,n=r instanceof Error?r.message:String(r),Mr.warn("Error loading prompt template from URI, using default",{templateUri:ns.describeImageTemplateUri,error:n}),e.a(2,is);case 4:return e.a(2,is)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),is="\nYou are an expert image analysis AI. Your task is to provide detailed, accurate descriptions of images.\n\n<goal>\nAnalyze the provided image and generate a comprehensive description that captures:\n- Main subjects and objects in the image\n- Visual composition and layout\n- Colors, lighting, and atmosphere\n- Actions or activities taking place\n- Context and setting\n- Any text or notable details visible\n- Overall mood or style\n</goal>\n\n<guidelines>\n- Be descriptive and specific\n- Use clear, objective language\n- Mention spatial relationships (left, right, foreground, background)\n- Include relevant details about size, color, texture, and condition\n- If there are people, describe their appearance, clothing, and actions without making assumptions about identity\n- Note any text, signs, or written content visible in the image\n- Describe the overall composition and photographic style\n- Keep the description factual and avoid speculation\n</guidelines>\n\n<format>\nProvide your description in a single, well-structured paragraph that flows naturally while covering all important visual elements of the image.\n</format>\n\n<important-notes>\n$ADDITIONAL_NOTES\n</important-notes>\n",as=function(e,t,n,r){return e&&""!==e.trim()?e.replace("${code}",t).replace("${convention}",n).replace("${filePath}",r):function(e,t,n){return"\n<goal>\nYou are an expert AI Code Review Agent tasked with analyzing a `git diff` snippet and generating a structured task list for code review findings.\n\nYour analysis must:\n- **Convention-Based**: Every issue identified must directly correspond to a specific rule in the provided `<convention>`.\n- **Strictly Scoped**: Analysis must not extend beyond the code shown in the diff chunks.\n- **Actionable**: All resolutions must be clear, atomic, self-contained steps with all necessary context for independent execution.\n- **Structured Output**: Use the exact task list format specified below.\n</goal>\n\n<executionFlow>\n1. **Internal Analysis:**\n   - Iterate through the `git diff` chunk by chunk (each `@@ ... @@` section).\n   - Compare each added/modified line against every rule in the `<convention>` document.\n   - For each violation, note the specific rule and formulate clear resolution steps.\n\n2. **Final Output Generation:**\n   - Format findings using the precise `<outputTemplate>` below.\n   - If the file is compliant (no violations found), use the compliant format.\n   - If violations are found, use the non-compliant format with all issues listed.\n</executionFlow>\n\n<outputTemplate>\n\n**For files with violations (non-compliant):**\n\n```md\n[ ] File: ".concat(n,"\n    - **Standard Reference**: [Short reference to the relevant coding convention rule]\n    - **Resolution**:\n      1. [First clear, atomic step to resolve the issue with all necessary context]\n      2. [Second step if needed]\n      3. [Additional steps as needed]\n    - **Standard Reference**: [Reference for second issue if any]\n    - **Resolution**:\n      1. [Steps to resolve second issue]\n```\n\n**For compliant files (no violations):**\n\n```md\n- [x] File: ").concat(n," **Compliant**: All code adheres to coding standards\n```\n\n</outputTemplate>\n\n<codeReviewContext>\n<file>\n").concat(n,"\n</file>\n<code>\n").concat(e,"\n</code>\n<convention>\n").concat(t,"\n</convention>\n</codeReviewContext>\n\nGenerate the code review task list for the file above using the exact format specified in <outputTemplate>:\n")}(t,n,r)},os=tn.object({gitDiffOptions:tn.string().describe("A string containing valid options for the git diff command (e.g., master..HEAD)"),gitDiffFileFilter:tn.array(tn.string()).describe("Git diff pathspec(s) used to filter files for review in the git diff command. IMPORTANT: Use forward slashes (/) for paths on all platforms (Windows, Linux, macOS). Git requires forward slashes in pathspecs. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"),codingStandardUris:tn.array(tn.string()).describe("One or more file paths to coding standards to use when reviewing the new code changes")}),ss={name:"review_new_code_with_filter",description:"Review new code in files returned by git diff (using gitDiffOptions and gitDiffFileFilter) against the provided coding standards.",inputSchema:{type:"object",properties:{gitDiffOptions:{type:"string",description:"Git diff options to pass to the git diff command (e.g., master..HEAD)"},gitDiffFileFilter:{type:"array",items:{type:"string"},description:"Pathspec(s) to filter files returned by git diff. IMPORTANT: Always use forward slashes (/) on all platforms. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"},codingStandardUris:{type:"array",items:{type:"string",description:"Paths to coding standards files to apply when reviewing the new code changes"}}},required:["gitDiffOptions","gitDiffFileFilter","codingStandardUris"]}};function cs(e,t){return us.apply(this,arguments)}function us(){return us=u(s().m(function e(t,n){var r,i,a,o,c,l,f,d,p,h,m,v,g,y,w,b,k,x,_,S,C,E;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=Date.now(),Mr.debug("Starting new code with filter review validation",{rawArgs:t}),(i=os.safeParse(t)).success){e.n=1;break}throw a=i.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),Mr.error("New code with filter review validation failed",{errors:a,rawArgs:t}),new Ur("Validation failed: ".concat(a),"args","review_new_code_with_filter");case 1:return o=i.data,c=o.gitDiffOptions,l=o.gitDiffFileFilter,f=o.codingStandardUris,d=t.workdir,p={encoding:"utf8"},d&&(p.cwd=String(d)),Mr.debug("New code with filter review parameters validated",{gitDiffOptions:c,gitDiffFileFilter:l,codingStandardCount:f.length,codingStandardUris:f,workdir:p.cwd}),h=Rr(),m=new li(n),Mr.info("Starting new code with filter review process",{gitDiffOptions:c,gitDiffFileFilter:l,codingStandardCount:f.length,codingStandardUris:f,workdir:p.cwd}),Mr.info("New code with filter review template",{reviewNewCodeWithFilterTemplateUri:h.reviewNewCodeWithFilterTemplateUri}),e.p=2,Mr.debug("Getting new code changes",{gitDiffFileFilter:l}),e.n=3,si.getNewCodeChanges(c,l,p);case 3:if((y=e.v).success){e.n=4;break}return Mr.error("Git new code files command failed",{gitDiffFileFilter:l,error:y.error,duration:Date.now()-r}),e.a(2,{isError:!0,content:[{type:"text",text:y.error}]});case 4:return Mr.debug("New code files retrieved successfully",{fileCount:(null===(v=y.newCodeFiles)||void 0===v?void 0:v.length)||0,files:(null===(g=y.newCodeFiles)||void 0===g?void 0:g.map(function(e){return e.file}))||[]}),Mr.debug("Reading prompt template",{templateUri:h.reviewNewCodeWithFilterTemplateUri}),w="",e.p=5,e.n=6,Xo.readFileContent(h.reviewNewCodeWithFilterTemplateUri);case 6:w=e.v,Mr.debug("Prompt template loaded successfully",{templateLength:w.length}),e.n=8;break;case 7:e.p=7,C=e.v,Mr.error("Failed to read prompt template",{templateUri:h.reviewNewCodeWithFilterTemplateUri,error:C instanceof Error?C.message:String(C)});case 8:return b=[],Mr.debug("Processing coding standards",{standardCount:f.length}),e.n=9,Promise.all(f.map(function(){var e=u(s().m(function e(t){var n,r,i,a,o,c;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=Date.now(),e.p=1,Mr.debug("Reading coding standard",{codingStandardUri:t}),r="",i=!0,e.p=2,e.n=3,Xo.readFileContent(t);case 3:r=e.v,Mr.debug("Coding standard loaded",{codingStandardUri:t,contentLength:r.length}),e.n=5;break;case 4:e.p=4,o=e.v,i=!1,Mr.warn("Failed to read coding convention",{codingStandardUri:t,error:o instanceof Error?o.message:String(o),duration:Date.now()-n});case 5:if(!i){e.n=6;break}return e.n=6,Promise.all(y.newCodeFiles.map(function(){var e=u(s().m(function e(n){var i,a,o,c;return s().w(function(e){for(;;)switch(e.n){case 0:return i=Date.now(),Mr.trace("Processing file for review",{file:n.file,codingStandardUri:t}),a=es(w,n.content,r),Mr.trace("Generated code review prompt",{file:n.file,promptLength:a.length}),e.n=1,m.sample({message:{maxTokens:a.length,messages:[{content:{type:"text",text:a},role:"user"}]}});case 1:o=e.v,c=Date.now()-i,o.success?(b.push({documentUri:t,reviewedFileUri:n.file,response:o}),Mr.info("Completed code review for file",{file:n.file,convention:t,duration:c,resultLength:o.content.text.length})):Mr.warn("Code review sampling failed for file",{file:n.file,codingStandardUri:t,duration:c,error:o.error});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:e.n=8;break;case 7:e.p=7,c=e.v,a=Date.now()-n,Mr.error("Code review processing failed for standard",{codingStandardUri:t,error:c instanceof Error?c.message:String(c),duration:a});case 8:return e.a(2)}},e,null,[[2,4],[1,7]])}));return function(t){return e.apply(this,arguments)}}()));case 9:return k=b.map(function(e){return"# Document: ".concat(e.documentUri,"\n## ").concat(e.reviewedFileUri,"\n").concat(e.response.content.text)}).join("\n\n"),x=Date.now()-r,Mr.info("New code with filter review process completed",{totalReviews:b.length,totalDuration:x,resultLength:k.length}),Mr.debug("Code review results summary",{reviewsByStandard:f.map(function(e){return{standard:e,reviewCount:b.filter(function(t){return t.documentUri===e}).length}})}),e.a(2,{content:[{type:"text",text:k}]});case 10:return e.p=10,E=e.v,_=Date.now()-r,S=E instanceof Error?E.message:String(E),Mr.error("New code with filter review process failed",{error:S,stack:E instanceof Error?E.stack:void 0,duration:_,gitDiffFileFilter:l,codingStandardUris:f}),e.a(2,{isError:!0,content:[{type:"text",text:S}]})}},e,null,[[5,7],[2,10]])})),us.apply(this,arguments)}var ls=tn.object({fileUri:tn.string().describe("The path of changed file that can be use in git diff command"),gitDiffOptions:tn.string().describe("A string containing valid options for the git diff command (e.g., master..HEAD)"),codingStandardUris:tn.array(tn.string()).describe("The coding standards file path to use for the code review against the new code changes")}),fs={name:"review_new_code",description:"Review new added lines of a file pulled from git diff against the given coding standards",inputSchema:{type:"object",properties:{fileUri:{type:"string",description:"The path of changed file that can be use in git diff command"},gitDiffOptions:{type:"string",description:"A string containing valid options for the git diff command (e.g., master..HEAD)"},codingStandardUris:{type:"array",items:{type:"string",description:"The coding standards file path to use for the code review against the new code changes"}}},required:["fileUri","gitDiffOptions","codingStandardUris"]}};function ds(e,t){return ps.apply(this,arguments)}function ps(){return ps=u(s().m(function e(t,n){var r,i,a,o,c,l,f,d,p,h,m,v,g,y,w,b;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((r=ls.safeParse(t)).success){e.n=1;break}throw i=r.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(i),"args","review_new_code");case 1:return a=r.data,o=a.fileUri,c=a.gitDiffOptions,l=a.codingStandardUris,f=t.workdir,d={encoding:"utf8"},f&&(d.cwd=String(f)),p=Rr(),h=new li(n),Mr.info("Starting code review process",{fileUri:o,gitDiffOptions:c,codingStandardUris:l,options:d}),Mr.info("Prompt Template",{reviewNewCodeTemplateUri:p.reviewNewCodeTemplateUri}),e.p=2,e.n=3,si.getDiff({fileUri:o,gitDiffOptions:c,contextSize:100},d);case 3:if((m=e.v).success){e.n=4;break}return Mr.error("Git diff failed",{error:m.error}),e.a(2,{isError:!0,content:[{type:"text",text:m.error}]});case 4:return e.n=5,Xo.readFileContent(p.reviewNewCodeTemplateUri);case 5:return v=e.v,g=[],e.n=6,Promise.all(l.map(function(){var e=u(s().m(function e(t){var n,r,i,a,c,u;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n="",r=!0,e.p=1,e.n=2,Xo.readFileContent(t);case 2:n=e.v,e.n=4;break;case 3:e.p=3,c=e.v,r=!1,Mr.warn("Failed to read coding convention",{codingStandardUri:t,error:c instanceof Error?c.message:String(c)});case 4:if(!r){e.n=6;break}return i=es(v,m.addedLines,n),e.n=5,h.sample({message:{maxTokens:i.length,messages:[{content:{type:"text",text:i},role:"user"}]}});case 5:(a=e.v).success&&(g.push({fileUri:t,response:a}),Mr.info("Completed code review process",{File:o,Convention:t}));case 6:e.n=8;break;case 7:e.p=7,u=e.v,Mr.error("Code review processing failed",{codingStandardUri:t,error:u instanceof Error?u.message:String(u)});case 8:return e.a(2)}},e,null,[[1,3],[0,7]])}));return function(t){return e.apply(this,arguments)}}()));case 6:return y=g.map(function(e){return"# Document: ".concat(e.fileUri,"\n").concat(e.response.content.text)}).join("\n\n"),e.a(2,{content:[{type:"text",text:y}]});case 7:return e.p=7,b=e.v,w=b instanceof Error?b.message:String(b),Mr.error("Code review sampling failed",{error:b}),e.a(2,{isError:!0,content:[{type:"text",text:w}]})}},e,null,[[2,7]])})),ps.apply(this,arguments)}var hs=tn.object({fileUri:tn.string().describe("The file path for the code review"),codingStandardUris:tn.array(tn.string()).describe("The coding standards file path to use for the code review")}),ms={name:"review_file",description:"Perform code review for provided file against the given coding standards",inputSchema:{type:"object",properties:{fileUri:{type:"string",description:"The file path for the code review"},codingStandardUris:{type:"array",items:{type:"string",description:"The coding standards file path to use for the code review"}}},required:["fileUri","codingStandardUris"]}};function vs(e,t){return gs.apply(this,arguments)}function gs(){return gs=u(s().m(function e(t,n){var r,i,a,o,c,l,f,d,p,h,m,v,g,y,w;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((r=hs.safeParse(t)).success){e.n=1;break}throw i=r.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(i),"args","review_file");case 1:return a=r.data,o=a.fileUri,c=a.codingStandardUris,l=t.workdir,f={encoding:"utf8"},l&&(f.cwd=String(l)),d=Rr(),p=new li(n),Mr.info("Starting code review process",{fileUri:o,codingStandardUris:c,options:f}),Mr.info("Prompt Template",{reviewFileTemplateUri:d.reviewFileTemplateUri}),e.p=2,h="",e.p=3,e.n=4,Xo.readFileContent(o);case 4:h=e.v,e.n=6;break;case 5:return e.p=5,y=e.v,Mr.error("Failed to read review file",{error:y instanceof Error?y.message:String(y)}),e.a(2,{isError:!0,content:[{type:"text",text:y instanceof Error?y.message:String(y)}]});case 6:return e.n=7,Xo.readFileContent(d.reviewFileTemplateUri);case 7:return m=e.v,v=[],e.n=8,Promise.all(c.map(function(){var e=u(s().m(function e(t){var n,r,i,a,o,c;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n="",r=!0,e.p=1,e.n=2,Xo.readFileContent(t);case 2:n=e.v,e.n=4;break;case 3:e.p=3,o=e.v,r=!1,Mr.warn("Failed to read coding convention",{codingStandardUri:t,error:o instanceof Error?o.message:String(o)});case 4:if(!r){e.n=6;break}return i=es(m,h,n),e.n=5,p.sample({message:{maxTokens:i.length,messages:[{content:{type:"text",text:i},role:"user"}]}});case 5:(a=e.v).success&&v.push({fileUri:t,response:a});case 6:e.n=8;break;case 7:e.p=7,c=e.v,Mr.error("Code review processing failed",{codingStandardUri:t,error:c instanceof Error?c.message:String(c)});case 8:return e.a(2)}},e,null,[[1,3],[0,7]])}));return function(t){return e.apply(this,arguments)}}()));case 8:if(0!==v.length){e.n=9;break}return e.a(2,{isError:!0,content:[{type:"text",text:"No coding standards could be read for review."}]});case 9:return e.a(2,{content:[{type:"text",text:v.map(function(e){return"# Document: ".concat(e.fileUri,"\n").concat(e.response.content.text)}).join("\n\n")}]});case 10:return e.p=10,w=e.v,g=w instanceof Error?w.message:String(w),Mr.error("Code review sampling failed",{error:w}),e.a(2,{isError:!0,content:[{type:"text",text:g}]})}},e,null,[[3,5],[2,10]])})),gs.apply(this,arguments)}var ys=tn.object({gitDiffOptions:tn.string().describe("A string containing valid options for the git diff command (e.g., master..HEAD)"),gitDiffFileFilter:tn.array(tn.string()).optional().describe("Git diff pathspec(s) used to filter files for review in the git diff command. IMPORTANT: Use forward slashes (/) for paths on all platforms (Windows, Linux, macOS). Git requires forward slashes in pathspecs. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"),codingStandardUris:tn.array(tn.string()).describe("One or more file paths to coding standards to use when reviewing the new code changes"),codeReviewPlanPath:tn.string().describe("The absolute or relative path to the code review plan file where generated code reviews will be inserted."),taskListPlaceholder:tn.string().describe("The placeholder token in the code review plan file that will be replaced with generated code reviews.")}),ws={name:"generate_code_reviews",description:"Generates code reviews from git diff changes against coding standards and updates them into a code review plan file. Analyzes changed files, generates structured code review task lists using LLM, and replaces a placeholder in the specified plan file with the generated reviews.",inputSchema:{type:"object",properties:{gitDiffOptions:{type:"string",description:"Git diff options to pass to the git diff command (e.g., master..HEAD)"},gitDiffFileFilter:{type:"array",items:{type:"string"},description:"Pathspec(s) to filter files returned by git diff. IMPORTANT: Always use forward slashes (/) on all platforms. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"},codingStandardUris:{type:"array",items:{type:"string",description:"Paths to coding standards files to apply when reviewing the new code changes"}},codeReviewPlanPath:{type:"string",description:"The absolute or relative path to the code review plan file where generated code reviews will be inserted."},taskListPlaceholder:{type:"string",description:"The placeholder token in the code review plan file that will be replaced with generated code reviews."}},required:["gitDiffOptions","codingStandardUris","codeReviewPlanPath","taskListPlaceholder"]}};function bs(e,t){return ks.apply(this,arguments)}function ks(){return(ks=u(s().m(function e(t,n){var r,i,a,o;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return Mr.debug("Reading and validating code review plan file",{filePath:t,placeholder:n}),e.p=1,e.n=2,Xo.readFileContent(t);case 2:return r=e.v,Mr.trace("Successfully read code review plan file",{filePath:t,contentLength:r.length}),i=r.includes(n),Mr.debug("Placeholder check result",{hasPlaceholder:i,placeholder:n}),e.a(2,{content:r,hasPlaceholder:i});case 3:throw e.p=3,o=e.v,a=o instanceof Error?o.message:String(o),Mr.error("Failed to read code review plan file",{filePath:t,error:a}),new Lr("Failed to read code review plan file: ".concat(a),t);case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function xs(e,t){return _s.apply(this,arguments)}function _s(){return(_s=u(s().m(function e(t,n){var r,i;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return Mr.debug("Writing updated content to code review plan file",{filePath:t,contentLength:n.length}),e.p=1,e.n=2,Xo.writeFileContent(t,n);case 2:return Mr.info("Successfully updated code review plan file",{filePath:t}),e.a(2,{success:!0});case 3:return e.p=3,i=e.v,r=i instanceof Error?i.message:String(i),Mr.error("Failed to write to code review plan file",{filePath:t,error:r}),e.a(2,{success:!1,error:r})}},e,null,[[1,3]])}))).apply(this,arguments)}function Ss(e,t){return Cs.apply(this,arguments)}function Cs(){return Cs=u(s().m(function e(t,n){var r,i,a,o,c,l,f,d,p,h,m,v,g,y,w,b,k,x,_,S,C,E,T,P,O,A,F,I,j,R;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=Date.now(),Mr.info("Starting generate_code_reviews tool execution"),Mr.trace("Raw arguments received",{rawArgs:t}),(i=ys.safeParse(t)).success){e.n=1;break}throw a=i.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),o="Validation failed: ".concat(a),Mr.error(o,{validationErrors:i.error.errors}),new Ur(o,"args","generate_code_reviews");case 1:return c=i.data,l=c.gitDiffOptions,f=c.gitDiffFileFilter,d=c.codingStandardUris,p=c.codeReviewPlanPath,h=c.taskListPlaceholder,Mr.info("Arguments validated successfully",{gitDiffOptions:l,gitDiffFileFilter:f,codingStandardCount:d.length,codingStandardUris:d,codeReviewPlanPath:p,taskListPlaceholder:h}),m=t.workdir,v={encoding:"utf8"},m&&(v.cwd=String(m),Mr.debug("Working directory set",{workdir:v.cwd})),g=Rr(),y=new li(n),Mr.info("Configuration loaded",{generateCodeReviewsTemplateUri:g.generateCodeReviewsTemplateUri}),e.p=2,Mr.info("Validating code review plan file",{codeReviewPlanPath:p}),e.n=3,bs(p,h);case 3:if(k=e.v,x=k.content,k.hasPlaceholder){e.n=4;break}return _='Placeholder "'.concat(h,'" not found in file "').concat(p,'". Please ensure the placeholder exists in the file before running this tool.'),Mr.error("Placeholder not found in code review plan file",{codeReviewPlanPath:p,taskListPlaceholder:h}),e.a(2,{isError:!0,content:[{type:"text",text:_}]});case 4:return Mr.info("Placeholder found in code review plan file"),Mr.info("Fetching changed files from git",{gitDiffOptions:l,gitDiffFileFilter:f}),e.n=5,si.getNewCodeChanges(l,f||[],v);case 5:if((S=e.v).success){e.n=6;break}return Mr.error("Git new code files command failed",{gitDiffFileFilter:f,error:S.error,duration:Date.now()-r}),e.a(2,{isError:!0,content:[{type:"text",text:S.error}]});case 6:if(Mr.info("Changed files retrieved successfully",{fileCount:(null===(w=S.newCodeFiles)||void 0===w?void 0:w.length)||0,files:(null===(b=S.newCodeFiles)||void 0===b?void 0:b.map(function(e){return e.file}))||[]}),S.newCodeFiles&&0!==S.newCodeFiles.length){e.n=7;break}return Mr.warn("No files have changes to analyze for code review"),e.a(2,{content:[{type:"text",text:"No files match the filter criteria. No code reviews generated."}]});case 7:return Mr.debug("Loading prompt template",{templateUri:g.generateCodeReviewsTemplateUri}),C="",e.p=8,e.n=9,Xo.readFileContent(g.generateCodeReviewsTemplateUri);case 9:C=e.v,Mr.debug("Prompt template loaded successfully",{templateLength:C.length}),e.n=11;break;case 10:e.p=10,j=e.v,Mr.error("Failed to read prompt template",{templateUri:g.generateCodeReviewsTemplateUri,error:j instanceof Error?j.message:String(j)});case 11:return E=[],Mr.info("Processing coding standards and generating reviews",{standardCount:d.length,fileCount:S.newCodeFiles.length}),e.n=12,Promise.all(d.map(function(){var e=u(s().m(function e(t){var n,r,i,a,o,c;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=Date.now(),e.p=1,Mr.debug("Reading coding standard",{codingStandardUri:t}),r="",i=!0,e.p=2,e.n=3,Xo.readFileContent(t);case 3:r=e.v,Mr.debug("Coding standard loaded",{codingStandardUri:t,contentLength:r.length}),e.n=5;break;case 4:e.p=4,o=e.v,i=!1,Mr.warn("Failed to read coding convention",{codingStandardUri:t,error:o instanceof Error?o.message:String(o),duration:Date.now()-n});case 5:if(!i){e.n=6;break}return e.n=6,Promise.all(S.newCodeFiles.map(function(){var e=u(s().m(function e(n){var i,a,o,c;return s().w(function(e){for(;;)switch(e.n){case 0:return i=Date.now(),Mr.trace("Processing file for review",{file:n.file,codingStandardUri:t}),a=as(C,n.content,r,n.file),Mr.trace("Generated code review prompt",{file:n.file,promptLength:a.length}),e.n=1,y.sample({message:{maxTokens:a.length,messages:[{content:{type:"text",text:a},role:"user"}]}});case 1:o=e.v,c=Date.now()-i,o.success?(E.push({documentUri:t,reviewedFileUri:n.file,response:o}),Mr.info("Completed code review for file",{file:n.file,convention:t,duration:c,resultLength:o.content.text.length})):Mr.warn("Code review sampling failed for file",{file:n.file,codingStandardUri:t,duration:c,error:o.error});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:e.n=8;break;case 7:e.p=7,c=e.v,a=Date.now()-n,Mr.error("Code review processing failed for standard",{codingStandardUri:t,error:c instanceof Error?c.message:String(c),duration:a});case 8:return e.a(2)}},e,null,[[2,4],[1,7]])}));return function(t){return e.apply(this,arguments)}}()));case 12:if(T=E.map(function(e){return e.response.content.text}).join("\n\n"),Mr.info("All code reviews generated",{totalReviews:E.length,reviewsLength:T.length,duration:Date.now()-r}),0!==E.length){e.n=13;break}return Mr.warn("No code reviews were generated successfully"),e.a(2,{isError:!0,content:[{type:"text",text:"Failed to generate any code reviews. Please check the logs for details."}]});case 13:return Mr.info("Replacing placeholder with generated code reviews",{placeholder:h}),P=x.replace(h,T),Mr.info("Attempting to write updated code review plan to file",{codeReviewPlanPath:p}),e.n=14,xs(p,P);case 14:if(!(O=e.v).success){e.n=15;break}return A=Date.now()-r,Mr.info("Code reviews generated and plan file updated successfully",{totalReviews:E.length,totalDuration:A}),e.a(2,{content:[{type:"text",text:"\u2713 Code reviews generated successfully and inserted into ".concat(p,"\n\nTotal reviews: ").concat(E.length,"\n\nGenerated code reviews:\n\n").concat(T)}]});case 15:return Mr.warn("Failed to update code review plan file, returning reviews for manual update",{error:O.error}),e.a(2,{isError:!1,content:[{type:"text",text:'\u26a0 Code reviews generated successfully, but failed to update the file "'.concat(p,'"\n\nError: ').concat(O.error,'\n\nPlease manually replace the placeholder "').concat(h,'" with the following code reviews:\n\n').concat(T)}]});case 16:e.n=18;break;case 17:return e.p=17,R=e.v,F=Date.now()-r,I=R instanceof Error?R.message:String(R),Mr.error("Generate code reviews process failed",{error:I,stack:R instanceof Error?R.stack:void 0,duration:F}),e.a(2,{isError:!0,content:[{type:"text",text:"Code review generation failed: ".concat(I)}]});case 18:return e.a(2)}},e,null,[[8,10],[2,17]])})),Cs.apply(this,arguments)}var Es=tn.object({gitDiffOptions:tn.string().describe("A string containing valid options for the git diff command (e.g., master..HEAD)"),gitDiffFileFilter:tn.array(tn.string()).describe("Git diff pathspec(s) used to filter files for review in the git diff command to filter files that valid for code review. IMPORTANT: Use forward slashes (/) for paths on all platforms (Windows, Linux, macOS). Git requires forward slashes in pathspecs. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"),gitContextSize:tn.number().optional().default(100).describe("The number of lines of context to include in the diff output, corresponding to the -U flag. Defaults to 100.")}),Ts={name:"unit_test_analysis",description:"Scans changed files in parallel to generate a maintenance plan for their corresponding unit tests. Uses git diff command to analyze modifications and identifies whether unit tests need to be created, updated, or removed.",inputSchema:{type:"object",properties:{gitDiffOptions:{type:"string",description:"A string containing valid options for the git diff command (e.g., @{u}..HEAD)"},gitDiffFileFilter:{type:"array",items:{type:"string"},description:"Pathspec(s) to filter files returned by git diff to filter files that valid for code review. IMPORTANT: Always use forward slashes (/) on all platforms. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"},gitContextSize:{type:"number",description:"The number of lines of context to include in the diff output, corresponding to the -U flag. Defaults to 100.",default:100}},required:["gitDiffOptions","gitDiffFileFilter"]}};function Ps(e,t){return Os.apply(this,arguments)}function Os(){return Os=u(s().m(function e(t,n){var r,i,a,o,c,l,f,d,p,h,m,v,g,y,w,b,k,x,_,S,C;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((r=Es.safeParse(t)).success){e.n=1;break}throw i=r.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(i),"args","unit_test_analysis");case 1:return a=r.data,o=a.gitDiffFileFilter,c=a.gitDiffOptions,l=a.gitContextSize,f=void 0===l?100:l,d=t.workdir,p={encoding:"utf8"},d&&(p.cwd=String(d)),h=Rr(),m=new li(n),Mr.info("Starting unit test maintenance process",{gitDiffOptions:c,gitDiffFileFilter:o,gitContextSize:f,options:p}),Mr.info("Prompt Template",{analysisUnitTestsTemplateUri:h.analysisUnitTestsTemplateUri}),e.p=2,e.n=3,Xo.readFileContent(h.analysisUnitTestsTemplateUri);case 3:return v=e.v,e.n=4,si.getDiffFilesWithFilter(c,o,p);case 4:return g=e.v,y=g.map(function(){var e=u(s().m(function e(t){var n,r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,si.getDiff({fileUri:t,gitDiffOptions:c,contextSize:f},p);case 1:if((n=e.v).success){e.n=2;break}return Mr.warn("Git diff failed",{fileUri:t,error:n.error}),e.a(2,{fileUri:t,content:"",hasChanges:!1,error:n.error});case 2:return e.a(2,{fileUri:t,content:n.content,hasChanges:!0});case 3:return e.p=3,r=e.v,Mr.warn("Git diff failed",{fileUri:t,error:r instanceof Error?r.message:String(r)}),e.a(2,{fileUri:t,content:"",hasChanges:!1,error:r instanceof Error?r.message:String(r)})}},e,null,[[0,3]])}));return function(t){return e.apply(this,arguments)}}()),e.n=5,Promise.all(y);case 5:if(w=e.v,0!==(b=w.filter(function(e){return e.hasChanges})).length){e.n=6;break}return e.a(2,{content:[{type:"text",text:"No files have changes to analyze for unit test maintenance"}]});case 6:return k=b.map(function(){var e=u(s().m(function e(t){var n,r;return s().w(function(e){for(;;)switch(e.n){case 0:return n=ts(v,t.content),e.n=1,m.sample({message:{maxTokens:n.length,messages:[{content:{type:"text",text:n},role:"user"}]}});case 1:if(r=e.v,Mr.info("Completed unit test maintenance analysis",{file:t.fileUri}),!r.success){e.n=2;break}return e.a(2,{fileUri:t.fileUri,response:r});case 2:return Mr.warn("Failed unit test maintenance analysis",{fileUri:t.fileUri,error:r.error}),e.a(2,{fileUri:t.fileUri,response:r,error:r.error});case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),e.n=7,Promise.all(k);case 7:return x=e.v,_=x.map(function(e){return"# File: ".concat(e.fileUri," \n").concat(e.response.content.text)}).join("\n\n"),e.a(2,{content:[{type:"text",text:_}]});case 8:return e.p=8,C=e.v,S=C instanceof Error?C.message:String(C),Mr.error("Unit test maintenance process failed",{error:C}),e.a(2,{isError:!0,content:[{type:"text",text:"Unit test maintenance failed: ".concat(S)}]})}},e,null,[[2,8]])})),Os.apply(this,arguments)}var As=tn.object({gitDiffOptions:tn.string().describe("A string containing valid options for the git diff command (e.g., master..HEAD)"),gitDiffFileFilter:tn.array(tn.string()).describe("Git diff pathspec(s) used to filter files for review in the git diff command. IMPORTANT: Use forward slashes (/) for paths on all platforms (Windows, Linux, macOS). Git requires forward slashes in pathspecs. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"),gitContextSize:tn.number().optional().default(100).describe("The number of lines of context to include in the diff output, corresponding to the -U flag. Defaults to 100."),unitTestPlanPath:tn.string().describe("The absolute or relative path to the unit test plan file where generated test cases will be inserted."),taskListPlaceholder:tn.string().describe("The placeholder token in the unit test plan file that will be replaced with generated test cases.")}),Fs={name:"generate_test_cases",description:"Generates test cases from code changes and updates them into a unit test plan file. Analyzes git diff to identify code changes, generates BDD-style test cases using LLM, and replaces a placeholder in the specified plan file with the generated test cases.",inputSchema:{type:"object",properties:{gitDiffOptions:{type:"string",description:"A string containing valid options for the git diff command (e.g., @{u}..HEAD)"},gitDiffFileFilter:{type:"array",items:{type:"string"},description:"Pathspec(s) to filter files returned by git diff. IMPORTANT: Always use forward slashes (/) on all platforms. Examples: ['*.ts', 'src/**/*.tsx', ':(exclude)*.test.ts']"},gitContextSize:{type:"number",description:"The number of lines of context to include in the diff output, corresponding to the -U flag. Defaults to 100.",default:100},unitTestPlanPath:{type:"string",description:"The absolute or relative path to the unit test plan file where generated test cases will be inserted."},taskListPlaceholder:{type:"string",description:"The placeholder token in the unit test plan file that will be replaced with generated test cases."}},required:["gitDiffOptions","gitDiffFileFilter","unitTestPlanPath","taskListPlaceholder"]}};function Is(e,t){if(Mr.trace("Substituting code changes into prompt template",{templateLength:e.length,codeChangesLength:t.length}),!e||""===e.trim()){var n="Prompt template is empty or undefined";throw Mr.error(n),new Ur(n,"template","generate_test_cases")}return e.replace("${codeChanges}",t)}function js(e,t){return Rs.apply(this,arguments)}function Rs(){return(Rs=u(s().m(function e(t,n){var r,i,a,o;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return Mr.debug("Reading and validating unit test plan file",{filePath:t,placeholder:n}),e.p=1,e.n=2,Xo.readFileContent(t);case 2:return r=e.v,Mr.trace("Successfully read plan file",{filePath:t,contentLength:r.length}),i=r.includes(n),Mr.debug("Placeholder check result",{hasPlaceholder:i,placeholder:n}),e.a(2,{content:r,hasPlaceholder:i});case 3:throw e.p=3,o=e.v,a=o instanceof Error?o.message:String(o),Mr.error("Failed to read unit test plan file",{filePath:t,error:a}),new Lr("Failed to read unit test plan file: ".concat(a),t);case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function Ms(e,t){return Ds.apply(this,arguments)}function Ds(){return(Ds=u(s().m(function e(t,n){var r,i;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return Mr.debug("Writing updated content to plan file",{filePath:t,contentLength:n.length}),e.p=1,e.n=2,Xo.writeFileContent(t,n);case 2:return Mr.info("Successfully updated unit test plan file",{filePath:t}),e.a(2,{success:!0});case 3:return e.p=3,i=e.v,r=i instanceof Error?i.message:String(i),Mr.error("Failed to write to unit test plan file",{filePath:t,error:r}),e.a(2,{success:!1,error:r})}},e,null,[[1,3]])}))).apply(this,arguments)}function Us(e,t){return Ns.apply(this,arguments)}function Ns(){return Ns=u(s().m(function e(t,n){var r,i,a,o,c,l,f,d,p,h,m,v,g,y,w,b,k,x,_,S,C,E,T,P,O,A,F,I,j,R,M;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Mr.info("Starting generate_test_cases tool execution"),Mr.trace("Raw arguments received",{rawArgs:t}),(r=As.safeParse(t)).success){e.n=1;break}throw i=r.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),a="Validation failed: ".concat(i),Mr.error(a,{validationErrors:r.error.errors}),new Ur(a,"args","generate_test_cases");case 1:return o=r.data,c=o.gitDiffFileFilter,l=o.gitDiffOptions,f=o.gitContextSize,d=void 0===f?100:f,p=o.unitTestPlanPath,h=o.taskListPlaceholder,Mr.info("Arguments validated successfully",{gitDiffOptions:l,gitDiffFileFilter:c,gitContextSize:d,unitTestPlanPath:p,taskListPlaceholder:h}),m=t.workdir,v={encoding:"utf8"},m&&(v.cwd=String(m),Mr.debug("Working directory set",{workdir:m})),g=Rr(),y=new li(n),Mr.info("Configuration loaded",{generateTestCasesTemplateUri:g.generateTestCasesTemplateUri}),e.p=2,Mr.info("Validating unit test plan file",{unitTestPlanPath:p}),e.n=3,js(p,h);case 3:if(w=e.v,b=w.content,w.hasPlaceholder){e.n=4;break}return k='Placeholder "'.concat(h,'" not found in file "').concat(p,'". Please ensure the placeholder exists in the file before running this tool.'),Mr.error("Placeholder not found in plan file",{unitTestPlanPath:p,taskListPlaceholder:h}),e.a(2,{isError:!0,content:[{type:"text",text:k}]});case 4:return Mr.info("Placeholder found in plan file"),Mr.debug("Loading prompt template"),x="",e.p=5,e.n=6,Xo.readFileContent(g.generateTestCasesTemplateUri);case 6:x=e.v,Mr.debug("Prompt template loaded successfully"),e.n=8;break;case 7:throw e.p=7,R=e.v,_="Failed to load prompt template: ".concat(R instanceof Error?R.message:String(R)),Mr.error(_,{templateUri:g.generateTestCasesTemplateUri,error:R instanceof Error?R.message:String(R)}),new Lr(_,g.generateTestCasesTemplateUri||"unknown");case 8:return Mr.info("Fetching changed files from git",{gitDiffOptions:l,gitDiffFileFilter:c}),e.n=9,si.getDiffFilesWithFilter(l,c,v);case 9:if(S=e.v,Mr.info("Changed files retrieved",{fileCount:S.length,files:S}),0!==S.length){e.n=10;break}return Mr.warn("No files match the filter criteria"),e.a(2,{content:[{type:"text",text:"No files match the filter criteria. No test cases generated."}]});case 10:return Mr.info("Fetching diffs for changed files in parallel"),C=S.map(function(){var e=u(s().m(function e(t){var n,r,i,a;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return Mr.debug("Fetching diff for file",{fileUri:t}),e.p=1,e.n=2,si.getDiff({fileUri:t,gitDiffOptions:l,contextSize:d},v);case 2:if((r=e.v).success){e.n=3;break}return Mr.warn("Git diff failed for file",{fileUri:t,error:r.error}),e.a(2,{fileUri:t,content:"",hasChanges:!1,error:r.error});case 3:return Mr.trace("Diff retrieved successfully",{fileUri:t,contentLength:(null===(n=r.content)||void 0===n?void 0:n.length)||0}),e.a(2,{fileUri:t,content:r.content,hasChanges:!0});case 4:return e.p=4,a=e.v,i=a instanceof Error?a.message:String(a),Mr.warn("Exception while fetching diff for file",{fileUri:t,error:i}),e.a(2,{fileUri:t,content:"",hasChanges:!1,error:i})}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}()),e.n=11,Promise.all(C);case 11:if(E=e.v,T=E.filter(function(e){return e.hasChanges}),Mr.info("Diffs analyzed",{totalFiles:E.length,filesWithChanges:T.length}),0!==T.length){e.n=12;break}return Mr.warn("No files have changes to analyze"),e.a(2,{content:[{type:"text",text:"No files have changes to analyze for test case generation."}]});case 12:return Mr.info("Generating test cases using LLM",{fileCount:T.length}),P=T.map(function(){var e=u(s().m(function e(t){var n,r;return s().w(function(e){for(;;)switch(e.n){case 0:return Mr.debug("Generating test cases for file",{fileUri:t.fileUri}),n=Is(x,t.content),e.n=1,y.sample({message:{maxTokens:n.length,messages:[{content:{type:"text",text:n},role:"user"}]}});case 1:if(!(r=e.v).success){e.n=2;break}return Mr.info("Test cases generated successfully",{file:t.fileUri}),e.a(2,{fileUri:t.fileUri,response:r});case 2:return Mr.warn("Failed to generate test cases",{fileUri:t.fileUri,error:r.error}),e.a(2,{fileUri:t.fileUri,response:r,error:r.error});case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),e.n=13,Promise.all(P);case 13:return O=e.v,A=O.map(function(e){return e.response.content.text}).join("\n\n"),Mr.info("All test cases generated",{totalResults:O.length,testCasesLength:A.length}),Mr.info("Replacing placeholder with generated test cases",{placeholder:h}),F=b.replace(h,A),Mr.info("Attempting to write updated plan to file",{unitTestPlanPath:p}),e.n=14,Ms(p,F);case 14:if(!(I=e.v).success){e.n=15;break}return Mr.info("Test cases generated and plan file updated successfully"),e.a(2,{content:[{type:"text",text:"\u2713 Test cases generated successfully and inserted into ".concat(p,"\n\nGenerated test cases:\n\n").concat(A)}]});case 15:return Mr.warn("Failed to update plan file, returning test cases for manual update",{error:I.error}),e.a(2,{isError:!1,content:[{type:"text",text:'\u26a0 Test cases generated successfully, but failed to update the file "'.concat(p,'"\n\nError: ').concat(I.error,'\n\nPlease manually replace the placeholder "').concat(h,'" with the following test cases:\n\n').concat(A)}]});case 16:e.n=18;break;case 17:return e.p=17,M=e.v,j=M instanceof Error?M.message:String(M),Mr.error("Generate test cases process failed",{error:j,stack:M instanceof Error?M.stack:void 0}),e.a(2,{isError:!0,content:[{type:"text",text:"Test case generation failed: ".concat(j)}]});case 18:return e.a(2)}},e,null,[[5,7],[2,17]])})),Ns.apply(this,arguments)}var Ls=tn.object({path:tn.string().describe("Path to the file to read"),tail:tn.number().optional().describe("If provided, returns only the last N lines of the file"),head:tn.number().optional().describe("If provided, returns only the first N lines of the file")}),zs={name:"read_text_file",description:"Read the complete contents of a file from the file system as text. Handles various text encodings and provides detailed error messages if the file cannot be read. Use this tool when you need to examine the contents of a single file. Use the 'head' parameter to read only the first N lines of a file, or the 'tail' parameter to read only the last N lines of a file. Operates on the file as text regardless of extension. Only works within allowed directories.",inputSchema:{type:"object",properties:{path:{type:"string",description:"Path to the file to read"},tail:{type:"number",description:"If provided, returns only the last N lines of the file"},head:{type:"number",description:"If provided, returns only the first N lines of the file"}},required:["path"]}};function qs(e){return Zs.apply(this,arguments)}function Zs(){return Zs=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f,d;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=Ls.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","read_text_file");case 1:if(i=n.data,a=i.path,o=i.tail,c=i.head,Mr.info("Reading text file",{path:a,tail:o,head:c}),e.p=2,!c||!o){e.n=3;break}throw new Error("Cannot specify both head and tail parameters simultaneously");case 3:return e.n=4,Xo.validatePath(a);case 4:return u=e.v,e.n=5,Xo.readFileContent(u,{head:c,tail:o});case 5:return l=e.v,Mr.info("Text file read successfully",{path:a}),e.a(2,{content:[{type:"text",text:l}]});case 6:return e.p=6,d=e.v,f=d instanceof Error?d.message:String(d),Mr.error("Failed to read text file",{path:a,error:f}),e.a(2,{isError:!0,content:[{type:"text",text:"Error reading file: ".concat(f)}]})}},e,null,[[2,6]])})),Zs.apply(this,arguments)}var Bs=tn.object({path:tn.string().describe("Path to the media file to read")}),Ws={name:"read_media_file",description:"Read an image or audio file. Returns the base64 encoded data and MIME type. Only works within allowed directories.",inputSchema:{type:"object",properties:{path:{type:"string",description:"Path to the media file to read"}},required:["path"]}};function Gs(e){return Hs.apply(this,arguments)}function Hs(){return Hs=u(s().m(function e(t){var n,r,i,a,o,c,u,l;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=Bs.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","read_media_file");case 1:return i=n.data,a=i.path,Mr.info("Reading media file",{path:a}),e.p=2,e.n=3,Xo.validatePath(a);case 3:return o=e.v,e.n=4,Xo.readMediaFile(o);case 4:return c=e.v,Mr.info("Media file read successfully",{path:a,mimeType:c.mimeType}),e.a(2,{content:[{type:c.type,data:c.data,mimeType:c.mimeType}]});case 5:return e.p=5,l=e.v,u=l instanceof Error?l.message:String(l),Mr.error("Failed to read media file",{path:a,error:u}),e.a(2,{isError:!0,content:[{type:"text",text:"Error reading media file: ".concat(u)}]})}},e,null,[[2,5]])})),Hs.apply(this,arguments)}var $s=tn.object({paths:tn.array(tn.string()).min(1,"At least one file path must be provided").describe("Array of file paths to read. Each path must be a string pointing to a valid file within allowed directories.")}),Vs={name:"read_multiple_files",description:"Read the contents of multiple files simultaneously. This is more efficient than reading files one by one when you need to analyze or compare multiple files. Each file's content is returned with its path as a reference. Failed reads for individual files won't stop the entire operation. Only works within allowed directories.",inputSchema:{type:"object",properties:{paths:{type:"array",items:{type:"string"},description:"Array of file paths to read",minItems:1}},required:["paths"]}};function Ks(e){return Qs.apply(this,arguments)}function Qs(){return(Qs=u(s().m(function e(t){var n,r,i,a,o,c,u,l;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=$s.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","read_multiple_files");case 1:return i=n.data,a=i.paths,Mr.info("Reading multiple files",{fileCount:a.length}),e.p=2,e.n=3,Xo.readMultipleFiles(a);case 3:return o=e.v,c=o.map(function(e){return e.error?"".concat(e.path,": Error - ").concat(e.error):"".concat(e.path,":\n").concat(e.content,"\n")}).join("\n---\n"),Mr.info("Multiple files read completed",{fileCount:a.length,successCount:o.filter(function(e){return!e.error}).length}),e.a(2,{content:[{type:"text",text:c}]});case 4:return e.p=4,l=e.v,u=l instanceof Error?l.message:String(l),Mr.error("Failed to read multiple files",{paths:a,error:u}),e.a(2,{isError:!0,content:[{type:"text",text:"Error reading multiple files: ".concat(u)}]})}},e,null,[[2,4]])}))).apply(this,arguments)}var Js=tn.object({path:tn.string().describe("Path where the file should be written"),content:tn.string().describe("Content to write to the file")}),Ys={name:"write_file",description:"Create a new file or completely overwrite an existing file with new content. Use with caution as it will overwrite existing files without warning. Handles text content with proper encoding. Only works within allowed directories.",inputSchema:{type:"object",properties:{path:{type:"string",description:"Path where the file should be written"},content:{type:"string",description:"Content to write to the file"}},required:["path","content"]}};function Xs(e){return ec.apply(this,arguments)}function ec(){return ec=u(s().m(function e(t){var n,r,i,a,o,c,u,l;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=Js.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","write_file");case 1:return i=n.data,a=i.path,o=i.content,Mr.info("Writing file",{path:a,contentLength:o.length}),e.p=2,e.n=3,Xo.validatePath(a);case 3:return c=e.v,e.n=4,Xo.writeFileContent(c,o);case 4:return Mr.info("File written successfully",{path:a}),e.a(2,{content:[{type:"text",text:"Successfully wrote to ".concat(a)}]});case 5:return e.p=5,l=e.v,u=l instanceof Error?l.message:String(l),Mr.error("Failed to write file",{path:a,error:u}),e.a(2,{isError:!0,content:[{type:"text",text:"Error writing file: ".concat(u)}]})}},e,null,[[2,5]])})),ec.apply(this,arguments)}var tc=tn.object({oldText:tn.string().describe("Text to search for - must match exactly"),newText:tn.string().describe("Text to replace with")}),nc=tn.object({path:tn.string().describe("Path to the file to edit"),edits:tn.array(tc).describe("Array of edit operations to apply"),dryRun:tn.boolean().default(!1).describe("Preview changes using git-style diff format")}),rc={name:"edit_file",description:"Make line-based edits to a text file. Each edit replaces exact line sequences with new content. Returns a git-style diff showing the changes made. Only works within allowed directories.",inputSchema:{type:"object",properties:{path:{type:"string",description:"Path to the file to edit"},edits:{type:"array",items:{type:"object",properties:{oldText:{type:"string",description:"Text to search for - must match exactly"},newText:{type:"string",description:"Text to replace with"}},required:["oldText","newText"]},description:"Array of edit operations to apply"},dryRun:{type:"boolean",description:"Preview changes using git-style diff format",default:!1}},required:["path","edits"]}};function ic(e){return ac.apply(this,arguments)}function ac(){return ac=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f,d;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=nc.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","edit_file");case 1:return i=n.data,a=i.path,o=i.edits,c=i.dryRun,Mr.info("Editing file",{path:a,editCount:o.length,dryRun:c}),e.p=2,e.n=3,Xo.validatePath(a);case 3:return u=e.v,e.n=4,Xo.applyFileEdits(u,o,{dryRun:c});case 4:return l=e.v,Mr.info("File edits applied successfully",{path:a,dryRun:c}),e.a(2,{content:[{type:"text",text:l}]});case 5:return e.p=5,d=e.v,f=d instanceof Error?d.message:String(d),Mr.error("Failed to edit file",{path:a,error:f}),e.a(2,{isError:!0,content:[{type:"text",text:"Error editing file: ".concat(f)}]})}},e,null,[[2,5]])})),ac.apply(this,arguments)}var oc=tn.object({path:tn.string().describe("Path of the directory to create")}),sc={name:"create_directory",description:"Create a new directory or ensure a directory exists. Can create multiple nested directories in one operation. If the directory already exists, this operation will succeed silently. Perfect for setting up directory structures for projects or ensuring required paths exist. Only works within allowed directories.",inputSchema:{type:"object",properties:{path:{type:"string",description:"Path of the directory to create"}},required:["path"]}};function cc(e){return uc.apply(this,arguments)}function uc(){return uc=u(s().m(function e(t){var n,r,i,a,o,c,u;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=oc.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","create_directory");case 1:return i=n.data,a=i.path,Mr.info("Creating directory",{path:a}),e.p=2,e.n=3,Xo.validatePath(a);case 3:return o=e.v,e.n=4,Xo.createDirectory(o);case 4:return Mr.info("Directory created successfully",{path:a}),e.a(2,{content:[{type:"text",text:"Successfully created directory ".concat(a)}]});case 5:return e.p=5,u=e.v,c=u instanceof Error?u.message:String(u),Mr.error("Failed to create directory",{path:a,error:c}),e.a(2,{isError:!0,content:[{type:"text",text:"Error creating directory: ".concat(c)}]})}},e,null,[[2,5]])})),uc.apply(this,arguments)}var lc=tn.object({path:tn.string().describe("Path to the directory to list")}),fc={name:"list_directory",description:"Get a detailed listing of all files and directories in a specified path. Results clearly distinguish between files and directories with [FILE] and [DIR] prefixes. This tool is essential for understanding directory structure and finding specific files within a directory. Only works within allowed directories.",inputSchema:{type:"object",properties:{path:{type:"string",description:"Path to the directory to list"}},required:["path"]}};function dc(e){return pc.apply(this,arguments)}function pc(){return pc=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=lc.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","list_directory");case 1:return i=n.data,a=i.path,Mr.info("Listing directory",{path:a}),e.p=2,e.n=3,Xo.validatePath(a);case 3:return o=e.v,e.n=4,Xo.listDirectory(o);case 4:return c=e.v,u=c.map(function(e){return"".concat(e.isDirectory?"[DIR]":"[FILE]"," ").concat(e.name)}).join("\n"),Mr.info("Directory listed successfully",{path:a,entryCount:c.length}),e.a(2,{content:[{type:"text",text:u}]});case 5:return e.p=5,f=e.v,l=f instanceof Error?f.message:String(f),Mr.error("Failed to list directory",{path:a,error:l}),e.a(2,{isError:!0,content:[{type:"text",text:"Error listing directory: ".concat(l)}]})}},e,null,[[2,5]])})),pc.apply(this,arguments)}var hc=tn.object({source:tn.string().describe("Source path of the file or directory to move"),destination:tn.string().describe("Destination path where the file or directory should be moved")}),mc={name:"move_file",description:"Move or rename files and directories. Can move files between directories and rename them in a single operation. If the destination exists, the operation will fail. Works across different directories and can be used for simple renaming within the same directory. Both source and destination must be within allowed directories.",inputSchema:{type:"object",properties:{source:{type:"string",description:"Source path of the file or directory to move"},destination:{type:"string",description:"Destination path where the file or directory should be moved"}},required:["source","destination"]}};function vc(e){return gc.apply(this,arguments)}function gc(){return(gc=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=hc.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","move_file");case 1:return i=n.data,a=i.source,o=i.destination,Mr.info("Moving file",{source:a,destination:o}),e.p=2,e.n=3,Xo.validatePath(a);case 3:return c=e.v,e.n=4,Xo.validatePath(o);case 4:return u=e.v,e.n=5,Xo.moveFile(c,u);case 5:return Mr.info("File moved successfully",{source:a,destination:o}),e.a(2,{content:[{type:"text",text:"Successfully moved ".concat(a," to ").concat(o)}]});case 6:return e.p=6,f=e.v,l=f instanceof Error?f.message:String(f),Mr.error("Failed to move file",{source:a,destination:o,error:l}),e.a(2,{isError:!0,content:[{type:"text",text:"Error moving file: ".concat(l)}]})}},e,null,[[2,6]])}))).apply(this,arguments)}var yc=tn.object({path:tn.string().describe("Root path to search from"),pattern:tn.string().describe("Glob pattern to match files against"),excludePatterns:tn.array(tn.string()).optional().default([]).describe("Patterns to exclude from search results")}),wc={name:"search_files",description:"Recursively search for files and directories matching a pattern. The patterns should be glob-style patterns that match paths relative to the working directory. Use pattern like '*.ext' to match files in current directory, and '**/*.ext' to match files in all subdirectories. Returns full paths to all matching items. Great for finding files when you don't know their exact location. Only searches within allowed directories.",inputSchema:{type:"object",properties:{path:{type:"string",description:"Root path to search from"},pattern:{type:"string",description:"Glob pattern to match files against"},excludePatterns:{type:"array",items:{type:"string"},description:"Patterns to exclude from search results",default:[]}},required:["path","pattern"]}};function bc(e){return kc.apply(this,arguments)}function kc(){return kc=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f,d,p;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=yc.safeParse(t)).success){e.n=1;break}throw r=n.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(r),"args","search_files");case 1:return i=n.data,a=i.path,o=i.pattern,c=i.excludePatterns,Mr.info("Searching files",{path:a,pattern:o,excludePatternCount:c.length}),e.p=2,e.n=3,Xo.validatePath(a);case 3:return u=e.v,e.n=4,Xo.searchFiles(u,o,{excludePatterns:c});case 4:return l=e.v,f=l.length>0?l.join("\n"):"No matches found",Mr.info("File search completed",{path:a,pattern:o,matchCount:l.length}),e.a(2,{content:[{type:"text",text:f}]});case 5:return e.p=5,p=e.v,d=p instanceof Error?p.message:String(p),Mr.error("Failed to search files",{path:a,pattern:o,error:d}),e.a(2,{isError:!0,content:[{type:"text",text:"Error searching files: ".concat(d)}]})}},e,null,[[2,5]])})),kc.apply(this,arguments)}function xc(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(n){return!1}}a(823);for(var _c={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"},Sc={},Cc=0,Ec=Object.entries(_c);Cc<Ec.length;Cc++){var Tc=E(Ec[Cc],2),Pc=Tc[0],Oc=Tc[1];Sc[Oc]=Number.parseInt(Pc)}function Ac(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";switch(t.toLowerCase()){case"utf-8":case"utf8":return"undefined"!==typeof globalThis.TextDecoder?new globalThis.TextDecoder("utf-8").decode(e):function(e){var t="",n=0;for(;n<e.length;){var r=e[n++];if(r<128)t+=String.fromCharCode(r);else if(r<224){var i=63&e[n++];t+=String.fromCharCode((31&r)<<6|i)}else if(r<240){var a=63&e[n++],o=63&e[n++];t+=String.fromCharCode((15&r)<<12|a<<6|o)}else{var s=(7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];s-=65536,t+=String.fromCharCode(55296+(s>>10&1023),56320+(1023&s))}}return t}(e);case"utf-16le":return function(e){for(var t="",n=0;n<e.length;n+=2)t+=String.fromCharCode(e[n]|e[n+1]<<8);return t}(e);case"ascii":return function(e){return String.fromCharCode.apply(String,A(e.map(function(e){return 127&e})))}(e);case"latin1":case"iso-8859-1":return function(e){return String.fromCharCode.apply(String,A(e))}(e);case"windows-1252":return function(e){var t,n="",r=P(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i>=128&&i<=159&&_c[i]?_c[i]:String.fromCharCode(i)}}catch(a){r.e(a)}finally{r.f()}return n}(e);default:throw new RangeError("Encoding '".concat(t,"' not supported"))}}function Fc(e){return new DataView(e.buffer,e.byteOffset)}var Ic={len:1,get:function(e,t){return Fc(e).getUint8(t)},put:function(e,t,n){return Fc(e).setUint8(t,n),t+1}},jc={len:2,get:function(e,t){return Fc(e).getUint16(t,!0)},put:function(e,t,n){return Fc(e).setUint16(t,n,!0),t+2}},Rc={len:2,get:function(e,t){return Fc(e).getUint16(t)},put:function(e,t,n){return Fc(e).setUint16(t,n),t+2}},Mc={len:4,get:function(e,t){return Fc(e).getUint32(t,!0)},put:function(e,t,n){return Fc(e).setUint32(t,n,!0),t+4}},Dc={len:4,get:function(e,t){return Fc(e).getUint32(t)},put:function(e,t,n){return Fc(e).setUint32(t,n),t+4}},Uc={len:4,get:function(e,t){return Fc(e).getInt32(t)},put:function(e,t,n){return Fc(e).setInt32(t,n),t+4}},Nc={len:8,get:function(e,t){return Fc(e).getBigUint64(t,!0)},put:function(e,t,n){return Fc(e).setBigUint64(t,n,!0),t+8}},Lc=function(){return h(function e(t,n){l(this,e),this.len=t,this.encoding=n},[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ac(e.subarray(t,t+this.len),this.encoding)}}])}(),zc=function(){function e(){var t;return l(this,e),(t=k(this,e,["End-Of-Stream"])).name="EndOfStreamError",t}return _(e,O(Error)),h(e)}(),qc=function(){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted";return l(this,e),(t=k(this,e,[n])).name="AbortError",t}return _(e,O(Error)),h(e)}(),Zc=function(){return h(function e(){l(this,e),this.endOfStream=!1,this.interrupted=!1,this.peekQueue=[]},[{key:"peek",value:function(){var e=u(s().m(function e(t){var n,r,i=arguments;return s().w(function(e){for(;;)switch(e.n){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],e.n=1,this.read(t,n);case 1:return r=e.v,this.peekQueue.push(t.subarray(0,r)),e.a(2,r)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=u(s().m(function e(t){var n,r,i,a=arguments;return s().w(function(e){for(;;)switch(e.n){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],0!==t.length){e.n=1;break}return e.a(2,0);case 1:if(r=this.readFromPeekBuffer(t),this.endOfStream){e.n=3;break}return i=r,e.n=2,this.readRemainderFromStream(t.subarray(r),n);case 2:r=i+=e.v;case 3:if(0!==r||n){e.n=4;break}throw new zc;case 4:return e.a(2,r)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"readFromPeekBuffer",value:function(e){for(var t=e.length,n=0;this.peekQueue.length>0&&t>0;){var r=this.peekQueue.pop();if(!r)throw new Error("peekData should be defined");var i=Math.min(r.length,t);e.set(r.subarray(0,i),n),n+=i,t-=i,i<r.length&&this.peekQueue.push(r.subarray(i))}return n}},{key:"readRemainderFromStream",value:function(){var e=u(s().m(function e(t,n){var r,i;return s().w(function(e){for(;;)switch(e.n){case 0:r=0;case 1:if(!(r<t.length)||this.endOfStream){e.n=5;break}if(!this.interrupted){e.n=2;break}throw new qc;case 2:return e.n=3,this.readFromStream(t.subarray(r),n);case 3:if(0!==(i=e.v)){e.n=4;break}return e.a(3,5);case 4:r+=i,e.n=1;break;case 5:if(n||!(r<t.length)){e.n=6;break}throw new zc;case 6:return e.a(2,r)}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}])}(),Bc=function(){function e(t){var n;return l(this,e),(n=k(this,e)).reader=t,n}return _(e,Zc),h(e,[{key:"abort",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.close())},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:this.reader.releaseLock();case 1:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}(),Wc=function(){function e(){return l(this,e),k(this,e,arguments)}return _(e,Bc),h(e,[{key:"readFromStream",value:function(){var e=u(s().m(function e(t,n){var r;return s().w(function(e){for(;;)switch(e.n){case 0:if(0!==t.length){e.n=1;break}return e.a(2,0);case 1:return e.n=2,this.reader.read(new Uint8Array(t.length),{min:n?void 0:t.length});case 2:if((r=e.v).done&&(this.endOfStream=r.done),!r.value){e.n=3;break}return t.set(r.value),e.a(2,r.value.length);case 3:return e.a(2,0)}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}])}(),Gc=function(){function e(t){var n;return l(this,e),(n=k(this,e)).reader=t,n.buffer=null,n}return _(e,Zc),h(e,[{key:"writeChunk",value:function(e,t){var n=Math.min(t.length,e.length);return e.set(t.subarray(0,n)),n<t.length?this.buffer=t.subarray(n):this.buffer=null,n}},{key:"readFromStream",value:function(){var e=u(s().m(function e(t,n){var r,i;return s().w(function(e){for(;;)switch(e.n){case 0:if(0!==t.length){e.n=1;break}return e.a(2,0);case 1:r=0,this.buffer&&(r+=this.writeChunk(t,this.buffer));case 2:if(!(r<t.length)||this.endOfStream){e.n=5;break}return e.n=3,this.reader.read();case 3:if(!(i=e.v).done){e.n=4;break}return this.endOfStream=!0,e.a(3,5);case 4:i.value&&(r+=this.writeChunk(t.subarray(r),i.value)),e.n=2;break;case 5:if(n||0!==r||!this.endOfStream){e.n=6;break}throw new zc;case 6:return e.a(2,r)}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"abort",value:function(){return this.interrupted=!0,this.reader.cancel()}},{key:"close",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.abort();case 1:this.reader.releaseLock();case 2:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}();var Hc=function(){return h(function e(t){var n=this;l(this,e),this.numBuffer=new Uint8Array(8),this.position=0,this.onClose=null===t||void 0===t?void 0:t.onClose,null!==t&&void 0!==t&&t.abortSignal&&t.abortSignal.addEventListener("abort",function(){n.abort()})},[{key:"readToken",value:function(){var e=u(s().m(function e(t){var n,r,i=arguments;return s().w(function(e){for(;;)switch(e.n){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:this.position,r=new Uint8Array(t.len),e.n=1,this.readBuffer(r,{position:n});case 1:if(!(e.v<t.len)){e.n=2;break}throw new zc;case 2:return e.a(2,t.get(r,0))}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"peekToken",value:function(){var e=u(s().m(function e(t){var n,r,i=arguments;return s().w(function(e){for(;;)switch(e.n){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:this.position,r=new Uint8Array(t.len),e.n=1,this.peekBuffer(r,{position:n});case 1:if(!(e.v<t.len)){e.n=2;break}throw new zc;case 2:return e.a(2,t.get(r,0))}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"readNumber",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.readBuffer(this.numBuffer,{length:t.len});case 1:if(!(e.v<t.len)){e.n=2;break}throw new zc;case 2:return e.a(2,t.get(this.numBuffer,0))}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"peekNumber",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.peekBuffer(this.numBuffer,{length:t.len});case 1:if(!(e.v<t.len)){e.n=2;break}throw new zc;case 2:return e.a(2,t.get(this.numBuffer,0))}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"ignore",value:function(){var e=u(s().m(function e(t){var n;return s().w(function(e){for(;;)switch(e.n){case 0:if(void 0===this.fileInfo.size){e.n=1;break}if(n=this.fileInfo.size-this.position,!(t>n)){e.n=1;break}return this.position+=n,e.a(2,n);case 1:return this.position+=t,e.a(2,t)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=u(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.abort();case 1:return e.n=2,null===(t=this.onClose)||void 0===t?void 0:t.call(this);case 2:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"normalizeOptions",value:function(e,t){if(!this.supportsRandomAccess()&&t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return g(g({},{mayBeLess:!1,offset:0,length:e.length,position:this.position}),t)}},{key:"abort",value:function(){return Promise.resolve()}}])}(),$c=function(){function e(t,n){var r,i;return l(this,e),(i=k(this,e,[n])).streamReader=t,i.fileInfo=null!==(r=null===n||void 0===n?void 0:n.fileInfo)&&void 0!==r?r:{},i}return _(e,Hc),h(e,[{key:"readBuffer",value:function(){var e=u(s().m(function e(t,n){var r,i,a;return s().w(function(e){for(;;)switch(e.n){case 0:if(r=this.normalizeOptions(t,n),!((i=r.position-this.position)>0)){e.n=2;break}return e.n=1,this.ignore(i);case 1:return e.a(2,this.readBuffer(t,n));case 2:if(!(i<0)){e.n=3;break}throw new Error("`options.position` must be equal or greater than `tokenizer.position`");case 3:if(0!==r.length){e.n=4;break}return e.a(2,0);case 4:return e.n=5,this.streamReader.read(t.subarray(0,r.length),r.mayBeLess);case 5:if(a=e.v,this.position+=a,n&&n.mayBeLess||!(a<r.length)){e.n=6;break}throw new zc;case 6:return e.a(2,a)}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"peekBuffer",value:function(){var e=u(s().m(function e(t,n){var r,i,a,o,c;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=this.normalizeOptions(t,n),i=0,!r.position){e.n=3;break}if(!((a=r.position-this.position)>0)){e.n=2;break}return o=new Uint8Array(r.length+a),e.n=1,this.peekBuffer(o,{mayBeLess:r.mayBeLess});case 1:return i=e.v,t.set(o.subarray(a)),e.a(2,i-a);case 2:if(!(a<0)){e.n=3;break}throw new Error("Cannot peek from a negative offset in a stream");case 3:if(!(r.length>0)){e.n=9;break}return e.p=4,e.n=5,this.streamReader.peek(t.subarray(0,r.length),r.mayBeLess);case 5:i=e.v,e.n=8;break;case 6:if(e.p=6,c=e.v,!(null!==n&&void 0!==n&&n.mayBeLess&&c instanceof zc)){e.n=7;break}return e.a(2,0);case 7:throw c;case 8:if(r.mayBeLess||!(i<r.length)){e.n=9;break}throw new zc;case 9:return e.a(2,i)}},e,this,[[4,6]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"ignore",value:function(){var e=u(s().m(function e(t){var n,r,i,a,o;return s().w(function(e){for(;;)switch(e.n){case 0:n=Math.min(256e3,t),r=new Uint8Array(n),i=0;case 1:if(!(i<t)){e.n=4;break}return a=t-i,e.n=2,this.readBuffer(r,{length:Math.min(n,a)});case 2:if(!((o=e.v)<0)){e.n=3;break}return e.a(2,o);case 3:i+=o,e.n=1;break;case 4:return e.a(2,i)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"abort",value:function(){return this.streamReader.abort()}},{key:"close",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.streamReader.close())},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"supportsRandomAccess",value:function(){return!1}}])}();function Vc(){return Vc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Vc.apply(null,arguments)}var Kc=function(){function e(t,n){var r,i;return l(this,e),(i=k(this,e,[n])).uint8Array=t,i.fileInfo=g(g({},null!==(r=null===n||void 0===n?void 0:n.fileInfo)&&void 0!==r?r:{}),{size:t.length}),i}return _(e,Hc),h(e,[{key:"readBuffer",value:function(){var e=u(s().m(function e(t,n){var r;return s().w(function(e){for(;;)switch(e.n){case 0:return null!==n&&void 0!==n&&n.position&&(this.position=n.position),e.n=1,this.peekBuffer(t,n);case 1:return r=e.v,this.position+=r,e.a(2,r)}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"peekBuffer",value:function(){var e=u(s().m(function e(t,n){var r,i;return s().w(function(e){for(;;)switch(e.n){case 0:if(r=this.normalizeOptions(t,n),i=Math.min(this.uint8Array.length-r.position,r.length),r.mayBeLess||!(i<r.length)){e.n=1;break}throw new zc;case 1:return t.set(this.uint8Array.subarray(r.position,r.position+i)),e.a(2,i)}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"close",value:function(){return function(e,t,n,r){var i=Vc(y(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof i?function(e){return i.apply(n,e)}:i}(e,"close",this,3)([])}},{key:"supportsRandomAccess",value:function(){return!0}},{key:"setPosition",value:function(e){this.position=e}}])}();function Qc(e,t){var n=function(e){try{var t=e.getReader({mode:"byob"});return t instanceof ReadableStreamDefaultReader?new Gc(t):new Wc(t)}catch(n){if(n instanceof TypeError)return new Gc(e.getReader());throw n}}(e),r=null!==t&&void 0!==t?t:{},i=r.onClose;return r.onClose=u(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n.close();case 1:if(!i){e.n=2;break}return e.a(2,i());case 2:return e.a(2)}},e)})),new $c(n,r)}function Jc(e,t){return new Kc(e,t)}var Yc=(0,e(import.meta.url)("module").createRequire)("/");try{Yc("worker_threads").Worker}catch(Zl){}var Xc=Uint8Array,eu=Uint16Array,tu=Int32Array,nu=new Xc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ru=new Xc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),iu=new Xc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),au=function(e,t){for(var n=new eu(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new tu(n[30]);for(r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},ou=au(nu,2),su=ou.b,cu=ou.r;su[28]=258,cu[258]=28;for(var uu=au(ru,0),lu=uu.b,fu=(uu.r,new eu(32768)),du=0;du<32768;++du){var pu=(43690&du)>>1|(21845&du)<<1;pu=(61680&(pu=(52428&pu)>>2|(13107&pu)<<2))>>4|(3855&pu)<<4,fu[du]=((65280&pu)>>8|(255&pu)<<8)>>1}var hu=function(e,t,n){for(var r=e.length,i=0,a=new eu(t);i<r;++i)e[i]&&++a[e[i]-1];var o,s=new eu(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;if(n){o=new eu(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],l=t-e[i],f=s[e[i]-1]++<<l,d=f|(1<<l)-1;f<=d;++f)o[fu[f]>>c]=u}else for(o=new eu(r),i=0;i<r;++i)e[i]&&(o[i]=fu[s[e[i]-1]++]>>15-e[i]);return o},mu=new Xc(288);for(du=0;du<144;++du)mu[du]=8;for(du=144;du<256;++du)mu[du]=9;for(du=256;du<280;++du)mu[du]=7;for(du=280;du<288;++du)mu[du]=8;var vu=new Xc(32);for(du=0;du<32;++du)vu[du]=5;var gu=hu(mu,9,1),yu=hu(vu,5,1),wu=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},bu=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},ku=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},xu=function(e){return(e+7)/8|0},_u=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new Xc(e.subarray(t,n))},Su=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Cu=function(e,t,n){var r=new Error(t||Su[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Cu),!n)throw r;return r},Eu=function(e,t,n,r){var i=e.length,a=r?r.length:0;if(!i||t.f&&!t.l)return n||new Xc(0);var o=!n,s=o||2!=t.i,c=t.i;o&&(n=new Xc(3*i));var u=function(e){var t=n.length;if(e>t){var r=new Xc(Math.max(2*t,e));r.set(n),n=r}},l=t.f||0,f=t.p||0,d=t.b||0,p=t.l,h=t.d,m=t.m,v=t.n,g=8*i;do{if(!p){l=bu(e,f,1);var y=bu(e,f+1,3);if(f+=3,!y){var w=e[(A=xu(f)+4)-4]|e[A-3]<<8,b=A+w;if(b>i){c&&Cu(0);break}s&&u(d+w),n.set(e.subarray(A,b),d),t.b=d+=w,t.p=f=8*b,t.f=l;continue}if(1==y)p=gu,h=yu,m=9,v=5;else if(2==y){var k=bu(e,f,31)+257,x=bu(e,f+10,15)+4,_=k+bu(e,f+5,31)+1;f+=14;for(var S=new Xc(_),C=new Xc(19),E=0;E<x;++E)C[iu[E]]=bu(e,f+3*E,7);f+=3*x;var T=wu(C),P=(1<<T)-1,O=hu(C,T,1);for(E=0;E<_;){var A,F=O[bu(e,f,P)];if(f+=15&F,(A=F>>4)<16)S[E++]=A;else{var I=0,j=0;for(16==A?(j=3+bu(e,f,3),f+=2,I=S[E-1]):17==A?(j=3+bu(e,f,7),f+=3):18==A&&(j=11+bu(e,f,127),f+=7);j--;)S[E++]=I}}var R=S.subarray(0,k),M=S.subarray(k);m=wu(R),v=wu(M),p=hu(R,m,1),h=hu(M,v,1)}else Cu(1);if(f>g){c&&Cu(0);break}}s&&u(d+131072);for(var D=(1<<m)-1,U=(1<<v)-1,N=f;;N=f){var L=(I=p[ku(e,f)&D])>>4;if((f+=15&I)>g){c&&Cu(0);break}if(I||Cu(2),L<256)n[d++]=L;else{if(256==L){N=f,p=null;break}var z=L-254;if(L>264){var q=nu[E=L-257];z=bu(e,f,(1<<q)-1)+su[E],f+=q}var Z=h[ku(e,f)&U],B=Z>>4;Z||Cu(3),f+=15&Z;M=lu[B];if(B>3){q=ru[B];M+=ku(e,f)&(1<<q)-1,f+=q}if(f>g){c&&Cu(0);break}s&&u(d+131072);var W=d+z;if(d<M){var G=a-M,H=Math.min(M,W);for(G+d<0&&Cu(3);d<H;++d)n[d]=r[G+d]}for(;d<W;++d)n[d]=n[d-M]}}t.l=p,t.p=N,t.b=d,t.f=l,p&&(l=1,t.m=m,t.d=h,t.n=v)}while(!l);return d!=n.length&&o?_u(n,0,d):n.subarray(0,d)},Tu=new Xc(0),Pu=function(e){31==e[0]&&139==e[1]&&8==e[2]||Cu(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=2+(e[10]|e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},Ou=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Au=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Cu(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Cu(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function Fu(e,t){return Eu(e,{i:2},t&&t.out,t&&t.dictionary)}function Iu(e,t){var n=Pu(e);return n+8>e.length&&Cu(6,"invalid gzip data"),Eu(e.subarray(n,-8),{i:2},t&&t.out||new Xc(Ou(e)),t&&t.dictionary)}function ju(e,t){return Eu(e.subarray(Au(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var Ru="undefined"!=typeof TextDecoder&&new TextDecoder;try{Ru.decode(Tu,{stream:!0})}catch(Zl){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var Mu=a(957),Du=67324752,Uu=134695760,Nu=33639248,Lu=101010256,zu={get:function(e){jc.get(e,6);return{signature:Mc.get(e,0),compressedSize:Mc.get(e,8),uncompressedSize:Mc.get(e,12)}},len:16},qu={get:function(e){var t=jc.get(e,6);return{signature:Mc.get(e,0),minVersion:jc.get(e,4),dataDescriptor:!!(8&t),compressedMethod:jc.get(e,8),compressedSize:Mc.get(e,18),uncompressedSize:Mc.get(e,22),filenameLength:jc.get(e,26),extraFieldLength:jc.get(e,28),filename:null}},len:30},Zu={get:function(e){return{signature:Mc.get(e,0),nrOfThisDisk:jc.get(e,4),nrOfThisDiskWithTheStart:jc.get(e,6),nrOfEntriesOnThisDisk:jc.get(e,8),nrOfEntriesOfSize:jc.get(e,10),sizeOfCd:Mc.get(e,12),offsetOfStartOfCd:Mc.get(e,16),zipFileCommentLength:jc.get(e,20)}},len:22},Bu={get:function(e){var t=jc.get(e,8);return{signature:Mc.get(e,0),minVersion:jc.get(e,6),dataDescriptor:!!(8&t),compressedMethod:jc.get(e,10),compressedSize:Mc.get(e,20),uncompressedSize:Mc.get(e,24),filenameLength:jc.get(e,28),extraFieldLength:jc.get(e,30),fileCommentLength:jc.get(e,32),relativeOffsetOfLocalHeader:Mc.get(e,42),filename:null}},len:46};function Wu(e){var t=new Uint8Array(Mc.len);return Mc.put(t,0,e),t}var Gu=Mu("tokenizer:inflate"),Hu=262144,$u=Wu(Uu),Vu=Wu(Lu),Ku=function(){return h(function e(t){l(this,e),this.tokenizer=t,this.syncBuffer=new Uint8Array(Hu)},[{key:"isZip",value:function(){var e=u(s().m(function e(){var t,n;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.peekSignature();case 1:return t=e.v,n=Du,e.a(2,t===n)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"peekSignature",value:function(){return this.tokenizer.peekToken(Mc)}},{key:"findEndOfCentralDirectoryLocator",value:function(){var e=u(s().m(function e(){var t,n,r,i;return s().w(function(e){for(;;)switch(e.n){case 0:return t=this.tokenizer,n=Math.min(16384,t.fileInfo.size),r=this.syncBuffer.subarray(0,n),e.n=1,this.tokenizer.readBuffer(r,{position:t.fileInfo.size-n});case 1:i=r.length-4;case 2:if(!(i>=0)){e.n=4;break}if(r[i]!==Vu[0]||r[i+1]!==Vu[1]||r[i+2]!==Vu[2]||r[i+3]!==Vu[3]){e.n=3;break}return e.a(2,t.fileInfo.size-n+i);case 3:i--,e.n=2;break;case 4:return e.a(2,-1)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"readCentralDirectory",value:function(){var e=u(s().m(function e(){var t,n,r,i,a,o;return s().w(function(e){for(;;)switch(e.n){case 0:if(this.tokenizer.supportsRandomAccess()){e.n=1;break}return Gu("Cannot reading central-directory without random-read support"),e.a(2);case 1:return Gu("Reading central-directory..."),t=this.tokenizer.position,e.n=2,this.findEndOfCentralDirectoryLocator();case 2:if(!((n=e.v)>0)){e.n=12;break}return Gu("Central-directory 32-bit signature found"),e.n=3,this.tokenizer.readToken(Zu,n);case 3:r=e.v,i=[],this.tokenizer.setPosition(r.offsetOfStartOfCd),a=0;case 4:if(!(a<r.nrOfEntriesOfSize)){e.n=11;break}return e.n=5,this.tokenizer.readToken(Bu);case 5:if((o=e.v).signature===Nu){e.n=6;break}throw new Error("Expected Central-File-Header signature");case 6:return e.n=7,this.tokenizer.readToken(new Lc(o.filenameLength,"utf-8"));case 7:return o.filename=e.v,e.n=8,this.tokenizer.ignore(o.extraFieldLength);case 8:return e.n=9,this.tokenizer.ignore(o.fileCommentLength);case 9:i.push(o),Gu("Add central-directory file-entry: n=".concat(a+1,"/").concat(i.length,": filename=").concat(i[a].filename));case 10:++a,e.n=4;break;case 11:return this.tokenizer.setPosition(t),e.a(2,i);case 12:this.tokenizer.setPosition(t);case 13:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"unzip",value:function(){var e=u(s().m(function e(t){var n,r,i,a,o,c,u,l,f,d;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.readCentralDirectory();case 1:if(!(n=e.v)){e.n=2;break}return e.a(2,this.iterateOverCentralDirectory(n,t));case 2:r=!1;case 3:return e.n=4,this.readLocalFileHeader();case 4:if(i=e.v){e.n=5;break}return e.a(3,21);case 5:return a=t(i),r=!!a.stop,o=void 0,e.n=6,this.tokenizer.ignore(i.extraFieldLength);case 6:if(!i.dataDescriptor||0!==i.compressedSize){e.n=14;break}c=[],u=Hu,Gu("Compressed-file-size unknown, scanning for next data-descriptor-signature...."),l=-1;case 7:if(!(l<0&&u===Hu)){e.n=12;break}return e.n=8,this.tokenizer.peekBuffer(this.syncBuffer,{mayBeLess:!0});case 8:if(u=e.v,l=Qu(this.syncBuffer.subarray(0,u),$u),f=l>=0?l:u,!a.handler){e.n=10;break}return d=new Uint8Array(f),e.n=9,this.tokenizer.readBuffer(d);case 9:c.push(d),e.n=11;break;case 10:return e.n=11,this.tokenizer.ignore(f);case 11:e.n=7;break;case 12:if(Gu("Found data-descriptor-signature at pos=".concat(this.tokenizer.position)),!a.handler){e.n=13;break}return e.n=13,this.inflate(i,Ju(c),a.handler);case 13:e.n=18;break;case 14:if(!a.handler){e.n=17;break}return Gu("Reading compressed-file-data: ".concat(i.compressedSize," bytes")),o=new Uint8Array(i.compressedSize),e.n=15,this.tokenizer.readBuffer(o);case 15:return e.n=16,this.inflate(i,o,a.handler);case 16:e.n=18;break;case 17:return Gu("Ignoring compressed-file-data: ".concat(i.compressedSize," bytes")),e.n=18,this.tokenizer.ignore(i.compressedSize);case 18:if(Gu("Reading data-descriptor at pos=".concat(this.tokenizer.position)),!i.dataDescriptor){e.n=20;break}return e.n=19,this.tokenizer.readToken(zu);case 19:if(134695760===e.v.signature){e.n=20;break}throw new Error("Expected data-descriptor-signature at position ".concat(this.tokenizer.position-zu.len));case 20:if(!r){e.n=3;break}case 21:return e.a(2)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"iterateOverCentralDirectory",value:function(){var e=u(s().m(function e(t,n){var r,i,a,o,c,u,l;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:r=P(t),e.p=1,r.s();case 2:if((i=r.n()).done){e.n=8;break}if(a=i.value,!(o=n(a)).handler){e.n=6;break}return this.tokenizer.setPosition(a.relativeOffsetOfLocalHeader),e.n=3,this.readLocalFileHeader();case 3:if(!(c=e.v)){e.n=6;break}return e.n=4,this.tokenizer.ignore(c.extraFieldLength);case 4:return u=new Uint8Array(a.compressedSize),e.n=5,this.tokenizer.readBuffer(u);case 5:return e.n=6,this.inflate(c,u,o.handler);case 6:if(!o.stop){e.n=7;break}return e.a(3,8);case 7:e.n=2;break;case 8:e.n=10;break;case 9:e.p=9,l=e.v,r.e(l);case 10:return e.p=10,r.f(),e.f(10);case 11:return e.a(2)}},e,this,[[1,9,10,11]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"inflate",value:function(e,t,n){return 0===e.compressedMethod?n(t):(Gu("Decompress filename=".concat(e.filename,", compressed-size=").concat(t.length)),n(31==(r=t)[0]&&139==r[1]&&8==r[2]?Iu(r,i):8!=(15&r[0])||r[0]>>4>7||(r[0]<<8|r[1])%31?Fu(r,i):ju(r,i)));var r,i}},{key:"readLocalFileHeader",value:function(){var e=u(s().m(function e(){var t,n;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.tokenizer.peekToken(Mc);case 1:if((t=e.v)!==Du){e.n=4;break}return e.n=2,this.tokenizer.readToken(qu);case 2:return n=e.v,e.n=3,this.tokenizer.readToken(new Lc(n.filenameLength,"utf-8"));case 3:return n.filename=e.v,e.a(2,n);case 4:if(t!==Nu){e.n=5;break}return e.a(2,!1);case 5:if(3759263696!==t){e.n=6;break}throw new Error("Encrypted ZIP");case 6:throw new Error("Unexpected signature");case 7:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}();function Qu(e,t){var n=e.length,r=t.length;if(r>n)return-1;for(var i=0;i<=n-r;i++){for(var a=!0,o=0;o<r;o++)if(e[i+o]!==t[o]){a=!1;break}if(a)return i}return-1}function Ju(e){var t,n=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(n),i=0,a=P(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;r.set(o,i),i+=o.length}}catch(s){a.e(s)}finally{a.f()}return r}Object.prototype.toString;new globalThis.TextDecoder("utf8");new globalThis.TextEncoder;Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function Yu(e){var t=e.byteLength;return 6===t?e.getUint16(0)*Math.pow(2,32)+e.getUint32(2):5===t?e.getUint8(0)*Math.pow(2,32)+e.getUint32(1):4===t?e.getUint32(0):3===t?e.getUint8(0)*Math.pow(2,16)+e.getUint16(1):2===t?e.getUint16(0):1===t?e.getUint8(0):void 0}function Xu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Number.parseInt(new Lc(6).get(e,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;for(var r=256,i=t;i<t+148;i++)r+=e[i];for(var a=t+156;a<t+512;a++)r+=e[a];return n===r}var el={get:function(e,t){return 127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21},len:4},tl=4100;function nl(e,t){return rl.apply(this,arguments)}function rl(){return(rl=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,new ol(n).fromBuffer(t))},e)}))).apply(this,arguments)}function il(e){switch(e=e.toLowerCase()){case"application/epub+zip":return{ext:"epub",mime:e};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:e};case"application/vnd.oasis.opendocument.text-template":return{ext:"ott",mime:e};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:e};case"application/vnd.oasis.opendocument.spreadsheet-template":return{ext:"ots",mime:e};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:e};case"application/vnd.oasis.opendocument.presentation-template":return{ext:"otp",mime:e};case"application/vnd.oasis.opendocument.graphics":return{ext:"odg",mime:e};case"application/vnd.oasis.opendocument.graphics-template":return{ext:"otg",mime:e};case"application/vnd.openxmlformats-officedocument.presentationml.slideshow":return{ext:"ppsx",mime:e};case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return{ext:"xlsx",mime:e};case"application/vnd.ms-excel.sheet.macroenabled":return{ext:"xlsm",mime:"application/vnd.ms-excel.sheet.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":return{ext:"xltx",mime:e};case"application/vnd.ms-excel.template.macroenabled":return{ext:"xltm",mime:"application/vnd.ms-excel.template.macroenabled.12"};case"application/vnd.ms-powerpoint.slideshow.macroenabled":return{ext:"ppsm",mime:"application/vnd.ms-powerpoint.slideshow.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return{ext:"docx",mime:e};case"application/vnd.ms-word.document.macroenabled":return{ext:"docm",mime:"application/vnd.ms-word.document.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":return{ext:"dotx",mime:e};case"application/vnd.ms-word.template.macroenabledtemplate":return{ext:"dotm",mime:"application/vnd.ms-word.template.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.presentationml.template":return{ext:"potx",mime:e};case"application/vnd.ms-powerpoint.template.macroenabled":return{ext:"potm",mime:"application/vnd.ms-powerpoint.template.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return{ext:"pptx",mime:e};case"application/vnd.ms-powerpoint.presentation.macroenabled":return{ext:"pptm",mime:"application/vnd.ms-powerpoint.presentation.macroenabled.12"};case"application/vnd.ms-visio.drawing":return{ext:"vsdx",mime:"application/vnd.visio"};case"application/vnd.ms-package.3dmanufacturing-3dmodel+xml":return{ext:"3mf",mime:"model/3mf"}}}function al(e,t,n){n=g({offset:0},n);var r,i=P(t.entries());try{for(i.s();!(r=i.n()).done;){var a=E(r.value,2),o=a[0],s=a[1];if(n.mask){if(s!==(n.mask[o]&e[o+n.offset]))return!1}else if(s!==e[o+n.offset])return!1}}catch(c){i.e(c)}finally{i.f()}return!0}var ol=function(){return h(function e(t){var n,r=this;l(this,e),m(this,"detectConfident",function(){var e=u(s().m(function e(t){var n,i,a,o,c,l,f,d,p,h,m,v,g,y,w,b,k,x,_,S,C,E,T,P,O,A;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return r.buffer=new Uint8Array(tl),void 0===t.fileInfo.size&&(t.fileInfo.size=Number.MAX_SAFE_INTEGER),r.tokenizer=t,e.n=1,t.peekBuffer(r.buffer,{length:12,mayBeLess:!0});case 1:if(!r.check([66,77])){e.n=2;break}return e.a(2,{ext:"bmp",mime:"image/bmp"});case 2:if(!r.check([11,119])){e.n=3;break}return e.a(2,{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"});case 3:if(!r.check([120,1])){e.n=4;break}return e.a(2,{ext:"dmg",mime:"application/x-apple-diskimage"});case 4:if(!r.check([77,90])){e.n=5;break}return e.a(2,{ext:"exe",mime:"application/x-msdownload"});case 5:if(!r.check([37,33])){e.n=8;break}return e.n=6,t.peekBuffer(r.buffer,{length:24,mayBeLess:!0});case 6:if(!r.checkString("PS-Adobe-",{offset:2})||!r.checkString(" EPSF-",{offset:14})){e.n=7;break}return e.a(2,{ext:"eps",mime:"application/eps"});case 7:return e.a(2,{ext:"ps",mime:"application/postscript"});case 8:if(!r.check([31,160])&&!r.check([31,157])){e.n=9;break}return e.a(2,{ext:"Z",mime:"application/x-compress"});case 9:if(!r.check([199,113])){e.n=10;break}return e.a(2,{ext:"cpio",mime:"application/x-cpio"});case 10:if(!r.check([96,234])){e.n=11;break}return e.a(2,{ext:"arj",mime:"application/x-arj"});case 11:if(!r.check([239,187,191])){e.n=12;break}return r.tokenizer.ignore(3),e.a(2,r.detectConfident(t));case 12:if(!r.check([71,73,70])){e.n=13;break}return e.a(2,{ext:"gif",mime:"image/gif"});case 13:if(!r.check([73,73,188])){e.n=14;break}return e.a(2,{ext:"jxr",mime:"image/vnd.ms-photo"});case 14:if(!r.check([31,139,8])){e.n=15;break}return e.a(2,{ext:"gz",mime:"application/gzip"});case 15:if(!r.check([66,90,104])){e.n=16;break}return e.a(2,{ext:"bz2",mime:"application/x-bzip2"});case 16:if(!r.checkString("ID3")){e.n=21;break}return e.n=17,t.ignore(6);case 17:return e.n=18,t.readToken(el);case 18:if(n=e.v,!(t.position+n>t.fileInfo.size)){e.n=19;break}return e.a(2,{ext:"mp3",mime:"audio/mpeg"});case 19:return e.n=20,t.ignore(n);case 20:return e.a(2,r.fromTokenizer(t));case 21:if(!r.checkString("MP+")){e.n=22;break}return e.a(2,{ext:"mpc",mime:"audio/x-musepack"});case 22:if(67!==r.buffer[0]&&70!==r.buffer[0]||!r.check([87,83],{offset:1})){e.n=23;break}return e.a(2,{ext:"swf",mime:"application/x-shockwave-flash"});case 23:if(!r.check([255,216,255])){e.n=25;break}if(!r.check([247],{offset:3})){e.n=24;break}return e.a(2,{ext:"jls",mime:"image/jls"});case 24:return e.a(2,{ext:"jpg",mime:"image/jpeg"});case 25:if(!r.check([79,98,106,1])){e.n=26;break}return e.a(2,{ext:"avro",mime:"application/avro"});case 26:if(!r.checkString("FLIF")){e.n=27;break}return e.a(2,{ext:"flif",mime:"image/flif"});case 27:if(!r.checkString("8BPS")){e.n=28;break}return e.a(2,{ext:"psd",mime:"image/vnd.adobe.photoshop"});case 28:if(!r.checkString("MPCK")){e.n=29;break}return e.a(2,{ext:"mpc",mime:"audio/x-musepack"});case 29:if(!r.checkString("FORM")){e.n=30;break}return e.a(2,{ext:"aif",mime:"audio/aiff"});case 30:if(!r.checkString("icns",{offset:0})){e.n=31;break}return e.a(2,{ext:"icns",mime:"image/icns"});case 31:if(!r.check([80,75,3,4])){e.n=33;break}return e.n=32,new Ku(t).unzip(function(e){switch(e.filename){case"META-INF/mozilla.rsa":return i={ext:"xpi",mime:"application/x-xpinstall"},{stop:!0};case"META-INF/MANIFEST.MF":return i={ext:"jar",mime:"application/java-archive"},{stop:!0};case"mimetype":return{handler:function(e){return u(s().m(function t(){var n;return s().w(function(t){for(;;)switch(t.n){case 0:n=new TextDecoder("utf-8").decode(e).trim(),i=il(n);case 1:return t.a(2)}},t)}))()},stop:!0};case"[Content_Types].xml":return{handler:function(e){return u(s().m(function t(){var n,r,a,o,c;return s().w(function(t){for(;;)switch(t.n){case 0:n=new TextDecoder("utf-8").decode(e),-1===(r=n.indexOf('.main+xml"'))?(a="application/vnd.ms-package.3dmanufacturing-3dmodel+xml",n.includes('ContentType="'.concat(a,'"'))&&(i=il(a))):(n=n.slice(0,Math.max(0,r)),o=n.lastIndexOf('"'),c=n.slice(Math.max(0,o+1)),i=il(c));case 1:return t.a(2)}},t)}))()},stop:!0};default:return/classes\d*\.dex/.test(e.filename)?(i={ext:"apk",mime:"application/vnd.android.package-archive"},{stop:!0}):{}}});case 32:return e.a(2,null!==i&&void 0!==i?i:{ext:"zip",mime:"application/zip"});case 33:if(!r.checkString("OggS")){e.n=42;break}return e.n=34,t.ignore(28);case 34:return a=new Uint8Array(8),e.n=35,t.readBuffer(a);case 35:if(!al(a,[79,112,117,115,72,101,97,100])){e.n=36;break}return e.a(2,{ext:"opus",mime:"audio/ogg; codecs=opus"});case 36:if(!al(a,[128,116,104,101,111,114,97])){e.n=37;break}return e.a(2,{ext:"ogv",mime:"video/ogg"});case 37:if(!al(a,[1,118,105,100,101,111,0])){e.n=38;break}return e.a(2,{ext:"ogm",mime:"video/ogg"});case 38:if(!al(a,[127,70,76,65,67])){e.n=39;break}return e.a(2,{ext:"oga",mime:"audio/ogg"});case 39:if(!al(a,[83,112,101,101,120,32,32])){e.n=40;break}return e.a(2,{ext:"spx",mime:"audio/ogg"});case 40:if(!al(a,[1,118,111,114,98,105,115])){e.n=41;break}return e.a(2,{ext:"ogg",mime:"audio/ogg"});case 41:return e.a(2,{ext:"ogx",mime:"application/ogg"});case 42:if(!r.check([80,75])||3!==r.buffer[2]&&5!==r.buffer[2]&&7!==r.buffer[2]||4!==r.buffer[3]&&6!==r.buffer[3]&&8!==r.buffer[3]){e.n=43;break}return e.a(2,{ext:"zip",mime:"application/zip"});case 43:if(!r.checkString("MThd")){e.n=44;break}return e.a(2,{ext:"mid",mime:"audio/midi"});case 44:if(!r.checkString("wOFF")||!r.check([0,1,0,0],{offset:4})&&!r.checkString("OTTO",{offset:4})){e.n=45;break}return e.a(2,{ext:"woff",mime:"font/woff"});case 45:if(!r.checkString("wOF2")||!r.check([0,1,0,0],{offset:4})&&!r.checkString("OTTO",{offset:4})){e.n=46;break}return e.a(2,{ext:"woff2",mime:"font/woff2"});case 46:if(!r.check([212,195,178,161])&&!r.check([161,178,195,212])){e.n=47;break}return e.a(2,{ext:"pcap",mime:"application/vnd.tcpdump.pcap"});case 47:if(!r.checkString("DSD ")){e.n=48;break}return e.a(2,{ext:"dsf",mime:"audio/x-dsf"});case 48:if(!r.checkString("LZIP")){e.n=49;break}return e.a(2,{ext:"lz",mime:"application/x-lzip"});case 49:if(!r.checkString("fLaC")){e.n=50;break}return e.a(2,{ext:"flac",mime:"audio/flac"});case 50:if(!r.check([66,80,71,251])){e.n=51;break}return e.a(2,{ext:"bpg",mime:"image/bpg"});case 51:if(!r.checkString("wvpk")){e.n=52;break}return e.a(2,{ext:"wv",mime:"audio/wavpack"});case 52:if(!r.checkString("%PDF")){e.n=53;break}return e.a(2,{ext:"pdf",mime:"application/pdf"});case 53:if(!r.check([0,97,115,109])){e.n=54;break}return e.a(2,{ext:"wasm",mime:"application/wasm"});case 54:if(!r.check([73,73])){e.n=56;break}return e.n=55,r.readTiffHeader(!1);case 55:if(!(o=e.v)){e.n=56;break}return e.a(2,o);case 56:if(!r.check([77,77])){e.n=58;break}return e.n=57,r.readTiffHeader(!0);case 57:if(!(c=e.v)){e.n=58;break}return e.a(2,c);case 58:if(!r.checkString("MAC ")){e.n=59;break}return e.a(2,{ext:"ape",mime:"audio/ape"});case 59:if(!r.check([26,69,223,163])){e.n=65;break}return l=function(){var e=u(s().m(function e(){var n,r,i,a;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.peekNumber(Ic);case 1:for(n=e.v,r=128,i=0;0===(n&r)&&0!==r;)++i,r>>=1;return a=new Uint8Array(i+1),e.n=2,t.readBuffer(a);case 2:return e.a(2,a)}},e)}));return function(){return e.apply(this,arguments)}}(),f=function(){var e=u(s().m(function e(){var t,n,r,i,a;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l();case 1:return t=e.v,e.n=2,l();case 2:return(n=e.v)[0]^=128>>n.length-1,r=Math.min(6,n.length),i=new DataView(t.buffer),a=new DataView(n.buffer,n.length-r,r),e.a(2,{id:Yu(i),len:Yu(a)})}},e)}));return function(){return e.apply(this,arguments)}}(),d=function(){var e=u(s().m(function e(n){var r,i;return s().w(function(e){for(;;)switch(e.n){case 0:if(!(n>0)){e.n=5;break}return e.n=1,f();case 1:if(17026!==(r=e.v).id){e.n=3;break}return e.n=2,t.readToken(new Lc(r.len));case 2:return i=e.v,e.a(2,i.replaceAll(/\00.*$/g,""));case 3:return e.n=4,t.ignore(r.len);case 4:--n,e.n=0;break;case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),e.n=60,f();case 60:return p=e.v,e.n=61,d(p.len);case 61:h=e.v,E=h,e.n="webm"===E?62:"matroska"===E?63:64;break;case 62:return e.a(2,{ext:"webm",mime:"video/webm"});case 63:return e.a(2,{ext:"mkv",mime:"video/matroska"});case 64:return e.a(2);case 65:if(!r.checkString("SQLi")){e.n=66;break}return e.a(2,{ext:"sqlite",mime:"application/x-sqlite3"});case 66:if(!r.check([78,69,83,26])){e.n=67;break}return e.a(2,{ext:"nes",mime:"application/x-nintendo-nes-rom"});case 67:if(!r.checkString("Cr24")){e.n=68;break}return e.a(2,{ext:"crx",mime:"application/x-google-chrome-extension"});case 68:if(!r.checkString("MSCF")&&!r.checkString("ISc(")){e.n=69;break}return e.a(2,{ext:"cab",mime:"application/vnd.ms-cab-compressed"});case 69:if(!r.check([237,171,238,219])){e.n=70;break}return e.a(2,{ext:"rpm",mime:"application/x-rpm"});case 70:if(!r.check([197,208,211,198])){e.n=71;break}return e.a(2,{ext:"eps",mime:"application/eps"});case 71:if(!r.check([40,181,47,253])){e.n=72;break}return e.a(2,{ext:"zst",mime:"application/zstd"});case 72:if(!r.check([127,69,76,70])){e.n=73;break}return e.a(2,{ext:"elf",mime:"application/x-elf"});case 73:if(!r.check([33,66,68,78])){e.n=74;break}return e.a(2,{ext:"pst",mime:"application/vnd.ms-outlook"});case 74:if(!r.checkString("PAR1")&&!r.checkString("PARE")){e.n=75;break}return e.a(2,{ext:"parquet",mime:"application/vnd.apache.parquet"});case 75:if(!r.checkString("ttcf")){e.n=76;break}return e.a(2,{ext:"ttc",mime:"font/collection"});case 76:if(!r.check([207,250,237,254])){e.n=77;break}return e.a(2,{ext:"macho",mime:"application/x-mach-binary"});case 77:if(!r.check([4,34,77,24])){e.n=78;break}return e.a(2,{ext:"lz4",mime:"application/x-lz4"});case 78:if(!r.check([79,84,84,79,0])){e.n=79;break}return e.a(2,{ext:"otf",mime:"font/otf"});case 79:if(!r.checkString("#!AMR")){e.n=80;break}return e.a(2,{ext:"amr",mime:"audio/amr"});case 80:if(!r.checkString("{\\rtf")){e.n=81;break}return e.a(2,{ext:"rtf",mime:"application/rtf"});case 81:if(!r.check([70,76,86,1])){e.n=82;break}return e.a(2,{ext:"flv",mime:"video/x-flv"});case 82:if(!r.checkString("IMPM")){e.n=83;break}return e.a(2,{ext:"it",mime:"audio/x-it"});case 83:if(!(r.checkString("-lh0-",{offset:2})||r.checkString("-lh1-",{offset:2})||r.checkString("-lh2-",{offset:2})||r.checkString("-lh3-",{offset:2})||r.checkString("-lh4-",{offset:2})||r.checkString("-lh5-",{offset:2})||r.checkString("-lh6-",{offset:2})||r.checkString("-lh7-",{offset:2})||r.checkString("-lzs-",{offset:2})||r.checkString("-lz4-",{offset:2})||r.checkString("-lz5-",{offset:2})||r.checkString("-lhd-",{offset:2}))){e.n=84;break}return e.a(2,{ext:"lzh",mime:"application/x-lzh-compressed"});case 84:if(!r.check([0,0,1,186])){e.n=86;break}if(!r.check([33],{offset:4,mask:[241]})){e.n=85;break}return e.a(2,{ext:"mpg",mime:"video/MP1S"});case 85:if(!r.check([68],{offset:4,mask:[196]})){e.n=86;break}return e.a(2,{ext:"mpg",mime:"video/MP2P"});case 86:if(!r.checkString("ITSF")){e.n=87;break}return e.a(2,{ext:"chm",mime:"application/vnd.ms-htmlhelp"});case 87:if(!r.check([202,254,186,190])){e.n=88;break}return e.a(2,{ext:"class",mime:"application/java-vm"});case 88:if(!r.checkString(".RMF")){e.n=89;break}return e.a(2,{ext:"rm",mime:"application/vnd.rn-realmedia"});case 89:if(!r.checkString("DRACO")){e.n=90;break}return e.a(2,{ext:"drc",mime:"application/vnd.google.draco"});case 90:if(!r.check([253,55,122,88,90,0])){e.n=91;break}return e.a(2,{ext:"xz",mime:"application/x-xz"});case 91:if(!r.checkString("<?xml ")){e.n=92;break}return e.a(2,{ext:"xml",mime:"application/xml"});case 92:if(!r.check([55,122,188,175,39,28])){e.n=93;break}return e.a(2,{ext:"7z",mime:"application/x-7z-compressed"});case 93:if(!r.check([82,97,114,33,26,7])||0!==r.buffer[6]&&1!==r.buffer[6]){e.n=94;break}return e.a(2,{ext:"rar",mime:"application/x-rar-compressed"});case 94:if(!r.checkString("solid ")){e.n=95;break}return e.a(2,{ext:"stl",mime:"model/stl"});case 95:if(!r.checkString("AC")){e.n=96;break}if(!((m=new Lc(4,"latin1").get(r.buffer,2)).match("^d*")&&m>=1e3&&m<=1050)){e.n=96;break}return e.a(2,{ext:"dwg",mime:"image/vnd.dwg"});case 96:if(!r.checkString("070707")){e.n=97;break}return e.a(2,{ext:"cpio",mime:"application/x-cpio"});case 97:if(!r.checkString("BLENDER")){e.n=98;break}return e.a(2,{ext:"blend",mime:"application/x-blender"});case 98:if(!r.checkString("!<arch>")){e.n=102;break}return e.n=99,t.ignore(8);case 99:return e.n=100,t.readToken(new Lc(13,"ascii"));case 100:if("debian-binary"!==e.v){e.n=101;break}return e.a(2,{ext:"deb",mime:"application/x-deb"});case 101:return e.a(2,{ext:"ar",mime:"application/x-unix-archive"});case 102:if(!r.checkString("WEBVTT")||!["\n","\r","\t"," ","\0"].some(function(e){return r.checkString(e,{offset:6})})){e.n=103;break}return e.a(2,{ext:"vtt",mime:"text/vtt"});case 103:if(!r.check([137,80,78,71,13,10,26,10])){e.n=112;break}return v=function(){var e=u(s().m(function e(){var n,r;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.readToken(Uc);case 1:return n=e.v,e.n=2,t.readToken(new Lc(4,"latin1"));case 2:return r=e.v,e.a(2,{length:n,type:r})}},e)}));return function(){return e.apply(this,arguments)}}(),e.n=104,t.ignore(8);case 104:return e.n=105,v();case 105:if(!((g=e.v).length<0)){e.n=106;break}return e.a(2);case 106:T=g.type,e.n="IDAT"===T?107:"acTL"===T?108:109;break;case 107:return e.a(2,{ext:"png",mime:"image/png"});case 108:return e.a(2,{ext:"apng",mime:"image/apng"});case 109:return e.n=110,t.ignore(g.length+4);case 110:if(t.position+8<t.fileInfo.size){e.n=104;break}case 111:return e.a(2,{ext:"png",mime:"image/png"});case 112:if(!r.check([65,82,82,79,87,49,0,0])){e.n=113;break}return e.a(2,{ext:"arrow",mime:"application/vnd.apache.arrow.file"});case 113:if(!r.check([103,108,84,70,2,0,0,0])){e.n=114;break}return e.a(2,{ext:"glb",mime:"model/gltf-binary"});case 114:if(!(r.check([102,114,101,101],{offset:4})||r.check([109,100,97,116],{offset:4})||r.check([109,111,111,118],{offset:4})||r.check([119,105,100,101],{offset:4}))){e.n=115;break}return e.a(2,{ext:"mov",mime:"video/quicktime"});case 115:if(!r.check([73,73,82,79,8,0,0,0,24])){e.n=116;break}return e.a(2,{ext:"orf",mime:"image/x-olympus-orf"});case 116:if(!r.checkString("gimp xcf ")){e.n=117;break}return e.a(2,{ext:"xcf",mime:"image/x-xcf"});case 117:if(!r.checkString("ftyp",{offset:4})||0===(96&r.buffer[8])){e.n=136;break}y=new Lc(4,"latin1").get(r.buffer,8).replace("\0"," ").trim(),P=y,e.n="avif"===P||"avis"===P?118:"mif1"===P?119:"msf1"===P?120:"heic"===P||"heix"===P?121:"hevc"===P||"hevx"===P?122:"qt"===P?123:"M4V"===P||"M4VH"===P||"M4VP"===P?124:"M4P"===P?125:"M4B"===P?126:"M4A"===P?127:"F4V"===P?128:"F4P"===P?129:"F4A"===P?130:"F4B"===P?131:"crx"===P?132:133;break;case 118:return e.a(2,{ext:"avif",mime:"image/avif"});case 119:return e.a(2,{ext:"heic",mime:"image/heif"});case 120:return e.a(2,{ext:"heic",mime:"image/heif-sequence"});case 121:return e.a(2,{ext:"heic",mime:"image/heic"});case 122:return e.a(2,{ext:"heic",mime:"image/heic-sequence"});case 123:return e.a(2,{ext:"mov",mime:"video/quicktime"});case 124:return e.a(2,{ext:"m4v",mime:"video/x-m4v"});case 125:return e.a(2,{ext:"m4p",mime:"video/mp4"});case 126:return e.a(2,{ext:"m4b",mime:"audio/mp4"});case 127:return e.a(2,{ext:"m4a",mime:"audio/x-m4a"});case 128:return e.a(2,{ext:"f4v",mime:"video/mp4"});case 129:return e.a(2,{ext:"f4p",mime:"video/mp4"});case 130:return e.a(2,{ext:"f4a",mime:"audio/mp4"});case 131:return e.a(2,{ext:"f4b",mime:"audio/mp4"});case 132:return e.a(2,{ext:"cr3",mime:"image/x-canon-cr3"});case 133:if(!y.startsWith("3g")){e.n=135;break}if(!y.startsWith("3g2")){e.n=134;break}return e.a(2,{ext:"3g2",mime:"video/3gpp2"});case 134:return e.a(2,{ext:"3gp",mime:"video/3gpp"});case 135:return e.a(2,{ext:"mp4",mime:"video/mp4"});case 136:if(!r.check([82,73,70,70])){e.n=140;break}if(!r.checkString("WEBP",{offset:8})){e.n=137;break}return e.a(2,{ext:"webp",mime:"image/webp"});case 137:if(!r.check([65,86,73],{offset:8})){e.n=138;break}return e.a(2,{ext:"avi",mime:"video/vnd.avi"});case 138:if(!r.check([87,65,86,69],{offset:8})){e.n=139;break}return e.a(2,{ext:"wav",mime:"audio/wav"});case 139:if(!r.check([81,76,67,77],{offset:8})){e.n=140;break}return e.a(2,{ext:"qcp",mime:"audio/qcelp"});case 140:if(!r.check([73,73,85,0,24,0,0,0,136,231,116,216])){e.n=141;break}return e.a(2,{ext:"rw2",mime:"image/x-panasonic-rw2"});case 141:if(!r.check([48,38,178,117,142,102,207,17,166,217])){e.n=150;break}return w=function(){var e=u(s().m(function e(){var n,r,i,a;return s().w(function(e){for(;;)switch(e.n){case 0:return n=new Uint8Array(16),e.n=1,t.readBuffer(n);case 1:return r=n,i=Number,e.n=2,t.readToken(Nc);case 2:return a=i(e.v),e.a(2,{id:r,size:a})}},e)}));return function(){return e.apply(this,arguments)}}(),e.n=142,t.ignore(30);case 142:if(!(t.position+24<t.fileInfo.size)){e.n=149;break}return e.n=143,w();case 143:if(b=e.v,k=b.size-24,!al(b.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){e.n=147;break}return x=new Uint8Array(16),O=k,e.n=144,t.readBuffer(x);case 144:if(k=O-=e.v,!al(x,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43])){e.n=145;break}return e.a(2,{ext:"asf",mime:"audio/x-ms-asf"});case 145:if(!al(x,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43])){e.n=146;break}return e.a(2,{ext:"asf",mime:"video/x-ms-asf"});case 146:return e.a(3,149);case 147:return e.n=148,t.ignore(k);case 148:e.n=142;break;case 149:return e.a(2,{ext:"asf",mime:"application/vnd.ms-asf"});case 150:if(!r.check([171,75,84,88,32,49,49,187,13,10,26,10])){e.n=151;break}return e.a(2,{ext:"ktx",mime:"image/ktx"});case 151:if(!r.check([126,16,4])&&!r.check([126,24,4])||!r.check([48,77,73,69],{offset:4})){e.n=152;break}return e.a(2,{ext:"mie",mime:"application/x-mie"});case 152:if(!r.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2})){e.n=153;break}return e.a(2,{ext:"shp",mime:"application/x-esri-shape"});case 153:if(!r.check([255,79,255,81])){e.n=154;break}return e.a(2,{ext:"j2c",mime:"image/j2c"});case 154:if(!r.check([0,0,0,12,106,80,32,32,13,10,135,10])){e.n=162;break}return e.n=155,t.ignore(20);case 155:return e.n=156,t.readToken(new Lc(4,"ascii"));case 156:_=e.v,A=_,e.n="jp2 "===A?157:"jpx "===A?158:"jpm "===A?159:"mjp2"===A?160:161;break;case 157:return e.a(2,{ext:"jp2",mime:"image/jp2"});case 158:return e.a(2,{ext:"jpx",mime:"image/jpx"});case 159:return e.a(2,{ext:"jpm",mime:"image/jpm"});case 160:return e.a(2,{ext:"mj2",mime:"image/mj2"});case 161:return e.a(2);case 162:if(!r.check([255,10])&&!r.check([0,0,0,12,74,88,76,32,13,10,135,10])){e.n=163;break}return e.a(2,{ext:"jxl",mime:"image/jxl"});case 163:if(!r.check([254,255])){e.n=165;break}if(!r.check([0,60,0,63,0,120,0,109,0,108],{offset:2})){e.n=164;break}return e.a(2,{ext:"xml",mime:"application/xml"});case 164:return e.a(2,void 0);case 165:if(!r.check([208,207,17,224,161,177,26,225])){e.n=166;break}return e.a(2,{ext:"cfb",mime:"application/x-cfb"});case 166:return e.n=167,t.peekBuffer(r.buffer,{length:Math.min(256,t.fileInfo.size),mayBeLess:!0});case 167:if(!r.check([97,99,115,112],{offset:36})){e.n=168;break}return e.a(2,{ext:"icc",mime:"application/vnd.iccprofile"});case 168:if(!r.checkString("**ACE",{offset:7})||!r.checkString("**",{offset:12})){e.n=169;break}return e.a(2,{ext:"ace",mime:"application/x-ace-compressed"});case 169:if(!r.checkString("BEGIN:")){e.n=171;break}if(!r.checkString("VCARD",{offset:6})){e.n=170;break}return e.a(2,{ext:"vcf",mime:"text/vcard"});case 170:if(!r.checkString("VCALENDAR",{offset:6})){e.n=171;break}return e.a(2,{ext:"ics",mime:"text/calendar"});case 171:if(!r.checkString("FUJIFILMCCD-RAW")){e.n=172;break}return e.a(2,{ext:"raf",mime:"image/x-fujifilm-raf"});case 172:if(!r.checkString("Extended Module:")){e.n=173;break}return e.a(2,{ext:"xm",mime:"audio/x-xm"});case 173:if(!r.checkString("Creative Voice File")){e.n=174;break}return e.a(2,{ext:"voc",mime:"audio/x-voc"});case 174:if(!(r.check([4,0,0,0])&&r.buffer.length>=16)){e.n=178;break}if(!((S=new DataView(r.buffer.buffer).getUint32(12,!0))>12&&r.buffer.length>=S+16)){e.n=178;break}if(e.p=175,C=(new TextDecoder).decode(r.buffer.subarray(16,S+16)),!JSON.parse(C).files){e.n=176;break}return e.a(2,{ext:"asar",mime:"application/x-asar"});case 176:e.n=178;break;case 177:e.p=177,e.v;case 178:if(!r.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2])){e.n=179;break}return e.a(2,{ext:"mxf",mime:"application/mxf"});case 179:if(!r.checkString("SCRM",{offset:44})){e.n=180;break}return e.a(2,{ext:"s3m",mime:"audio/x-s3m"});case 180:if(!r.check([71])||!r.check([71],{offset:188})){e.n=181;break}return e.a(2,{ext:"mts",mime:"video/mp2t"});case 181:if(!r.check([71],{offset:4})||!r.check([71],{offset:196})){e.n=182;break}return e.a(2,{ext:"mts",mime:"video/mp2t"});case 182:if(!r.check([66,79,79,75,77,79,66,73],{offset:60})){e.n=183;break}return e.a(2,{ext:"mobi",mime:"application/x-mobipocket-ebook"});case 183:if(!r.check([68,73,67,77],{offset:128})){e.n=184;break}return e.a(2,{ext:"dcm",mime:"application/dicom"});case 184:if(!r.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70])){e.n=185;break}return e.a(2,{ext:"lnk",mime:"application/x.ms.shortcut"});case 185:if(!r.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0])){e.n=186;break}return e.a(2,{ext:"alias",mime:"application/x.apple.alias"});case 186:if(!r.checkString("Kaydara FBX Binary  \0")){e.n=187;break}return e.a(2,{ext:"fbx",mime:"application/x.autodesk.fbx"});case 187:if(!r.check([76,80],{offset:34})||!(r.check([0,0,1],{offset:8})||r.check([1,0,2],{offset:8})||r.check([2,0,2],{offset:8}))){e.n=188;break}return e.a(2,{ext:"eot",mime:"application/vnd.ms-fontobject"});case 188:if(!r.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29])){e.n=189;break}return e.a(2,{ext:"indd",mime:"application/x-indesign"});case 189:return e.n=190,t.peekBuffer(r.buffer,{length:Math.min(512,t.fileInfo.size),mayBeLess:!0});case 190:if(!(r.checkString("ustar",{offset:257})&&(r.checkString("\0",{offset:262})||r.checkString(" ",{offset:262}))||r.check([0,0,0,0,0,0],{offset:257})&&Xu(r.buffer))){e.n=191;break}return e.a(2,{ext:"tar",mime:"application/x-tar"});case 191:if(!r.check([255,254])){e.n=194;break}if(!r.check([60,0,63,0,120,0,109,0,108,0],{offset:2})){e.n=192;break}return e.a(2,{ext:"xml",mime:"application/xml"});case 192:if(!r.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})){e.n=193;break}return e.a(2,{ext:"skp",mime:"application/vnd.sketchup.skp"});case 193:return e.a(2,void 0);case 194:if(!r.checkString("-----BEGIN PGP MESSAGE-----")){e.n=195;break}return e.a(2,{ext:"pgp",mime:"application/pgp-encrypted"});case 195:return e.a(2)}},e,null,[[175,177]])}));return function(t){return e.apply(this,arguments)}}()),m(this,"detectImprecise",function(){var e=u(s().m(function e(t){var n,i;return s().w(function(e){for(;;)switch(e.n){case 0:return r.buffer=new Uint8Array(tl),e.n=1,t.peekBuffer(r.buffer,{length:Math.min(8,t.fileInfo.size),mayBeLess:!0});case 1:if(!r.check([0,0,1,186])&&!r.check([0,0,1,179])){e.n=2;break}return e.a(2,{ext:"mpg",mime:"video/mpeg"});case 2:if(!r.check([0,1,0,0,0])){e.n=3;break}return e.a(2,{ext:"ttf",mime:"font/ttf"});case 3:if(!r.check([0,0,1,0])){e.n=4;break}return e.a(2,{ext:"ico",mime:"image/x-icon"});case 4:if(!r.check([0,0,2,0])){e.n=5;break}return e.a(2,{ext:"cur",mime:"image/x-icon"});case 5:return e.n=6,t.peekBuffer(r.buffer,{length:Math.min(2+r.options.mpegOffsetTolerance,t.fileInfo.size),mayBeLess:!0});case 6:if(!(r.buffer.length>=2+r.options.mpegOffsetTolerance)){e.n=9;break}n=0;case 7:if(!(n<=r.options.mpegOffsetTolerance)){e.n=9;break}if(!(i=r.scanMpeg(n))){e.n=8;break}return e.a(2,i);case 8:++n,e.n=7;break;case 9:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),this.options=g({mpegOffsetTolerance:0},t),this.detectors=[].concat(A(null!==(n=null===t||void 0===t?void 0:t.customDetectors)&&void 0!==n?n:[]),[{id:"core",detect:this.detectConfident},{id:"core.imprecise",detect:this.detectImprecise}]),this.tokenizerOptions={abortSignal:null===t||void 0===t?void 0:t.signal}},[{key:"fromTokenizer",value:function(){var e=u(s().m(function e(t){var n,r,i,a,o,c;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:n=t.position,r=P(this.detectors),e.p=1,r.s();case 2:if((i=r.n()).done){e.n=6;break}return a=i.value,e.n=3,a.detect(t);case 3:if(!(o=e.v)){e.n=4;break}return e.a(2,o);case 4:if(n===t.position){e.n=5;break}return e.a(2,void 0);case 5:e.n=2;break;case 6:e.n=8;break;case 7:e.p=7,c=e.v,r.e(c);case 8:return e.p=8,r.f(),e.f(8);case 9:return e.a(2)}},e,this,[[1,7,8,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:"fromBuffer",value:function(){var e=u(s().m(function e(t){var n;return s().w(function(e){for(;;)switch(e.n){case 0:if(t instanceof Uint8Array||t instanceof ArrayBuffer){e.n=1;break}throw new TypeError("Expected the `input` argument to be of type `Uint8Array` or `ArrayBuffer`, got `".concat(typeof t,"`"));case 1:if((null===(n=t instanceof Uint8Array?t:new Uint8Array(t))||void 0===n?void 0:n.length)>1){e.n=2;break}return e.a(2);case 2:return e.a(2,this.fromTokenizer(Jc(n,this.tokenizerOptions)))}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fromBlob",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,this.fromStream(t.stream()))},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fromStream",value:function(){var e=u(s().m(function e(t){var n;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,Qc(t,this.tokenizerOptions);case 1:return n=e.v,e.p=2,e.n=3,this.fromTokenizer(n);case 3:return e.a(2,e.v);case 4:return e.p=4,e.n=5,n.close();case 5:return e.f(4);case 6:return e.a(2)}},e,this,[[2,,4,6]])}));return function(t){return e.apply(this,arguments)}}()},{key:"toDetectionStream",value:function(){var e=u(s().m(function e(t,n){var r,i,a,o,c,l,f,d,p,h,m;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=n.sampleSize,i=void 0===r?tl:r,c=t.getReader({mode:"byob"}),e.p=1,e.n=2,c.read(new Uint8Array(i));case 2:if(l=e.v,f=l.value,d=l.done,o=f,d||!f){e.n=7;break}return e.p=3,e.n=4,this.fromBuffer(f.subarray(0,i));case 4:a=e.v,e.n=7;break;case 5:if(e.p=5,(m=e.v)instanceof zc){e.n=6;break}throw m;case 6:a=void 0;case 7:o=f;case 8:return e.p=8,c.releaseLock(),e.f(8);case 9:return p=new TransformStream({start:function(e){return u(s().m(function t(){return s().w(function(t){for(;;)switch(t.n){case 0:e.enqueue(o);case 1:return t.a(2)}},t)}))()},transform:function(e,t){t.enqueue(e)}}),(h=t.pipeThrough(p)).fileType=a,e.a(2,h)}},e,this,[[3,5],[1,,8,9]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"check",value:function(e,t){return al(this.buffer,e,t)}},{key:"checkString",value:function(e,t){return this.check(A(e).map(function(e){return e.charCodeAt(0)}),t)}},{key:"readTiffTag",value:function(){var e=u(s().m(function e(t){var n,r;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.tokenizer.readToken(t?Rc:jc);case 1:n=e.v,this.tokenizer.ignore(10),r=n,e.n=50341===r?2:50706===r?3:4;break;case 2:return e.a(2,{ext:"arw",mime:"image/x-sony-arw"});case 3:return e.a(2,{ext:"dng",mime:"image/x-adobe-dng"});case 4:return e.a(2)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"readTiffIFD",value:function(){var e=u(s().m(function e(t){var n,r,i;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.tokenizer.readToken(t?Rc:jc);case 1:n=e.v,r=0;case 2:if(!(r<n)){e.n=5;break}return e.n=3,this.readTiffTag(t);case 3:if(!(i=e.v)){e.n=4;break}return e.a(2,i);case 4:++r,e.n=2;break;case 5:return e.a(2)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"readTiffHeader",value:function(){var e=u(s().m(function e(t){var n,r,i,a,o;return s().w(function(e){for(;;)switch(e.n){case 0:if(n=(t?Rc:jc).get(this.buffer,2),r=(t?Dc:Mc).get(this.buffer,4),42!==n){e.n=5;break}if(!(r>=6)){e.n=2;break}if(!this.checkString("CR",{offset:8})){e.n=1;break}return e.a(2,{ext:"cr2",mime:"image/x-canon-cr2"});case 1:if(!(r>=8)){e.n=2;break}if(i=(t?Rc:jc).get(this.buffer,8),a=(t?Rc:jc).get(this.buffer,10),!(28===i&&254===a||31===i&&11===a)){e.n=2;break}return e.a(2,{ext:"nef",mime:"image/x-nikon-nef"});case 2:return e.n=3,this.tokenizer.ignore(r);case 3:return e.n=4,this.readTiffIFD(t);case 4:return o=e.v,e.a(2,null!==o&&void 0!==o?o:{ext:"tif",mime:"image/tiff"});case 5:if(43!==n){e.n=6;break}return e.a(2,{ext:"tif",mime:"image/tiff"});case 6:return e.a(2)}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"scanMpeg",value:function(e){if(this.check([255,224],{offset:e,mask:[255,224]})){if(this.check([16],{offset:e+1,mask:[22]}))return this.check([8],{offset:e+1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:e+1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:e+1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:e+1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}}])}();new Set(["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ttc","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx","vtt","apk","drc","lz4","potx","xltx","dotx","xltm","ott","ots","otp","odg","otg","xlsm","docm","dotm","potm","pptm","jar","rm","ppsm","ppsx"]),new Set(["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.ms-powerpoint.slideshow.macroenabled.12","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/vnd.apache.arrow.file","video/mp4","audio/midi","video/matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","video/ogg","audio/ogg","audio/ogg; codecs=opus","application/ogg","audio/flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","font/collection","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","text/vtt","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/vnd.apache.parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio","application/vnd.android.package-archive","application/vnd.google.draco","application/x-lz4","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-excel.template.macroenabled.12","application/vnd.oasis.opendocument.text-template","application/vnd.oasis.opendocument.spreadsheet-template","application/vnd.oasis.opendocument.presentation-template","application/vnd.oasis.opendocument.graphics","application/vnd.oasis.opendocument.graphics-template","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.ms-word.document.macroenabled.12","application/vnd.ms-word.template.macroenabled.12","application/vnd.ms-powerpoint.template.macroenabled.12","application/vnd.ms-powerpoint.presentation.macroenabled.12","application/java-archive","application/vnd.rn-realmedia"]);function sl(e,t,n){return cl.apply(this,arguments)}function cl(){return cl=u(s().m(function e(t,n,r){var i,a,o,c,l,f,d,p,h,m,v;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,i=t.imageSources,a=t.note,Mr.debug("Processing image group",{imageCount:i.length,imageSources:i,hasNote:!!a}),e.n=1,Promise.all(i.map(function(){var e=u(s().m(function e(t){var n,r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fl(t);case 1:return n=e.v,e.a(2,{content:n,source:t});case 2:throw e.p=2,r=e.v,Mr.error("Failed to load image",{imageSource:t,error:r}),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()));case 1:return o=e.v,c=n.replace("$ADDITIONAL_NOTES",a||""),l=new li(r),f=[].concat(A(o.map(function(e){var t=e.content;return{role:"user",content:{type:"image",data:t.data,mimeType:t.mimeType}}})),[{role:"user",content:{type:"text",text:c}}]),d={message:{modelPreferences:{hints:[{name:"claude"},{name:"gemini"},{name:"gpt"}]},messages:f,maxTokens:1e4}},Mr.trace("Sending image group to LLM for description",{imageSources:i,imageCount:i.length,promptLength:c.length,totalImageSize:o.reduce(function(e,t){return e+t.content.data.length},0),hasNote:!!a}),e.n=2,l.sample(d);case 2:if(!(p=e.v).success||"text"!==p.content.type){e.n=3;break}return Mr.debug("Image group description successful",{imageSources:i,descriptionLength:p.content.text.length}),e.a(2,{imageSources:i,success:!0,description:p.content.text.trim()});case 3:return h=p.error||"Failed to get description from LLM",Mr.warn("LLM failed to describe image group",{imageSources:i,error:h}),e.a(2,{imageSources:i,success:!1,error:h});case 4:e.n=6;break;case 5:return e.p=5,v=e.v,m=v instanceof Error?v.message:String(v),Mr.error("Image group processing failed",{imageSources:t.imageSources,error:m}),e.a(2,{imageSources:t.imageSources,success:!1,error:m});case 6:return e.a(2)}},e,null,[[0,5]])})),cl.apply(this,arguments)}function ul(e,t,n){return ll.apply(this,arguments)}function ll(){return ll=u(s().m(function e(t,n,r){var i;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Promise.allSettled(t.map(function(e){return sl(e,n,r)}));case 1:return i=e.v,e.a(2,i.map(function(e,n){var r=t[n];if("fulfilled"===e.status)return e.value;var i=e.reason instanceof Error?e.reason.message:String(e.reason);return Mr.error("Image group processing failed",{imageSources:r.imageSources,error:i}),{imageSources:r.imageSources,success:!1,error:i}}))}},e)})),ll.apply(this,arguments)}function fl(e){return dl.apply(this,arguments)}function dl(){return(dl=u(s().m(function e(t){return s().w(function(e){for(;;)switch(e.n){case 0:if(!xc(t)){e.n=2;break}return e.n=1,pl(t);case 1:case 3:return e.a(2,e.v);case 2:return e.n=3,ml(t);case 4:return e.a(2)}},e)}))).apply(this,arguments)}function pl(e){return hl.apply(this,arguments)}function hl(){return(hl=u(s().m(function e(t){var n,r,i,a,o,c,u,l;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return Mr.trace("Fetching image from URL",{url:t}),e.p=1,e.n=2,fetch(t);case 2:if((r=e.v).ok){e.n=3;break}throw new Error("HTTP ".concat(r.status,": ").concat(r.statusText));case 3:if((i=r.headers.get("content-type")||"").startsWith("image/")){e.n=4;break}throw new Error("Invalid content type: ".concat(i,". Expected image/*"));case 4:return e.n=5,r.arrayBuffer();case 5:return a=e.v,e.n=6,nl(a);case 6:return(o=e.v)&&o.mime.startsWith("image/")||Mr.warn("Warning: Content may not be a valid image. Detected MIME: ".concat((null===o||void 0===o?void 0:o.mime)||"unknown")),c=Buffer.from(a).toString("base64"),Mr.trace("Image fetched successfully from URL",{url:t,mimeType:o,dataSize:c.length}),e.a(2,{type:"image",data:c,mimeType:null!==(n=null===o||void 0===o?void 0:o.mime)&&void 0!==n?n:"image/png"});case 7:throw e.p=7,l=e.v,u=l instanceof Error?l.message:String(l),Mr.error("Failed to fetch image from URL",{url:t,error:u}),new Error("Failed to fetch image from URL ".concat(t,": ").concat(u));case 8:return e.a(2)}},e,null,[[1,7]])}))).apply(this,arguments)}function ml(e){return vl.apply(this,arguments)}function vl(){return(vl=u(s().m(function e(t){var n,r,i,a;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return Mr.trace("Reading image from file",{filePath:t}),e.p=1,e.n=2,Xo.validatePath(t);case 2:return n=e.v,e.n=3,Xo.readMediaFile(n);case 3:if("image"===(r=e.v).type){e.n=4;break}throw new Error("File is not an image: ".concat(r.type));case 4:return Mr.trace("Image read successfully from file",{filePath:t,mimeType:r.mimeType,dataSize:r.data.length}),e.a(2,{type:"image",data:r.data,mimeType:r.mimeType});case 5:throw e.p=5,a=e.v,i=a instanceof Error?a.message:String(a),Mr.error("Failed to read image from file",{filePath:t,error:i}),new Error("Failed to read image from file ".concat(t,": ").concat(i));case 6:return e.a(2)}},e,null,[[1,5]])}))).apply(this,arguments)}var gl=function(){return h(function e(t){l(this,e),m(this,"server",void 0),this.server=t},[{key:"processImage",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,sl(t,n,this.server))},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"processImages",value:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,ul(t,n,this.server))},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getImageContent",value:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,fl(t))},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"formatResults",value:function(e){return function(e){return e.map(function(e,t){var n=function(e){return{label:1===e.imageSources.length?"Image Source":"Image Sources",text:1===e.imageSources.length?e.imageSources[0]:e.imageSources.map(function(e,t){return"".concat(t+1,". ").concat(e)}).join("\n")}}(e),r=n.label,i=n.text;return"## Image Group ".concat(t+1,"\n\n*").concat(r,"*:\n").concat(i,"\n\n").concat(e.success&&e.description?"*Description*: ".concat(e.description):"*Error*: ".concat(e.error||"Unknown error"))}).join("\n\n")}(e)}}])}(),yl=tn.object({imageSources:tn.array(tn.string()).min(1).describe("Array of image URIs or URLs to describe together"),note:tn.string().optional().describe("Optional additional note about these images")}),wl=tn.object({imageContents:tn.array(yl).min(1).describe("Array of image groups, each containing multiple images and an optional shared note")}),bl={name:"describe_images",description:"Describe provided images from either local file URIs or remote URLs. Processes groups of images together, where each group contains multiple images that will be analyzed together in a single LLM call.",inputSchema:{type:"object",properties:{imageContents:{type:"array",items:{type:"object",properties:{imageSources:{type:"array",items:{type:"string",description:"Image URI (could be relative or absolute path) or URL to describe"},description:"Array of image URIs/URLs that will be processed together",minItems:1},note:{type:"string",description:"Optional additional note about these images to include in the analysis"}},required:["imageSources"],additionalProperties:!1},description:"Array of image groups, each containing multiple images and an optional shared note",minItems:1}},required:["imageContents"]}};function kl(e,t){return xl.apply(this,arguments)}function xl(){return xl=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d,p;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((r=wl.safeParse(t)).success){e.n=1;break}throw i=r.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(i),"args","describe_images");case 1:return a=r.data,o=a.imageContents,Mr.info("Starting image description process",{groupCount:o.length,totalImages:o.reduce(function(e,t){return e+t.imageSources.length},0),imageContents:o.map(function(e){return{imageCount:e.imageSources.length,imageSources:e.imageSources,hasNote:!!e.note}})}),e.p=2,e.n=3,rs();case 3:return c=e.v,u=new gl(n),e.n=4,u.processImages(o,c);case 4:return l=e.v,f=u.formatResults(l),Mr.info("Image description process completed",{totalGroups:o.length,totalImages:o.reduce(function(e,t){return e+t.imageSources.length},0),successCount:l.filter(function(e){return e.success}).length,failureCount:l.filter(function(e){return!e.success}).length}),e.a(2,{content:[{type:"text",text:f}]});case 5:return e.p=5,p=e.v,d=p instanceof Error?p.message:String(p),Mr.error("Image description process failed",{error:d,imageContents:o}),e.a(2,{isError:!0,content:[{type:"text",text:"Image description failed: ".concat(d)}]})}},e,null,[[2,5]])})),xl.apply(this,arguments)}var _l=Rr(),Sl=function(){var e=u(s().m(function e(){var t,n,r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!_l.convertImageTemplateUri){e.n=4;break}return e.p=1,Mr.debug("Loading convert image prompt from template URI",{templateUri:_l.convertImageTemplateUri}),e.n=2,Xo.readFileContent(_l.convertImageTemplateUri);case 2:return t=e.v,Mr.debug("Successfully loaded prompt template from URI",{TemplatePreview:t.slice(0,100)+"..."+t.slice(-100)}),e.a(2,t);case 3:return e.p=3,r=e.v,n=r instanceof Error?r.message:String(r),Mr.warn("Error loading prompt template from URI, using default",{templateUri:_l.convertImageTemplateUri,error:n}),e.a(2,Cl);case 4:return e.a(2,Cl)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),Cl="\nYou are an expert UI component converter. Your task is to analyze UI component images and generate HTML code that recreates the component with all its states.\n\n<goal>\nAnalyze the provided UI component images (showing different states like normal, hover, pressed, etc.) and generate a single HTML file containing:\n- Complete HTML structure with inline CSS\n- Interactive functionality to demonstrate all component states\n- Accurate visual recreation of the component appearance\n- Proper styling for all states shown in the images\n</goal>\n\n<guidelines>\n- Create a single, complete HTML file that can be opened in any browser\n- Use inline CSS for all styling - no external dependencies\n- Include JavaScript for interactive states (hover, click, focus, etc.)\n- Match the visual design as closely as possible (colors, fonts, sizes, spacing)\n- Ensure the component is responsive and accessible\n- Include proper HTML semantics (buttons should use <button>, inputs should use <input>, etc.)\n- Add smooth transitions between states for better user experience\n- If multiple components are shown, create separate sections for each\n- Use modern CSS features (flexbox, grid, CSS variables) when appropriate\n</guidelines>\n\n<format>\nGenerate a complete HTML document with:\n1. DOCTYPE declaration and proper HTML structure\n2. All CSS styles in a <style> tag in the <head>\n3. The component(s) in the <body>\n4. Any necessary JavaScript in a <script> tag\n5. Clean, well-commented code\n</format>\n\n<important-notes>\n$ADDITIONAL_NOTES\n</important-notes>\n",El=tn.object({imageSources:tn.array(tn.string()).min(1).describe("Array of image URIs or URLs showing different states of a single UI component (e.g., button in normal, hover, pressed states)"),note:tn.string().optional().describe("Optional additional note about this UI component and its states")}),Tl=tn.object({imageContents:tn.array(El).min(1).describe("Array of UI component groups, each containing multiple images showing different states of a single component (e.g., button states)"),output_folder:tn.string().optional().describe("Optional output folder path. If not provided, files will be saved in the same folder as input images"),output_format:tn.string().optional().default("html").describe("Output format for the converted files. Defaults to html")}),Pl={name:"convert_images",description:"Convert UI component images into HTML files. Each image group should represent a single UI component or element (like a button) showing all its different states (normal, hover, pressed, etc.). Do not mix different types of components in the same group. Generates HTML files with the component analysis. Returns the path of the generated output file.",inputSchema:{type:"object",properties:{imageContents:{type:"array",items:{type:"object",properties:{imageSources:{type:"array",items:{type:"string",description:"Image URI (could be relative or absolute path) or URL showing different states of a single UI component"},description:"Array of image URIs/URLs showing different states of a single UI component (e.g., button in normal, hover, pressed states)",minItems:1},note:{type:"string",description:"Optional additional note about this UI component and its states"}},required:["imageSources"],additionalProperties:!1},description:"Array of UI component groups, each containing multiple images showing different states of a single component",minItems:1},output_folder:{type:"string",description:"Optional output folder path. If not provided, files will be saved in the same folder as input images"},output_format:{type:"string",description:"Output format for the converted files. Defaults to html",default:"html"}},required:["imageContents"]}};function Ol(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"html",r=e[0],i=pi.basename(r,pi.extname(r)),a="".concat(i,".").concat(n);if(t)return pi.join(t,a);var o=pi.dirname(r);return pi.join(o,a)}function Al(e,t){if(e.success){var n=e.description||"No content available";if("html"===t){var r=n.match(/<html[\s\S]*?<\/html>/i);if(r)return r[0]}return n}return"Error: ".concat(e.error||"Unknown error occurred")}function Fl(e,t){return Il.apply(this,arguments)}function Il(){return Il=u(s().m(function e(t,n){var r,i,a,o,c,u,l,f,d,p,h,m,v,g,y,w,b,k,x,_,S,C,E,T,P,O,A;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if((r=Tl.safeParse(t)).success){e.n=1;break}throw i=r.error.errors.map(function(e){return"".concat(e.path.join("."),": ").concat(e.message)}).join(", "),new Ur("Validation failed: ".concat(i),"args","convert_images");case 1:return a=r.data,o=a.imageContents,c=a.output_folder,u=a.output_format,Mr.info("Starting image conversion process",{groupCount:o.length,totalImages:o.reduce(function(e,t){return e+t.imageSources.length},0),outputFolder:c,outputFormat:u,imageContents:o.map(function(e){return{imageCount:e.imageSources.length,imageSources:e.imageSources,hasNote:!!e.note}})}),e.p=2,e.n=3,Sl();case 3:return l=e.v,f=new gl(n),e.n=4,f.processImages(o,l);case 4:d=e.v,p=[],h=[],m=0;case 5:if(!(m<d.length)){e.n=17;break}return v=d[m],g=o[m],e.p=6,y=Ol(g.imageSources,c,u),e.n=7,Xo.validatePath(y);case 7:return w=e.v,b=pi.dirname(w),e.p=8,e.n=9,Xo.getFileStats(b);case 9:if(e.v.isDirectory){e.n=10;break}throw new Error("Output path exists but is not a directory: ".concat(b));case 10:Mr.debug("Output directory already exists",{outputDir:b}),e.n=13;break;case 11:return e.p=11,P=e.v,Mr.debug("Creating output directory",{outputDir:b,error:P}),e.n=12,Xo.createDirectory(b);case 12:Mr.info("Created output directory",{outputDir:b});case 13:return k=Al(v,u),e.n=14,Xo.writeFileContent(w,k);case 14:p.push(w),Mr.info("Successfully wrote converted file",{outputPath:w,imageCount:g.imageSources.length,success:v.success}),e.n=16;break;case 15:e.p=15,O=e.v,x=O instanceof Error?O.message:String(O),_="Failed to write group ".concat(m,": ").concat(x),h.push(_),Mr.error("Failed to write converted file",{groupIndex:m,error:x,imageSources:g.imageSources});case 16:m++,e.n=5;break;case 17:return Mr.info("Image conversion process completed",{totalGroups:o.length,totalImages:o.reduce(function(e,t){return e+t.imageSources.length},0),successfulWrites:p.length,failedWrites:h.length,outputFiles:p}),S="",p.length>0&&(S+="Successfully converted ".concat(p.length," image group(s):\n"),p.forEach(function(e){S+="- ".concat(e,"\n")})),h.length>0&&(S&&(S+="\n"),S+="Errors occurred during conversion:\n",h.forEach(function(e){S+="- ".concat(e,"\n")})),C=h.length>0,E=p.length>0,e.a(2,{isError:C&&!E,content:[{type:"text",text:S||"No files were generated."}]});case 18:return e.p=18,A=e.v,T=A instanceof Error?A.message:String(A),Mr.error("Image conversion process failed",{error:T,imageContents:o,outputFolder:c,outputFormat:u}),e.a(2,{isError:!0,content:[{type:"text",text:"Image conversion failed: ".concat(T)}]})}},e,null,[[8,11],[6,15],[2,18]])})),Il.apply(this,arguments)}var jl={convert_images:{name:Pl.name,description:Pl.description,inputSchema:Pl.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Fl(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},create_directory:{name:sc.name,description:sc.description,inputSchema:sc.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,cc(t))},e)}));return function(t){return e.apply(this,arguments)}}()},describe_images:{name:bl.name,description:bl.description,inputSchema:bl.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,kl(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},edit_file:{name:rc.name,description:rc.description,inputSchema:rc.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,ic(t))},e)}));return function(t){return e.apply(this,arguments)}}()},generate_test_cases:{name:Fs.name,description:Fs.description,inputSchema:Fs.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Us(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},generate_code_reviews:{name:ws.name,description:ws.description,inputSchema:ws.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Ss(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},list_directory:{name:fc.name,description:fc.description,inputSchema:fc.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,dc(t))},e)}));return function(t){return e.apply(this,arguments)}}()},move_file:{name:mc.name,description:mc.description,inputSchema:mc.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,vc(t))},e)}));return function(t){return e.apply(this,arguments)}}()},read_media_file:{name:Ws.name,description:Ws.description,inputSchema:Ws.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Gs(t))},e)}));return function(t){return e.apply(this,arguments)}}()},read_multiple_files:{name:Vs.name,description:Vs.description,inputSchema:Vs.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Ks(t))},e)}));return function(t){return e.apply(this,arguments)}}()},read_text_file:{name:zs.name,description:zs.description,inputSchema:zs.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,qs(t))},e)}));return function(t){return e.apply(this,arguments)}}()},review_file:{name:ms.name,description:ms.description,inputSchema:ms.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,vs(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},review_new_code:{name:fs.name,description:fs.description,inputSchema:fs.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,ds(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},review_new_code_with_filter:{name:ss.name,description:ss.description,inputSchema:ss.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,cs(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},search_files:{name:wc.name,description:wc.description,inputSchema:wc.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,bc(t))},e)}));return function(t){return e.apply(this,arguments)}}()},unit_test_analysis:{name:Ts.name,description:Ts.description,inputSchema:Ts.inputSchema,handle:function(){var e=u(s().m(function e(t,n){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Ps(t,n))},e)}));return function(t,n){return e.apply(this,arguments)}}()},write_file:{name:Ys.name,description:Ys.description,inputSchema:Ys.inputSchema,handle:function(){var e=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Xs(t))},e)}));return function(t){return e.apply(this,arguments)}}()}};const Rl=e(import.meta.url)("node:process");var Ml=function(){return h(function e(){l(this,e)},[{key:"append",value:function(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}},{key:"readMessage",value:function(){if(!this._buffer)return null;var e=this._buffer.indexOf("\n");if(-1===e)return null;var t=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),function(e){return yn.parse(JSON.parse(e))}(t)}},{key:"clear",value:function(){this._buffer=void 0}}])}();var Dl=function(){return h(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rl.stdin,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rl.stdout;l(this,e),this._stdin=n,this._stdout=r,this._readBuffer=new Ml,this._started=!1,this._ondata=function(e){t._readBuffer.append(e),t.processReadBuffer()},this._onerror=function(e){var n;null===(n=t.onerror)||void 0===n||n.call(t,e)}},[{key:"start",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:if(!this._started){e.n=1;break}throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");case 1:this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror);case 2:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"processReadBuffer",value:function(){for(var e,t;;)try{var n=this._readBuffer.readMessage();if(null===n)break;null===(e=this.onmessage)||void 0===e||e.call(this,n)}catch(r){null===(t=this.onerror)||void 0===t||t.call(this,r)}}},{key:"close",value:function(){var e=u(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.n){case 0:this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),0===this._stdin.listenerCount("data")&&this._stdin.pause(),this._readBuffer.clear(),null===(t=this.onclose)||void 0===t||t.call(this);case 1:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(e){var t=this;return new Promise(function(n){var r=function(e){return JSON.stringify(e)+"\n"}(e);t._stdout.write(r)?n():t._stdout.once("drain",n)})}}])}(),Ul=function(){return h(function e(t){l(this,e),m(this,"transport",void 0),this.transport=t},[{key:"connect",value:function(){var e=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Promise.resolve())},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getTransport",value:function(){return this.transport}}])}();function Nl(){return new Ul(new Dl)}var Ll=function(){return h(function e(t){l(this,e),m(this,"server",void 0),this.server=new Fr({name:t.name,version:t.version,description:t.description},{capabilities:{tools:{}}}),this.initialize()},[{key:"initialize",value:function(){this.initializeFilesystemSecurity(),function(e){e.setRequestHandler(or,u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return Mr.trace("ListTools"),e.a(2,{tools:Object.values(jl).map(function(e){return{name:e.name,description:e.description,inputSchema:e.inputSchema}})})},e)}))),e.setRequestHandler(ur,function(){var t=u(s().m(function t(n){var r,i,a,o,c,u,l,f,d;return s().w(function(t){for(;;)switch(t.p=t.n){case 0:if(r=Date.now(),Mr.trace("ToolRequest",n),Mr.debug("Processing tool request",{toolName:n.params.name,hasArguments:!!n.params.arguments,argumentCount:n.params.arguments?Object.keys(n.params.arguments).length:0}),i=jl[n.params.name]){t.n=1;break}throw Mr.error("Unknown tool requested",{toolName:n.params.name,availableTools:Object.keys(jl)}),new Error("Unknown tool: ".concat(n.params.name));case 1:return t.p=1,Mr.debug("Executing tool handler",{toolName:n.params.name}),t.n=2,i.handle(n.params.arguments||{},e);case 2:return o=t.v,c=Date.now()-r,Mr.debug("Tool execution completed",{toolName:n.params.name,duration:c,hasError:o.isError||!1,contentItems:(null===(a=o.content)||void 0===a?void 0:a.length)||0}),o.content&&o.content.length>0&&Mr.trace("Tool result preview",{toolName:n.params.name,firstContentPreview:"text"===o.content[0].type?o.content[0].text.substring(0,300):"[non-text content]"}),t.a(2,o);case 3:return t.p=3,d=t.v,u=Date.now()-r,l=d instanceof Error?d.message:String(d),f=d instanceof Error?d.stack:void 0,Mr.error("Tool ".concat(n.params.name," failed"),{toolName:n.params.name,error:l,stack:f,duration:u,arguments:n.params.arguments}),t.a(2,{isError:!0,content:[{type:"text",text:"Tool execution failed: ".concat(l)}]})}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}())}(this.server)}},{key:"initializeFilesystemSecurity",value:function(){var e=Rr();e.filesystemAllowedDirectories&&e.filesystemAllowedDirectories.length>0?(Mr.info("Initializing filesystem with configured allowed directories",{directories:e.filesystemAllowedDirectories}),Xo.setAllowedDirectories(e.filesystemAllowedDirectories)):Mr.warn("No filesystem allowed directories configured. Filesystem tools will require MCP roots protocol or manual configuration.")}},{key:"start",value:function(){var e=u(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.n){case 0:return t=Nl(),Mr.info("Starting SDLC Workflow MCP server..."),e.n=1,this.server.connect(t.getTransport());case 1:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getServer",value:function(){return this.server}}])}();var zl=function(e){return new Ll(e)}({name:"SDLC Workflow",version:"1.0.0",description:"MCP that supports software development lifecycle workflows."});function ql(){return(ql=u(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,zl.start();case 1:e.n=3;break;case 2:e.p=2,t=e.v,Mr.error("Failed to start SDLC Workflow MCP server",{error:t}),process.exit(1);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}!function(){ql.apply(this,arguments)}();